!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).karas=e()}(this,function(){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function f(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?o(t):e}function Y(t,e,i){return(Y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=X(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function ie(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var i=[],r=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);r=!0);}catch(t){n=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function re(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s=function(){function t(){h(this,t),this.__x=0,this.__y=0,this.__ox=0,this.__oy=0,this.__width=0,this.__height=0,this.__prev=null,this.__next=null,this.__ctx=null,this.__defs=null,this.__parent=null,this.__style={},this.__computedStyle={},this.__baseLine=0,this.__virtualDom={},this.__host=null}return u(t,[{key:"__offsetX",value:function(t,e){e?this.__x+=t:this.__ox+=t}},{key:"__offsetY",value:function(t,e){e?this.__y+=t:this.__oy+=t}},{key:"__destroy",value:function(){this.__isDestroyed=!0,this.__prev=this.__next=this.__ctx=this.__defs=this.__parent=this.__host=this.__root=null}},{key:"__setCtx",value:function(t){this.__ctx=t}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"ox",get:function(){return this.__ox}},{key:"oy",get:function(){return this.__oy}},{key:"sx",get:function(){return this.x+this.ox}},{key:"sy",get:function(){return this.y+this.oy}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"outerWidth",get:function(){return this.__width}},{key:"outerHeight",get:function(){return this.__height}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"parent",get:function(){return this.__parent}},{key:"root",get:function(){return this.host?this.host.root:this.parent?this.parent.root:this.tagName&&{canvas:!0,svg:!0}.hasOwnProperty(this.tagName)?this:void 0}},{key:"host",get:function(){return this.__host?this.__host:this.parent?this.parent.host:void 0}},{key:"style",get:function(){return this.__style}},{key:"computedStyle",get:function(){return this.__computedStyle}},{key:"ctx",get:function(){return this.__ctx}},{key:"defs",get:function(){return this.__defs}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"isDestroyed",get:function(){return this.__isDestroyed}}]),t}(),e={AUTO:0,PX:1,PERCENT:2,NUMBER:3,INHERIT:4,DEG:5,STRING:6,RGBA:7},n={arial:{lhr:1.14990234375,car:1.1171875,blr:.9052734375}},c={}.toString;function d(e){return function(t){return c.call(t)==="[object "+e+"]"}}var p=d("Number");function v(t){return y(t)?"":t.toString()}function y(t){return null==t}function g(t){if("item"===t.type||"img"===t.type){var e="";return t.props.forEach(function(t){e+=" ".concat(t[0],'="').concat(t[1],'"')}),"text"===t.tagName?"<text".concat(e,">").concat(t.content,"</text>"):"<".concat(t.tagName).concat(e,"/>")}if("text"===t.type){var i="";return t.children.forEach(function(t){i+=g(t)}),"<g>".concat(i,"</g>")}if("dom"===t.type||"geom"===t.type){var r="<g";t.bbMask&&(r+=' mask="'.concat(t.bbMask,'"')),r+=">",t.bb.forEach(function(t){r+=g(t)}),r+="</g><g>",t.children.forEach(function(t){t.isMask||(r+=g(t))}),r+="</g>";var n=t.opacity,a=t.transform,o=t.mask;return"<g".concat(1!==n?' opacity="'.concat(n,'"'):"").concat(a?' transform="'.concat(a,'"'):"").concat(o?' mask="'.concat(o,'"'):"",">").concat(r,"</g>")}}function m(t){var r="<".concat(t.tagName,' id="').concat(t.uuid,'"');return"mask"===t.tagName?r+=' maskUnits="userSpaceOnUse"':r+=' gradientUnits="userSpaceOnUse"',t.props.forEach(function(t){r+=" ".concat(t[0],'="').concat(t[1],'"')}),r+=">",t.children.forEach(function(t){var e,i;r+=(i="<".concat((e=t).tagName),e.props.forEach(function(t){i+=" ".concat(t[0],'="').concat(t[1],'"')}),i+="></".concat(e.tagName,">"))}),r+="</".concat(t.tagName,">")}var ne={isObject:d("Object"),isString:d("String"),isFunction:d("Function"),isNumber:p,isBoolean:d("Boolean"),isDate:d("Date"),stringify:v,joinSourceArray:function(t){return function t(e){for(var i="",r=0,n=e.length;r<n;r++){var a=e[r];Array.isArray(a)?i+=t(a):i+=v(a)}return i}(t)},encodeHtml:function(t,e){return e?t.replace(/"/g,"&quot;"):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;")},isNil:y,joinVirtualDom:function(t){var e="<defs>";return t.defs.forEach(function(t){e+=m(t)}),e+="</defs><g",t.bbMask&&(e+=' mask="'.concat(t.bbMask,'"')),e+=">",t.bb.forEach(function(t){e+=g(t)}),e+="</g><g>",t.children.forEach(function(t){t.isMask||(e+=g(t))}),e+="</g>"},joinVd:g,joinDef:m,rgba2int:function(t){if(Array.isArray(t))return t;var e=[];if(t&&"transparent"!==t)if("#"===t.charAt(0))3===(t=t.slice(1)).length?(e.push(parseInt(t.charAt(0)+t.charAt(0),16)),e.push(parseInt(t.charAt(1)+t.charAt(1),16)),e.push(parseInt(t.charAt(2)+t.charAt(2),16))):6===t.length?(e.push(parseInt(t.slice(0,2),16)),e.push(parseInt(t.slice(2,4),16)),e.push(parseInt(t.slice(4),16))):e[0]=e[1]=e[2]=0,e[3]=1;else{var i=t.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\s*\)/i);i?(e=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],i[4]?e[3]=parseFloat(i[4]):e[3]=1):e=[0,0,0,0]}else e=[0,0,0,0];return e},int2rgba:function(t){if(Array.isArray(t)){if(4===t.length)return"rgba(".concat(t.join(","),")");if(3===t.length)return"rgba(".concat(t.join(","),",1)")}return t||"rgba(0,0,0,0)"},arr2hash:function(t){for(var e={},i=0,r=t.length;i<r;i++){var n=t[i];if(Array.isArray(n))e[n[0]]=n[1];else for(var a=Object.keys(n),o=a.length-1;0<=o;o--){var s=a[o];e[s]=n[s]}}return e},hash2arr:function(t){if(Array.isArray(t))return t;for(var e=[],i=Object.keys(t),r=0,n=i.length;r<n;r++){var a=i[r];e.push([a,t[a]])}return e},clone:function e(i){if(y(i)||"object"!==a(i))return i;if(ne.isDate(i))return new Date(i);var r=Array.isArray(i)?[]:{};return Object.keys(i).forEach(function(t){r[t]=e(i[t])}),r},equalArr:function t(e,i){if(e.length!==i.length)return!1;for(var r=0,n=e.length;r<n;r++){var a=e[r],o=i[r],s=Array.isArray(a),h=Array.isArray(o);if(s&&h){if(!t(a,o))return!1}else if(s||h)return!1;if(a!==o)return!1}return!0}},S={position:/((-?[\d.]+(px|%))|(left|top|right|bottom|center)){1,2}/gi,tfo:/((-?[\d.]+(px|%)?)|(left|top|right|bottom|center)){1,2}/gi,gradient:/\b(\w+)-gradient\((.+)\)/i,img:/(?:\burl\((['"]?)(.*?)\1\))|(?:\b((data:)))/i};function k(t,e,i,r){return t*r-i*e}var w={vectorProduct:k,pointInLine:function(t,e,i,r,n,a){return t===i&&e===r||t===n&&e===a||(0===i&&0===r||(t-=i,e-=r,n-=i,a-=a),e===a/n*t&&(0<=n?0<=a?0<=t&&0<=e&&t<=n&&e<=a:0<=t&&e<0&&t<=n&&a<e:0<=a?t<0&&0<=e&&n<t&&e<=a:t<0&&e<0&&n<t&&a<e))},pointInPolygon:function(t,e,i){for(var r=ie(i[0],2),n=r[0],a=r[1],o=ie(i[0],2),s=o[0],h=o[1],u=i.length,l=1;l<u;l++){var c=ie(i[l],2),f=c[0],_=c[1];n=Math.max(n,f),a=Math.max(a,_),s=Math.min(s,f),h=Math.min(h,_)}if(t<s||e<h||n<t||a<e)return!1;for(var d=0,p=i.length;d<p;d++){var v=ie(i[d],2),y=v[0],g=v[1],m=ie(i[(d+1)%p],2);if(k(m[0]-y,m[1]-g,t-y,e-g)<0)return!1}return!0},d2r:function(t){return t*Math.PI/180},r2d:function(t){return 180*t/Math.PI},H:4*(Math.sqrt(2)-1)/3},te=ne.rgba2int,ee=ne.int2rgba,b=e.PX,ae=e.PERCENT,x=w.d2r;function E(t,e){for(var i=[],r=0,n=t.length;r<n;r++){var a=t[r];if(1<a.length){var o=ee(a[0]),s=a[1];s.unit===ae?i.push([o,.01*s.value]):i.push([o,s.value/e])}else i.push([ee(a[0])])}if(1===i[0].length&&i[0].push(0),1<i.length){var h=i.length-1;1===i[h].length&&i[h].push(1)}for(var u=i[0][1],l=1,c=i.length;l<c-1;l++){var f=i[l];if(1<f.length)u=f[1];else{for(var _=l+1,d=i[i.length-1][1];_<c-1;_++){var p=i[_];if(1<p.length){d=p[1];break}}for(var v=(d-u)/(_-l+1),y=l;y<_;y++){i[y].push(u+v*(y+1-l))}l=_}}for(var g=1,m=i.length;g<m;g++){var k=i[g],b=i[g-1];k[1]<b[1]&&(k[1]=b[1])}for(var x=0,w=i.length;x<w-1;x++){if(1<i[x][1]){i.splice(x+1);break}}for(var E=i.length-1;0<E;E--){if(i[E][1]<0){i.splice(0,E);break}}var S,A,M,T,P,C,O,R,L,W,N,F,D,B,I,H,j,G,z,X,Y,V,$,q,U,Z,Q,J,K,tt,et,it,rt,nt,at,ot,st,ht,ut,lt,ct,ft,_t,dt,pt,vt,yt,gt,mt,kt,bt,xt,wt,Et,St,At,Mt,Tt,Pt,Ct,Ot,Rt,Lt,Wt,Nt,Ft,Dt,Bt,It=i.length;if(1===It)i[0][1]=0;else{for(var Ht=!0,jt=!0,Gt=It-1;0<=Gt;Gt--){var zt=i[Gt][1];0<zt&&(Ht=!1),zt<1&&(jt=!1)}if(Ht)i.splice(0,It-1),i[0][1]=0;else if(jt)i.splice(1),i[0][1]=0;else{var Xt=i[0],Yt=i[It-1];if(2===It)Xt[1]<0&&1<Yt[1]&&(vt=Yt,yt=e,gt=te((pt=Xt)[0]),mt=te(vt[0]),kt=ie(gt,4),bt=kt[0],xt=kt[1],wt=kt[2],Et=kt[3],St=void 0===Et?1:Et,At=ie(mt,4),Mt=At[0],Tt=At[1],Pt=At[2],Ct=At[3],Ot=void 0===Ct?1:Ct,Rt=Math.abs(pt[1])*yt,Lt=vt[1]*yt,Wt=Rt/(Rt+Lt),Nt=Math.floor(bt+(Mt-bt)*Wt),Ft=Math.floor(xt+(Tt-xt)*Wt),Dt=Math.floor(wt+(Pt-wt)*Wt),Bt=St+(Ot-St)*Wt,pt[0]="rgba(".concat(Nt,",").concat(Ft,",").concat(Dt,",").concat(Bt,")"),pt[1]=0,Wt=(yt+Rt)/(Rt+Lt),Nt=Math.floor(bt+(Mt-bt)*Wt),Ft=Math.floor(xt+(Tt-xt)*Wt),Dt=Math.floor(wt+(Pt-wt)*Wt),Bt=St+(Ot-St)*Wt,vt[0]="rgba(".concat(Nt,",").concat(Ft,",").concat(Dt,",").concat(Bt,")"),vt[1]=1);else{if(Xt[1]<0){var Vt=i[1],$t=te(Xt[0]),qt=te(Vt[0]),Ut=($=$t,q=Xt[1],U=qt,Z=Vt[1],Q=e,J=ie($,4),K=J[0],tt=J[1],et=J[2],it=J[3],rt=void 0===it?1:it,nt=ie(U,4),at=nt[0],ot=nt[1],st=nt[2],ht=nt[3],ut=void 0===ht?1:ht,lt=Math.abs(q)*Q,ct=lt/(Z*Q+lt),ft=Math.floor(K+(at-K)*ct),_t=Math.floor(tt+(ot-tt)*ct),dt=Math.floor(et+(st-et)*ct),[ft,_t,dt,rt+(ut-rt)*ct]);Xt[0]="rgba(".concat(Ut[0],",").concat(Ut[1],",").concat(Ut[2],",").concat(Ut[3],")"),Xt[1]=0}if(1<Yt[1]){var Zt=i[It-2],Qt=te(Zt[0]),Jt=te(Yt[0]),Kt=(S=Qt,A=Zt[1],M=Jt,T=Yt[1],P=e,C=ie(S,4),O=C[0],R=C[1],L=C[2],W=C[3],N=void 0===W?1:W,F=ie(M,4),D=F[0],B=F[1],I=F[2],H=F[3],j=void 0===H?1:H,z=(P-(G=A*P))/(T*P-G),X=Math.floor(O+(D-O)*z),Y=Math.floor(R+(B-R)*z),V=Math.floor(L+(I-L)*z),[X,Y,V,N+(j-N)*z]);Yt[0]="rgba(".concat(Kt[0],",").concat(Kt[1],",").concat(Kt[2],",").concat(Kt[3],")"),Yt[1]=1}}}}return i.forEach(function(t){t[1]<0?t[1]=0:1<t[1]&&(t[1]=1)}),i}var A={parseGradient:function(t){var e=S.gradient.exec(t);if(e){var i={k:e[1]},r=/(-?[\d.]+deg)|(to\s+[toprighbml]+)|circle|ellipse|at|closest|farthest|((closest|farthest)-(side|corner))/.exec(e[2]),n=e[2].match(/((#[0-9a-f]{3,6})|(rgba?\(.+?\)))(\s+-?[\d.]+(px|%))?/gi);if(i.v=n.map(function(t){var e=t.split(/\s+/);return e[0]=te(e[0]),e[1]&&(/%$/.test(e[1])?e[1]={value:parseFloat(e[1]),unit:ae,str:e[1]}:e[1]={value:parseFloat(e[1]),unit:b,str:e[1]}),e}),r){var a=e[2].indexOf(",");"linear"===i.k?i.d=function(t){var e=180;if("to top"===t)e=0;else if("to top right"===t)e=45;else if("to right"===t)e=90;else if("to bottom right"===t)e=135;else if("to bottom"!==t)if("to bottom left"===t)e=225;else if("to left"===t)e=270;else if("to top left"===t)e=315;else{var i=/(-?[\d.]+)deg/.exec(t);i&&(e=parseFloat(i[1]))}return e%360}(e[2].slice(0,a)):i.d=e[2].slice(0,a)}else"linear"===i.k?i.d=180:i.d="farthest-corner";return i}},getLinear:function(t,e,i,r,n,a){var o=x(e),s=Math.abs(n*Math.sin(o))+Math.abs(a*Math.cos(o)),h=ie(function(t,e,i,r){var n,a,o,s;if(270<=t){var h=x(360-t);n=i+Math.sin(h)*e,a=r+Math.cos(h)*e,o=i-Math.sin(h)*e,s=r-Math.cos(h)*e}else if(180<=t){var u=x(t-180);n=i+Math.sin(u)*e,a=r-Math.cos(u)*e,o=i-Math.sin(u)*e,s=r+Math.cos(u)*e}else if(90<=t){var l=x(180-t);n=i-Math.sin(l)*e,a=r-Math.cos(l)*e,o=i+Math.sin(l)*e,s=r+Math.cos(l)*e}else{var c=x(t);n=i-Math.sin(c)*e,a=r+Math.cos(c)*e,o=i+Math.sin(c)*e,s=r-Math.cos(c)*e}return[n,a,o,s]}(e,.5*s,i,r),4);return{x1:h[0],y1:h[1],x2:h[2],y2:h[3],stop:E(t,s)}},getRadial:function(t,e,i,r,n,a,o,s){var h=o-n,u=s-a,l=ie(function(t,e,i,r,n,a,o,s,h){var u,l,c,f="farthest-corner";if(/circle|ellipse|at|closest|farthest/i.test(t)){var _,d,p=t.indexOf("at");if(-1<p&&(_=t.slice(p+2),d=t.slice(0,p-1)),(d=/(closest|farthest)-(side|corner)/.exec(d))?f=d[0]:(d=/\s+(-?[\d.]+(?:px|%))\s*(-?[\d.]+(?:px|%))?/.exec(d))&&(f=null,u=-1<d[1].indexOf("px")?.5*parseFloat(d[1]):parseFloat(d[1])*e*.005),_&&(d=/\s+(-?[\d.]+(?:px|%))\s*(-?[\d.]+(?:px|%))?/.exec(_))){r=-1<d[1].indexOf("px")?a+parseFloat(d[1]):a+parseFloat(d[1])*e*.01;var v=d[2]||d[1];n=-1<v.indexOf("px")?o+parseFloat(v):o+parseFloat(v)*i*.01}}if(f)if("closest-side"===f)u=r<=a||s<=r||n<=o||h<=n?0:(l=r<a+.5*e?r-a:s-r,c=n<o+.5*i?n-o:h-n,Math.min(l,c));else if("closest-corner"===f){var y,g;y=r<a+.5*e?r-a:s-r,g=n<o+.5*i?n-o:h-n,u=Math.sqrt(Math.pow(y,2)+Math.pow(g,2))}else if("farthest-side"===f)if(r<=a)u=a-r+e;else if(s<=r)u=r-s+e;else if(n<=o)u=o-n+i;else if(h<=r)u=n-h+i;else{var m=Math.max(s-r,r-a),k=Math.max(h-n,n-o);u=Math.max(m,k)}else{var b,x;b=r<a+.5*e?s-r:r-a,x=n<o+.5*i?h-n:n-o,u=Math.sqrt(Math.pow(b,2)+Math.pow(x,2))}return[u,r,n]}(e,h,u,i,r,n,a,o,s),3),c=l[0],f=l[1],_=l[2],d=E(t,2*c);if(c<=0){var p=d[d.length-1];p[1]=0,d=[p],f=n,_=a,c=h+u}return{cx:f,cy:_,r:c,stop:d}}},M=e.AUTO,T=e.PX,P=e.PERCENT,C=e.NUMBER,O=e.INHERIT,R=e.DEG,L=e.RGBA,W=e.STRING,N=ne.isNil,F=ne.rgba2int,D=ne.int2rgba,B=ne.clone,I=16;function H(t,e,i,r){N(t.flexGrow)&&(t.flexGrow=e),N(t.flexShrink)&&(t.flexShrink=i),N(t.flexBasis)&&(t.flexBasis=r)}function j(i,r){var t=i[r];if(t){var n=t.toString().match(/(-?[\d.]+(px|%)?)|(auto)/gi);n&&(1===n.length?n[3]=n[2]=n[1]=n[0]:2===n.length?(n[2]=n[0],n[3]=n[1]):3===n.length&&(n[3]=n[1]),["Top","Right","Bottom","Left"].forEach(function(t,e){N(i[t=r+t])&&(i[t]=n[e])}))}}function G(t,e,i){return"auto"===i?t[e]={unit:M}:"inherit"===i?t[e]={unit:O}:/%$/.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:P}):/px$/.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:T}):/deg$/.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:R}):(i=parseFloat(i)||0,t[e]={value:i,unit:C}),0===e.toString().indexOf("border")&&(t[e].value=Math.max(t[e].value,0)),t}function z(t,e){-1<t.indexOf("scale")?e.unit=C:-1<t.indexOf("translate")?e.unit===C&&(e.unit=T):e.unit===C&&(e.unit=R)}function V(e,i,t,r){var n,a,o,s,h=e.fontStyle,u=e.fontWeight,l=e.fontSize,c=e.fontFamily,f=e.color;h.unit===O?i.fontStyle=r?"normal":t.fontStyle:i.fontStyle=h.value,u.unit===O?i.fontWeight=r?400:t.fontWeight:i.fontWeight=u.value,n=i,o=t,s=r,(a=l).unit===O?n.fontSize=s?I:o.fontSize:a.unit===T?n.fontSize=a.value:a.unit===P?n.fontSize=s?I*a.value:o.fontSize*a.value:n.fontSize=I,c.unit===O?i.fontFamily=r?"arial":t.fontFamily:i.fontFamily=c.value,f.unit===O?i.color=r?"rgba(0,0,0,1)":t.color:i.color=D(f.value),["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"].forEach(function(t){i[t]=e[t].unit===T?e[t].value:0}),["position","display","visibility","flexDirection","justifyContent","alignItems","opacity","zIndex","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","backgroundRepeat","flexGrow","flexShrink"].forEach(function(t){i[t]=e[t]}),["backgroundColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"].forEach(function(t){i[t]=D(e[t].value)})}function $(t,e,i){if(!ne.isNumber(e))if(e.unit===O){var r=t.parent;if(r){var n=r.style.lineHeight;if(n.unit===O)for(r=r.parent;r&&(n=r.style.lineHeight).unit===O;);var a=r.computedStyle;n.unit===T?i.lineHeight=a.lineHeight:n.unit===C?i.lineHeight=Math.max(n.value,0)*i.fontSize:i.lineHeight=q(i)}else e.unit=M,i.lineHeight=$(i)}else e.unit===T?i.lineHeight=Math.max(e.value,0)||q(i):e.unit===C?i.lineHeight=Math.max(e.value,0)*i.fontSize||q(i):i.lineHeight=q(i)}function q(t){return t.fontSize*n.arial.lhr}function U(t,e,i){for(t*=.01;e;){var r=e.currentStyle[i];if(r.unit===M){if("width"!==i)break;e=e.parent}else{if(r.unit===T)return t*r.value;r.unit===P&&(t*=.01*r.value,e=e.parent)}}return t}var Z={normalize:function(r){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],i=r.border;if(i&&["Top","Right","Bottom","Left"].forEach(function(t){N(r[t="border"+t])&&(r[t]=i)}),["Top","Right","Bottom","Left"].forEach(function(t){!function(t,e){var i="border".concat(e),r=t[i];if(!N(r)){if(N(t[i+"Width"])){var n=/\b[\d.]+px\b/i.exec(r);t[i+"Width"]=n?n[0]:0}if(N(t[i+"Style"])){var a=/\b(solid|dashed|dotted)\b/i.exec(r);t[i+"Style"]=a?a[1]:"solid"}if(N(t[i+"Color"])){var o=/#[0-9a-f]{3,6}/i.exec(r);o&&-1<[4,7].indexOf(o[0].length)?t[i+"Color"]=o[0]:/\btransparent\b/i.test(r)?t[i+"Color"]="transparent":(o=/rgba?\(.+\)/i.exec(r),t[i+"Color"]=o?o[0]:"transparent")}}}(r,t)}),(i=r.borderWidth)&&["Top","Right","Bottom","Left"].forEach(function(t){N(r[t="border"+t+"Width"])&&(r[t]=i)}),(i=r.borderColor)&&["Top","Right","Bottom","Left"].forEach(function(t){N(r[t="border"+t+"Color"])&&(r[t]=F(i))}),(i=r.borderStyle)&&["Top","Right","Bottom","Left"].forEach(function(t){N(r[t="border"+t+"Style"])&&(r[t]=i)}),(i=r.borderRadius)&&["TopLeft","TopRight","BottomRight","BottomLeft"].forEach(function(t){N(r[t="border"+t+"Radius"])&&(r[t]=i)}),i=r.background){if(N(r.backgroundImage)){var e=S.gradient.exec(i);e&&(r.backgroundImage=e[0],i=i.replace(e[0],""))}if(N(r.backgroundImage)){var n=S.img.exec(i);n&&(r.backgroundImage=n[0],i=i.replace(n[0],""))}if(N(r.backgroundRepeat)){var a=/(no-)?repeat(-[xy])?/i.exec(i);a&&N(r.backgroundRepeat)&&(r.backgroundRepeat=a[0].toLowerCase().trim())}if(N(r.backgroundPosition)){var o=i.match(S.position);o&&N(r.backgroundPosition)&&(r.backgroundPosition=o.join(" "))}if(N(r.backgroundColor)){var s=/^(transparent)|(#[0-9a-f]{3,6})|(rgba?\(.+?\))/i.exec(i);s&&(r.backgroundColor=s[0])}}if(i=r.backgroundPosition,!N(i)){1===(i=i.toString().split(/\s+/)).length&&(i[1]="50%");var h=ie(i,2);r.backgroundPositionX=h[0],r.backgroundPositionY=h[1]}if(i=r.flex)if("none"===i)H(r,0,0,"auto");else if("auto"===i)H(r,1,1,"auto");else if(/^[\d.]+$/.test(i))H(r,Math.max(0,parseFloat(i)),1,0);else if(/^[\d.]+px$/.test(i))H(r,1,1,0);else if(/^[\d.]+%$/.test(i))H(r,1,1,i);else if(/^[\d.]+\s+[\d.]+$/.test(i)){var u=i.split(/\s+/);H(r,u[0],u[1],0)}else if(/^[\d.]+\s+[\d.]+%$/.test(i)){var l=i.split(/\s+/);H(r,l[0],1,l[1])}else H(r,0,1,"auto");if(j(r,"margin"),j(r,"padding"),["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=r[t];!N(e)&&r.transform&&console.error('Can not use expand style "'.concat(t,'" with "transform"'))}),t.forEach(function(t){var e=t.k,i=t.v;N(r[e])&&(r[e]=i)}),(i=r.backgroundImage)&&(S.gradient.test(i)?r.backgroundImage=A.parseGradient(i):S.img.test(i)&&(r.backgroundImage=S.img.exec(i)[2])),i=r.backgroundColor){var c=/^#[0-9a-f]{3,6}/i.exec(i);c&&-1<[4,7].indexOf(c[0].length)?r.backgroundColor={value:F(c[0]),unit:L}:(c=/rgba?\(.+\)/i.exec(i),r.backgroundColor={value:F(c?c[0]:[0,0,0,0]),unit:L})}if(["backgroundPositionX","backgroundPositionY"].forEach(function(t){i=r[t],N(i)||(/%$/.test(i)||/px$/.test(i)||/^-?[\d.]+$/.test(i)?(G(r,t,i),(i=r[t]).unit===C&&(i.unit=T)):r[t]={value:{top:0,left:0,center:50,right:100,bottom:100}[i],unit:P})}),i=r.backgroundSize){var f=i.toString().match(/\b(?:(-?[\d.]+(px|%)?)|(contain|cover|auto))/gi);if(f){1===f.length&&(f[1]=f[0]);for(var _=[],d=0;d<2;d++){var p=f[d];/%$/.test(p)||/px$/.test(p)?G(_,d,p):"0"===p||0===p?_.push({value:0,unit:T}):"contain"===p||"cover"===p?_.push({value:p,unit:W}):_.push({unit:M})}r.backgroundSize=_}}if(["Top","Right","Bottom","Left"].forEach(function(t){var e=r[t="border"+t+"Color"];N(e)||(r[t]={value:F(e),unit:L})}),i=r.transform){var v=i.toString().match(/\w+\(.+?\)/g);if(v){var y=[];v.forEach(function(t){var e=t.indexOf("("),i=t.slice(0,e),r=t.slice(e+1,t.length-1);if("matrix"===i){var n=r.toString().split(/\s*,\s*/);6<(n=n.map(function(t){return parseFloat(t)})).length&&(n=n.slice(0,6)),6===n.length&&y.push(["matrix",n])}else if({translateX:!0,translateY:!0,scaleX:!0,scaleY:!0,skewX:!0,skewY:!0,rotate:!0,rotateZ:!0}.hasOwnProperty(i)){"rotate"===i&&(i="rotateZ");var a=G([i,r],1,r);z(i,a[1]),y.push(a)}else if({translate:!0,scale:!0,skew:!0}.hasOwnProperty(i)){var o=r.toString().split(/\s*,\s*/);1===o.length&&(o[1]=o[0]);var s=G(["".concat(i,"X"),o[0]],1,o[0]),h=G(["".concat(i,"Y"),o[1]],1,o[1]);z(i,s[1]),z(i,h[1]),y.push(s),y.push(h)}}),r.transform=y}}if(i=r.transformOrigin,!N(i)){var g=i.toString().match(S.tfo);if(g){1===g.length&&(g[1]=g[0]);for(var m=[],k=0;k<2;k++){var b=g[k];/%$/.test(b)||/px$/.test(b)||/^-?[\d.]+$/.test(b)?(G(m,k,b),m[k].unit===C&&(m[k].unit=T)):(m.push({value:{top:0,left:0,center:50,right:100,bottom:100}[b],unit:P}),N(m[k].value)&&(m[k].value=50))}r.transformOrigin=m}}if(["translate","scale","skew"].forEach(function(t){if(i=r[t],!N(i)){var e=i.toString().split(/\s*,\s*/);1===e.length&&(e[1]=e[0]),r["".concat(t,"X")]=e[0],r["".concat(t,"Y")]=e[1]}}),["translateX","translateY","scaleX","scaleY","skewX","skewY","rotateZ","rotate"].forEach(function(t){var e=r[t];N(e)||(G(r,t,e),"rotate"===t&&(t="rotateZ",r.rotateZ=r.rotate,delete r.rotate),z(t,e=r[t]))}),(i=r.opacity)&&(i=parseFloat(i),isNaN(i)?r.opacity=1:(i=Math.max(i,0),i=Math.min(i,1),r.opacity=i)),(i=r.zIndex)&&(r.zIndex=parseInt(i)||0),["marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","top","right","bottom","left","width","height","flexBasis","strokeWidth"].forEach(function(t){var e=r[t];N(e)||(G(r,t,e),(e=r[t]).unit===C&&(e.unit=T))}),(i=r.color)&&(r.color="inherit"===i?{unit:O}:{value:F(i),unit:L}),(i=r.fontSize)||0===i||"0"===i)if("inherit"===i)r.fontSize={unit:O};else if(/%$/.test(i)){var x=Math.max(0,parseFloat(i));r.fontSize=x?{value:x,unit:P}:{value:I,unit:T}}else r.fontSize={value:Math.max(0,parseFloat(i))||I,unit:T};if(!(i=r.fontWeight)&&0!==i&&"0"!==i||(r.fontWeight="bold"===i?{value:700,unit:C}:"normal"===i?{value:400,unit:C}:"lighter"===i?{value:200,unit:C}:"inherit"===i?{unit:O}:{value:Math.max(0,parseInt(i))||400,unit:C}),(i=r.fontStyle)&&(r.fontStyle="inherit"===i?{unit:O}:{value:i,unit:W}),(i=r.fontFamily)&&(r.fontFamily="inherit"===i?{unit:O}:{value:i,unit:W}),(i=r.textAlign)&&(r.textAlign="inherit"===i?{unit:O}:{value:i,unit:W}),(i=r.lineHeight)||0===i||"0"===i)if("inherit"===i)r.lineHeight={unit:O};else if("normal"===i)r.lineHeight={unit:M};else if(/px$/.test(i))r.lineHeight={value:parseFloat(i),unit:T};else{var w=Math.max(0,parseFloat(i))||"normal";r.lineHeight="normal"===w?{unit:M}:{value:w,unit:C}}if(i=r.strokeDasharray,!N(i)){var E=i.toString().match(/[\d.]+/g);E?((E=E.map(function(t){return parseFloat(t)})).length%2==1&&E.push(E[E.length-1]),r.strokeDasharray=E):r.strokeDasharray=[]}return(i=r.fill)&&(0<i.indexOf("-gradient(")?r.fill=A.parseGradient(i):r.fill=F(i)),(i=r.stroke)&&(0<i.indexOf("-gradient(")?r.stroke=A.parseGradient(i):r.stroke=F(i)),delete r.background,delete r.flex,delete r.border,delete r.margin,delete r.padding,r},compute:function(t,e){var i=t.animateStyle,r=t.__currentStyle=i,n=r.lineHeight,a=r.textAlign,o=t.__computedStyle=B(r),s=t.parent,h=s&&s.computedStyle;V(r,o,h,e),$(t,n,o),a.unit===O?o.textAlign=e?"left":h.textAlign:o.textAlign=e?"left":a.value},repaint:function(t,e){var i=t.animateStyle,r=t.computedStyle,n=t.__currentStyle=i,a=t.parent;V(n,r,a&&a.computedStyle,e)},setFontStyle:function(t){var e=t.fontStyle,i=t.fontWeight,r=t.fontSize,n=t.fontFamily;return"".concat(e," ").concat(i," ").concat(r,"px/").concat(r,"px ").concat(n)},getBaseLine:function(t){var e=t.fontSize*n.arial.lhr;return.5*(t.lineHeight-e)+t.fontSize*n.arial.blr},calLineHeight:$,calRelative:function(t,e,i,r,n){return i.unit===M?i=0:-1<[T,C,R,L,W].indexOf(i.unit)?i=i.value:i.unit===P&&(i=U(i.value,r,n?"width":"height")),i},calAbsolute:function(t,e,i,r){return i.unit===M?i=0:-1<[T,C,R,L,W].indexOf(i.unit)?i=i.value:i.unit===P&&(i=i.value*r*.01),i}},oe={CANVAS:0,SVG:1},Q=function(){function a(t,e,i,r,n){h(this,a),this.__parent=t,this.__x=e,this.__y=i,this.__width=r,this.__content=n,this.__virtualDom={}}return u(a,[{key:"render",value:function(t,e){var i=this.content,r=this.x,n=this.y,a=this.parent,o=a.ox,s=a.oy,h=a.computedStyle;n+=Z.getBaseLine(h),r+=o,n+=s,t===oe.CANVAS?e.fillText(i,r,n):t===oe.SVG&&(this.__virtualDom={type:"item",tagName:"text",props:[["x",r],["y",n],["fill",h.color],["font-family",h.fontFamily],["font-weight",h.fontWeight],["font-style",h.fontStyle],["font-size","".concat(h.fontSize,"px")]],content:ne.encodeHtml(i)})}},{key:"__offsetX",value:function(t){this.__x+=t}},{key:"__offsetY",value:function(t){this.__y+=t}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){return this.__width}},{key:"content",get:function(){return this.__content}},{key:"baseLine",get:function(){return Z.getBaseLine(this.parent.computedStyle)}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"parent",get:function(){return this.__parent}}]),a}(),J=function(){function d(t){var e;return h(this,d),(e=_(this,X(d).call(this))).__content=t.toString(),e.__lineBoxes=[],e.__charWidthList=[],e.__charWidth=0,e.__textWidth=0,e}return t(d,s),u(d,[{key:"__measure",value:function(){var t=this.ctx,e=this.content,i=this.computedStyle,r=this.charWidthList,n=this.renderMode;r.splice(0),n===oe.CANVAS&&(t.font=Z.setFontStyle(i));for(var a=i.fontSize+","+i.fontFamily,o=d.MEASURE_TEXT.data[a]=d.MEASURE_TEXT.data[a]||{key:a,style:i,hash:{},s:[]},s=d.CHAR_WIDTH_CACHE[a]=d.CHAR_WIDTH_CACHE[a]||{},h=0,u=!1,l=0,c=e.length;l<c;l++){var f=e.charAt(l),_=void 0;s.hasOwnProperty(f)?(_=s[f],r.push(_),h+=_,this.__charWidth=Math.max(this.charWidth,_)):n===oe.CANVAS?(_=s[f]=t.measureText(f).width,r.push(_),h+=_,this.__charWidth=Math.max(this.charWidth,_)):(o.hash.hasOwnProperty(f)||(o.s+=f),o.hash[f]=!0,r.push(-1),u=!0)}this.__textWidth=h,u&&d.MEASURE_TEXT.list.push(this)}},{key:"__measureCb",value:function(){for(var t=this.content,e=this.computedStyle,i=this.charWidthList,r=e.fontSize+","+e.fontFamily,n=d.CHAR_WIDTH_CACHE[r],a=0,o=0,s=i.length;o<s;o++)if(i[o]<0){var h=i[o]=n[t.charAt(o)];a+=h,this.__charWidth=Math.max(this.charWidth,h)}this.__textWidth+=a}},{key:"__layout",value:function(t,e){var i=this,r=t.x,n=t.y,a=t.w;this.__x=r,this.__y=n;var o=this.isDestroyed,s=this.content,h=this.currentStyle,u=this.computedStyle,l=this.lineBoxes,c=this.charWidthList;if(!o&&"none"!==h.display){this.__ox=this.__oy=0,l.splice(0);for(var f=0,_=0,d=0,p=s.length,v=0;_<p;)if((d+=c[_])===a){var y=new Q(this,r,n,d,s.slice(f,_+1));l.push(y),v=Math.max(v,d),n+=u.lineHeight,_=f=_+1,d=0}else if(a<d){var g=void 0;g=_===f?(_=f+1,d):d-c[_];var m=new Q(this,r,n,g,s.slice(f,_));l.push(m),v=Math.max(v,g),n+=u.lineHeight,f=_,d=0}else _++;if(f<p&&f<_){for(d=0,_=f;_<p;_++)d+=c[_];var k=new Q(this,r,n,d,s.slice(f,p));l.push(k),v=Math.max(v,d),n+=u.lineHeight}if(this.__width=v,this.__height=n-t.y,!e){var b=u.textAlign;-1<["center","right"].indexOf(b)&&l.forEach(function(t){var e=i.__width-t.width;0<e&&t.__offsetX("center"===b?.5*e:e)})}}}},{key:"__offsetX",value:function(e,t){Y(X(d.prototype),"__offsetX",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetX(e)})}},{key:"__offsetY",value:function(e,t){Y(X(d.prototype),"__offsetY",this).call(this,e,t),t&&this.lineBoxes.forEach(function(t){t.__offsetY(e)})}},{key:"__renderByMask",value:function(t){this.render(t)}},{key:"__tryLayInline",value:function(t){return t-this.textWidth}},{key:"__calMaxAndMinWidth",value:function(){var e=0;return this.charWidthList.forEach(function(t){e=Math.max(e,t)}),{max:this.textWidth,min:e}}},{key:"__calAbsWidth",value:function(t,e,i){return this.__layout({x:t,y:e,w:i},!0),this.width}},{key:"render",value:function(e){var t=this.isDestroyed,i=this.ctx,r=this.computedStyle;t||"none"===r.display||(e===oe.CANVAS&&(i.font=Z.setFontStyle(r),i.fillStyle=r.color),this.lineBoxes.forEach(function(t){t.render(e,i)}),e===oe.SVG&&(this.__virtualDom={type:"text",children:this.lineBoxes.map(function(t){return t.virtualDom})}))}},{key:"content",get:function(){return this.__content},set:function(t){this.__content=t}},{key:"lineBoxes",get:function(){return this.__lineBoxes}},{key:"charWidthList",get:function(){return this.__charWidthList}},{key:"charWidth",get:function(){return this.__charWidth}},{key:"textWidth",get:function(){return this.__textWidth}},{key:"baseLine",get:function(){var t=this.lineBoxes[this.lineBoxes.length-1];return t.y-this.y+t.baseLine}},{key:"currentStyle",get:function(){return this.style}},{key:"animateStyle",get:function(){return this.style}},{key:"renderMode",get:function(){return this.__renderMode}}]),d}();l(J,"CHAR_WIDTH_CACHE",{}),l(J,"MEASURE_TEXT",{list:[],data:{}});var K={identity:function(){for(var t=[],e=0;e<16;e++)t.push(e%5==0?1:0);return t},multiply:function(t,e){for(var i=[],r=0;r<4;r++)for(var n=[t[r],t[r+4],t[r+8],t[r+12]],a=0;a<4;a++){var o=4*a,s=[e[o],e[1+o],e[2+o],e[3+o]],h=n[0]*s[0]+n[1]*s[1]+n[2]*s[2]+n[3]*s[3];i[r+o]=h}return i},t43:function(t){return[t[0],t[1],t[4],t[5],t[12],t[13]]},calPoint:function(t,e){var i=ie(t,2),r=i[0],n=i[1];return[e[0]*r+e[2]*n+e[4],e[1]*r+e[3]*n+e[5]]}};function tt(t,e,i,r){return Math.atan((r-e)/(i-t))}function et(t){var e=Math.sin(t),i=Math.cos(t),r=K.identity();return r[0]=r[5]=i,r[1]=e,r[4]=-e,r}var it={transform:function(t,e){var i=ie(t,6),r=i[0],n=i[1],a=i[2],o=i[3],s=i[4],h=i[5],u=ie(e,6),l=u[0],c=u[1],f=u[2],_=u[3],d=u[4],p=u[5],v=l-r,y=f-a;l-=v,c-=y,f-=v,_-=y,d-=v,p-=y;var g=K.identity(),m=tt(r,n,a,o),k=et(-m);g=K.multiply(k,g);var b=Math.sqrt(Math.pow(a-r,2)+Math.pow(o-n,2)),x=Math.sqrt(Math.pow(f-l,2)+Math.pow(_-c,2))/b;(k=K.identity())[0]=k[5]=x,g=K.multiply(k,g),k=et(-(m=tt(l,c,f,_)));var w=ie(K.calPoint([f,_],K.t43(k)),2),E=w[0],S=w[1],A=ie(K.calPoint([d,p],K.t43(k)),2),M=A[0],T=A[1],P=Math.atan((E-M)/(T-S));x=T/K.calPoint([s,h],K.t43(g))[1],(k=K.identity())[5]=x,g=K.multiply(k,g);var C=ie(K.calPoint([s,h],K.t43(g)),2),O=C[0],R=C[1];return m=Math.atan((M-O)/R),(k=K.identity())[4]=Math.tan(m),g=K.multiply(k,g),k=et(-P),g=K.multiply(k,g),(k=K.identity())[12]=v,k[13]=y,g=K.multiply(k,g),K.t43(g)}},rt={matrix:K,tar:it,geom:w},nt=e.PX,at=e.PERCENT,ot=rt.matrix,st=rt.geom,ht=st.d2r;function ut(t,e,i){var r=ie(t,6),n=r[0],a=r[1],o=r[2],s=r[3];return[n*e+o*i+r[4],a*e+s*i+r[5]]}function lt(t){var e=ot.identity();return e[0]=t[0],e[1]=t[1],e[4]=t[2],e[5]=t[3],e[12]=t[4],e[13]=t[5],e}var se={calMatrix:function(t,e,i,r){var n,a,o,s=ie(e,2),h=s[0],u=s[1],l=(n=i,a=r,o=[],t.forEach(function(t){var e=ie(t,2),i=e[0],r=e[1];o.push([i,function(t,e,i,r){if("translateX"===t){if(e.unit===at)return e.value*i*.01}else if("translateY"===t){if(e.unit===at)return e.value*r*.01}else if("matrix"===t)return e;return e.value}(i,r,n,a)])}),o),c=ot.identity();c[12]=h,c[13]=u,l.forEach(function(t){var e=ie(t,2),i=e[0],r=e[1],n=ot.identity();!function(t,e,i){if("translateX"===e)t[12]=i;else if("translateY"===e)t[13]=i;else if("scaleX"===e)t[0]=i;else if("scaleY"===e)t[5]=i;else if("skewX"===e)i=ht(i),t[4]=Math.tan(i);else if("skewY"===e)i=ht(i),t[1]=Math.tan(i);else if("rotateZ"===e){i=ht(i);var r=Math.sin(i),n=Math.cos(i);t[0]=t[5]=n,t[1]=r,t[4]=-r}else"matrix"===e&&(t[0]=i[0],t[1]=i[1],t[4]=i[2],t[5]=i[3],t[12]=i[4],t[13]=i[5])}(n,i,r),c=ot.multiply(c,n)});var f=ot.identity();return f[12]=-h,f[13]=-u,c=ot.multiply(c,f),ot.t43(c)},calOrigin:function(t,i,r,n,a){var o=[];return t.forEach(function(t,e){t.unit===nt?o.push(t.value+(e?r:i)):t.unit===at&&o.push((e?r:i)+t.value*(e?a:n)*.01)}),o},pointInQuadrilateral:function(t,e,i,r,n,a,o,s,h,u,l){if(!l||ne.equalArr(l,[1,0,0,1,0,0]))return i<=t&&r<=e&&t<=o&&e<=s;var c=ie(ut(l,i,r),2);i=c[0],r=c[1];var f=ie(ut(l,n,a),2);n=f[0],a=f[1];var _=ie(ut(l,o,s),2);o=_[0],s=_[1];var d=ie(ut(l,h,u),2);return h=d[0],u=d[1],st.pointInPolygon(t,e,[[i,r],[n,a],[o,s],[h,u]])},mergeMatrix:function(t,e){var i=lt(t),r=lt(e),n=ot.multiply(i,r);return[n[0],n[1],n[4],n[5],n[12],n[13]]}},ct=w.H;function ft(t,e,i,r,n,a,o,s){var h=1,u=1,l=1;t:for(var c=a;n<=c;c--)for(var f=s;o<=f;f--){var _=c+f,d=Math.floor((t+f)/_),p=f;if(d*_<f+t)if(s<(p=(t-d*c)/(d-1)))continue;if(_=c+p,1<e&&c<e){if(c<e%_)continue;if(1<i)if(c<(e+r)%_)continue}if(1<i)if(c<(e+r)%_)continue;0<d&&(h=d,u=c,l=p);break t}return{n:h,ps:u,pd:l}}function _t(t,e,i,r,n,a){var o=n-e,s=r-i,h=i-e,u=n-r;if("dotted"===t)return ft(o,h,u,s,a,a,Math.max(1,.25*a),2*a);var l=ft(o,h,u,s,a,3*a,Math.max(1,.25*a),2*a),c=l.n,f=l.ps,_=l.pd;return 1===c?ft(o,h,u,s,a,a,Math.max(1,.25*a),2*a):{n:c,ps:f,pd:_}}var he={calDashed:_t,calPoints:function(t,e,i,r,n,a,o,s,h,u,l,c,f){var _=[];if(-1<["dashed","dotted"].indexOf(e)){var d=0===f||2===f?_t(e,n,a,o,s,t):_t(e,h,u,l,c,t),p=d.n,v=d.ps,y=d.pd;if(1<p){for(var g=0;g<p;g++){var m,k=g===p-1,b=void 0,x=void 0,w=void 0;m=(b=0===f||2===f?g?n+v*g+y*g:n:g?h+v*g+y*g:h)+v,0===f?m<a?k?_.push([n,h,s,h,o,u,a,u]):(x=h+(b-n)*Math.tan(i),w=h+(m-n)*Math.tan(i),_.push([b,h,m,h,m,w,b,x])):o<b?(x=h+(s-b)*Math.tan(r),w=h+(s-m)*Math.tan(r),k?_.push([b,h,s,h,b,x]):_.push([b,h,m,h,m,w,b,x])):b<a?(x=h+(b-n)*Math.tan(i),k?_.push([b,h,s,h,o,u,a,u,b,x]):o<m?_.push([b,h,m,h,o,u,a,u,b,x]):_.push([b,h,m,h,m,u,a,u,b,x])):o<m?(x=h+(s-m)*Math.tan(r),b<a?k?_.push([b,h,s,h,o,u,a,u,b,x]):_.push([b,h,m,h,m,x,o,u,a,u,b,x]):k?_.push([b,h,s,h,o,u,b,u]):_.push([b,h,m,h,m,x,o,u,b,u])):k?_.push([b,h,s,h,o,u,b,u]):_.push([b,h,m,h,m,u,b,u]):1===f?m<u?k?_.push([o,u,s,h,s,c,o,l]):(x=s-(m-h)*Math.tan(i),w=s-(b-h)*Math.tan(i),_.push([x,m,w,b,s,b,s,m])):l<b?(x=o+(b-l)*Math.tan(r),w=o+(m-l)*Math.tan(r),k?_.push([x,b,s,b,s,c]):_.push([x,b,s,b,s,m,w,m])):b<u?(x=o+(u-b)*Math.tan(i),k?_.push([o,u,x,b,s,b,s,c,o,c]):l<m?_.push([o,u,x,b,s,b,s,m,x,m,o,l]):_.push([o,u,x,b,s,b,s,m,o,m])):l<m?(x=o+(m-l)*Math.tan(r),b<u?k?_.push([o,u,x,b,s,b,s,c,o,l]):_.push([o,u,x,b,s,b,s,m,x,m,o,l]):k?_.push([o,b,s,b,s,c,o,l]):_.push([o,b,s,b,s,m,x,m,o,l])):k?_.push([o,b,s,b,s,c,o,l]):_.push([o,b,s,b,s,m,o,m]):2===f?m<a?k?_.push([n,c,a,l,o,l,s,c]):(x=c-(b-n)*Math.tan(i),w=c-(m-n)*Math.tan(i),_.push([b,x,m,w,m,c,b,c])):o<b?(x=c-(b-n)*Math.tan(r),w=c-(m-n)*Math.tan(r),k?_.push([b,x,s,c,b,c]):_.push([b,x,m,w,m,c,b,c])):b<a?(x=l+(b-n)*Math.tan(i),k?_.push([b,x,a,l,o,l,s,c,b,c]):o<m?_.push([b,x,a,l,o,l,m,c,b,c]):_.push([b,x,a,l,m,l,m,c,b,c])):o<m?(x=c-(s-m)*Math.tan(r),b<a?k?_.push([b,x,o,l,s,c,b,c]):_.push([b,x,o,l,m,x,m,c,b,c]):k?_.push([b,l,o,l,s,c,b,c]):_.push([b,l,o,l,m,x,m,c,b,c])):k?_.push([b,l,o,l,s,c,b,c]):_.push([b,l,m,l,m,c,b,c]):3===f&&(m<u?k?_.push([n,h,a,u,a,l,n,c]):(x=n+(b-h)*Math.tan(i),w=n+(m-h)*Math.tan(i),_.push([n,b,x,b,w,m,n,m])):l<b?(x=n+(c-b)*Math.tan(r),w=n+(c-m)*Math.tan(r),k?_.push([n,b,x,b,n,c]):_.push([n,b,x,b,w,m,n,m])):b<u?(x=n+(b-h)*Math.tan(i),k?_.push([n,b,x,b,a,u,a,l,n,c]):l<m?_.push([n,b,x,b,a,u,a,l,x,m,n,m]):_.push([n,b,x,b,a,u,a,m,n,m])):l<m?(x=n+(c-m)*Math.tan(r),b<u?k?_.push([n,b,x,b,a,u,a,l,n,c]):_.push([n,b,x,b,a,u,a,l,x,m,n,m]):k?_.push([n,b,a,b,a,l,n,c]):_.push([n,b,a,b,a,l,x,m,n,m])):k?_.push([n,b,a,b,a,l,n,c]):_.push([n,b,a,b,a,m,n,m]))}return _}}return 0===f?_.push([n,h,s,h,o,u,a,u]):1===f?_.push([o,u,s,h,s,c,o,l]):2===f?_.push([n,c,a,l,o,l,s,c]):3===f&&_.push([n,h,a,u,a,l,n,c]),_},calRadius:function(t,e,i,r,n,a,o,s){if(n||a||o||s){var h=[];return h.push([t+n,e]),h.push([t+i-a,e]),h.push([t+i-a*(1-ct),e,t+i,e+a*(1-ct),t+i,e+a]),h.push([t+i,e+r-o]),h.push([t+i,e+r-o*(1-ct),t+i-o*(1-ct),e+r,t+i-o,e+r]),h.push([t+s,e+r]),h.push([t+s*(1-ct),e+r,t,e+r-s*(1-ct),t,e+r-s]),h.push([t,e+n]),h.push([t,e+n*(1-ct),t+n*(1-ct),e,t+n,e]),h}},genRdRect:function(t,e,i,r,n,a,o,s){if(t!==oe.CANVAS){for(var h="M".concat(s[0][1],",").concat(s[0][1]),u=1,l=s.length;u<l;u+=2){var c=s[u],f=s[u+1];h+="L".concat(c[0],",").concat(c[1]),h+="C".concat(f[0],",").concat(f[1],",").concat(f[2],",").concat(f[3],",").concat(f[4],",").concat(f[5])}return{type:"item",tagName:"path",props:[["d",h],["fill",i]]}}e.beginPath(),e.fillStyle=i,e.moveTo(s[0][0],s[0][1]);for(var _=1,d=s.length;_<d;_+=2){var p=s[_],v=s[_+1];e.lineTo(p[0],p[1]),e.bezierCurveTo(v[0],v[1],v[2],v[3],v[4],v[5])}e.fill(),e.closePath()}};function dt(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function pt(t,e){return!Array.isArray(t)||t.length<2||(e=e||function(){},function t(e,i,r,n){if(!(r<=i)){for(var a=i,o=r,s=a,h=e[s],u=!0;a<o;)if(u){for(;a<o;o--)if(n.call(e,h,e[o])){dt(e,s,o),s=o,u=!u,a++;break}}else for(;a<o;a++)if(n.call(e,e[a],h)){dt(e,s,a),s=a,u=!u,o--;break}t(e,i,s-1,n),t(e,s+1,r,n)}}(t,0,t.length-1,e)),t}function vt(t,e){var i=t.class,r=t.tagName,n=t.id;pt(i=i.slice(),function(t,e){return e<t});var a=[];i.length&&!function t(e,i,r,n){if(1<r-n){t(e,i,r,n+1);for(var a=0,o=i.length;a<o;a++)i.push(i[a]+"."+e[n])}i.push("."+e[n])}(i,a,i.length,0);var o=e.hasOwnProperty("_*."),s=e.hasOwnProperty("_*#"),h=e.hasOwnProperty("_*.#"),u=[r];return e.hasOwnProperty("_*")&&u.push("*"),n&&(n="#"+n,u.push(n),u.push(r+n),s&&u.push("*"+n)),a.forEach(function(t){u.push(t),u.push(r+t),o&&u.push("*"+t),n&&(u.push(t+n),u.push(r+t+n),h&&u.push("*"+t+n))}),u}function yt(e,i){i._v.forEach(function(t){t[2]=i._p,e.push(t)})}function gt(t){var e={};return t.forEach(function(t){e[t]=!0}),e}var mt={parse:function(t,e,i){if(i){var r=[];!function h(u,l,c,f){var _=this;var t=vt(u,c);t.forEach(function(t){if(c.hasOwnProperty(t)){for(var i=c[t],e=u.parent;e;)h(e,l,i,f),e=e.parent;if(i.hasOwnProperty("_v")&&yt(f,i),i.hasOwnProperty("_>")){var r=i["_>"];h(u.parent,_,r,f)}if(i.hasOwnProperty("_+")){var n=i["_+"],a=u.prev;if(a&&!(a instanceof J)){var o=vt(a,n),s=gt(o);Object.keys(n).forEach(function(t){var e=n[t];e.hasOwnProperty("_v")&&s.hasOwnProperty(t)&&yt(f,e)})}}i.hasOwnProperty("_~")&&function(){for(var r=i["_~"],e=u.prev,t=function(){if(e instanceof J)return e=e.prev,"continue";var t=vt(e,r),i=gt(t);Object.keys(r).forEach(function(t){var e=r[t];e.hasOwnProperty("_v")&&i.hasOwnProperty(t)&&yt(f,e)}),e=e.prev};e;)t()}()}})}(t,e,i,r),pt(r,function(t,e){for(var i=t[2],r=e[2],n=0;n<3;n++)if(i[n]!==r[n])return i[n]>r[n];return t[0]>e[0]});for(var n={},a=r.length-1;0<=a;a--){var o=ie(r[a][1],2),s=o[0],h=o[1];n.hasOwnProperty(s)||(n[s]=h)}return n}},splitClass:function(t){if(t=(t||"").trim())return t.split(/\s+/)},mergeCss:function i(r,n){return n?r?(Object.keys(n).forEach(function(t){var e=n[t];!{_v:!0,_p:!0}.hasOwnProperty(t)&&"object"===a(e)&&r.hasOwnProperty(t)?r[t]=i(r[t],e):r[t]=e}),r):n:r}},kt=e.PERCENT,bt=e.NUMBER;var ue={matrixResize:function(t,e,i,r,n,a,o,s){if(t!==i||e!==r){var h=[["scaleX",{value:i/t,unit:bt}],["scaleY",{value:r/e,unit:bt}]],u=se.calOrigin([{value:0,unit:kt},{value:0,unit:kt}],n,a,o,s);return se.calMatrix(h,u,o,s)}}},xt=ne.isFunction,wt=function(){function o(){h(this,o),this.__eHash={}}return u(o,[{key:"on",value:function(t,e){if(e){var i=this;if(Array.isArray(t))for(var r=0,n=t.length;r<n;r++)i.on(t[r],e);else if(e){i.__eHash.hasOwnProperty(t)||(i.__eHash[t]=[]);for(var a=0,o=i.__eHash[t],s=o.length;a<s;a++)if(o[a]===e)return i;i.__eHash[t].push(e)}return i}}},{key:"once",value:function(r,n){if(xt(n)){var a=this;if(o.__karasEventCb=n,Array.isArray(r))for(var t=0,e=r.length;t<e;t++)a.once(r[t],n);else n&&a.on(r,o);return this}function o(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];n.apply(a,e),a.off(r,o)}}},{key:"off",value:function(t,e){if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++)this.off(t[i],e);else if(this.__eHash.hasOwnProperty(t))if(e){for(var n=0,a=this.__eHash[t],o=a.length;n<o;n++)if(a[n]===e||a[n].__karasEventCb===e){a.splice(n,1);break}}else delete this.__eHash[t];return this}},{key:"emit",value:function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];if(Array.isArray(t))for(var n=0,a=t.length;n<a;n++)this.emit(t[n],i);else if(this.__eHash.hasOwnProperty(t)){var o=this.__eHash[t];if(o.length)for(var s=0,h=(o=o.slice()).length;s<h;s++){var u=o[s];xt(u)&&u.apply(this,i)}}return this}}],[{key:"mix",value:function(){for(var t=arguments.length-1;0<=t;t--){var e=t<0||arguments.length<=t?void 0:arguments[t],i=new o;e.__eHash={};for(var r=["on","once","off","emit"],n=r.length-1;0<=n;n--){var a=r[n];e[a]=i[a]}}}}]),o}();l(wt,"REFRESH","refresh"),l(wt,"BEFORE_REFRESH","before-refresh"),l(wt,"PAUSE","pause"),l(wt,"PLAY","play"),l(wt,"FRAME","frame"),l(wt,"FINISH","finish"),l(wt,"CANCEL","cancel"),l(wt,"BEGIN","begin"),l(wt,"END","end");var Et={position:"static",display:"block",top:"auto",right:"auto",bottom:"auto",left:"auto",marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,fontSize:"inherit",fontFamily:"inherit",color:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"normal",backgroundColor:"transparent",backgroundSize:"auto",backgroundRepeat:"repeat",backgroundPositionX:0,backgroundPositionY:0,borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopColor:"#000",borderRightColor:"#000",borderBottomColor:"#000",borderLeftColor:"#000",borderTopStyle:"solid",borderRightStyle:"solid",borderBottomStyle:"solid",borderLeftStyle:"solid",borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:0,borderBottomLeftRadius:0,width:"auto",height:"auto",flexGrow:0,flexShrink:1,flexBasis:"auto",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",textAlign:"inherit",transformOrigin:"center",visibility:"visible",opacity:1,zIndex:0,transform:null,translateX:0,translateY:0,scaleX:1,scaleY:1,skewX:0,skewY:0,rotateZ:0},St={fill:"transparent",stroke:"#000",strokeWidth:1,strokeDasharray:"",strokeLinecap:"butt"},At=[];Object.keys(Et).forEach(function(t){var e=Et[t];At.push({k:t,v:e})});var Mt=ne.clone(At);Object.keys(St).forEach(function(t){var e=St[t];Mt.push({k:t,v:e})});var Tt={DOM:Et,GEOM:St,XOM:Object.assign(Et,St),dom:At,geom:Mt},Pt={REPAINT:0,REFLOW:1},Ct={GEOM:{x1:!0,y1:!0,x2:!0,y2:!0,controlA:!0,controlB:!0,r:!0,rx:!0,ry:!0,begin:!0,end:!0,points:!0,controls:!0},STYLE:{transform:!0,translateX:!0,translateY:!0,skewX:!0,skewY:!0,scaleX:!0,scaleY:!0,rotateZ:!0,color:!0,fontStyle:!0,strokeWidth:!0,fill:!0,backgroundColor:!0,backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundSize:!0,stroke:!0,borderBottomColor:!0,borderLeftColor:!0,borderRightColor:!0,borderTopColor:!0,visibility:!0,opacity:!0}},Ot=ne.isNil;var Rt=function(){function o(t,e,i){var r;return h(this,o),r=_(this,X(o).call(this)),ne.isString(t)||(i=e,e=t,t=/(?:function|class)\s+([\w$]+)/.exec(r.constructor.toString())[1]),r.__tagName=t,e=e||[],Array.isArray(e)?(r.props=ne.arr2hash(e),r.__props=e):(r.props=e,r.__props=ne.hash2arr(e)),r.__children=i||[],r.__shadowRoot=null,r.__parent=null,r.__ref={},r.__state={},r}return t(o,wt),u(o,[{key:"setState",value:function(t,e){var i=this;Ot(t)?this.state={}:Object.assign(this.state,t);var r=this.shadowRoot;if(r){var n=this.root;n&&(this.__task={before:function(){var t=i.__traverse(r.ctx,r.defs,n.renderMode);i.__traverseCss(),i.__init(t),n.setRefreshLevel(Pt.REFLOW)},after:e},n.addRefreshTask(this.__task))}}},{key:"__traverse",value:function(t,e,i){for(var r=this.__shadowRoot,n=this.__shadowRoot=this.render(i);n instanceof o;)n=this.__shadowRoot=n.render(i);if(n instanceof s)return n.__ctx=t,n.__defs=e,n.__host=this,n.isGeom||n.__traverse(t,e,i),r;var a="";return Ot(n)||(a=ne.encodeHtml(n.toString())),(n=new J(a)).__ctx=t,n.__defs=e,n.__renderMode=i,n.__style=this.props.style||{},void(this.__shadowRoot=n)}},{key:"__traverseCss",value:function(){var t=this.__shadowRoot;if(!(t instanceof J)){var e=mt.mergeCss(t.props.css,this.props.css);t.__traverseCss(t,e)}}},{key:"__init",value:function(t){var r=this,n=this.shadowRoot;if(n instanceof J)Z.normalize(n.style,Tt.dom);else{var e=this.props.style||{};Object.assign(n.style,e),n.__init()}if(n instanceof J||this.__props.forEach(function(t){var e=t[0],i=t[1];/^on[a-zA-Z]/.test(e)?(e=e.slice(2).toLowerCase(),(n.listener[e]=n.listener[e]||[]).push(i)):/^on-[a-zA-Z\d_$]/.test(e)&&(e=e.slice(3),r.on(e,function(){i.apply(void 0,arguments)}))}),t)return function t(e,i){if(e!==i&&e.tagName===i.tagName&&i.tagName){e.__animationList.forEach(function(t){t.__target=i}),i.__animationList=e.__animationList,e.__animationList=[];var r=e.children,n=i.children;if(r&&n)for(var a=r.length,o=n.length,s=0,h=Math.min(a,o);s<h;s++)t(r[s],n[s])}}(t,n),void t.__destroy();Object.keys(Ct.GEOM).concat(["x","y","ox","oy","sx","sy","width","height","outerWidth","outerHeight","style","animating","animationList","animateStyle","currentStyle","computedStyle","animateProps","currentProps","ctx","defs","baseLine","virtualDom","mask","maskId"]).forEach(function(t){Object.defineProperty(r,t,{get:function(){return this.shadowRoot[t]}})});var i=this.props.ref;if(i){var a=this.parent.host||this.root;a&&(a.ref[i]=this)}}},{key:"render",value:function(){}},{key:"__destroy",value:function(){this.root.delRefreshTask(this.__task),this.shadowRoot&&this.shadowRoot.__destroy(),this.children.splice(0),this.__shadowRoot=null,this.__parent=null}},{key:"__emitEvent",value:function(t,e){var i=this.shadowRoot;if(!(i instanceof J))return e?i.__emitEvent(t,e):i.__emitEvent(t)?(t.target=this,!0):void 0}},{key:"animate",value:function(t,e){var i=this.shadowRoot;i instanceof J||i.animate(t,e)}},{key:"__computed",value:function(){var t=this.shadowRoot;t instanceof J?(Z.compute(t,!0),t.__measure()):t.__computed()}},{key:"__repaint",value:function(){var t=this.shadowRoot;t instanceof J?Z.repaint(t,!0):t.__repaint()}},{key:"tagName",get:function(){return this.__tagName}},{key:"children",get:function(){return this.__children}},{key:"shadowRoot",get:function(){return this.__shadowRoot}},{key:"root",get:function(){if(this.parent)return this.parent.root}},{key:"parent",get:function(){return this.__parent}},{key:"ref",get:function(){return this.__ref}},{key:"state",get:function(){return this.__state},set:function(t){this.__state=t}}]),o}();["__layout","__layoutAbs","__tryLayInline","__offsetX","__offsetY","__calAutoBasis","__calMp","__calAbs","__renderAsMask","__renderByMask","__setCtx"].forEach(function(e){Rt.prototype[e]=function(){var t=this.shadowRoot;if(t&&t[e])return t[e].apply(t,arguments)}});var Lt={cache:null,mask:null};function Wt(t,e,i){var r;return Lt[t]||((r=Lt[t]=document.createElement("canvas")).style.position="absolute",r.style.left="9999px",r.style.top="-9999px",document.body.append(r)),(r=Lt[t]).setAttribute("width",e),r.setAttribute("height",i),r.style.width=e+"px",r.style.height=i+"px",{canvas:r,ctx:r.getContext("2d")}}var Nt,Ft,le={measureText:function(t){var e=J.MEASURE_TEXT,i=e.list,u=e.data,l="",c=[],f=[];if(Object.keys(u).forEach(function(t){var e=u[t],i=e.key,r=e.style,n=e.s;if(n)for(var a="position:absolute;font-family:".concat(r.fontFamily,";font-size:").concat(r.fontSize,"px"),o=0,s=n.length;o<s;o++){c.push(i);var h=n.charAt(o);f.push(h),l+='<span style="'.concat(a,'">').concat(h.replace(/</,"&lt;").replace(" ","&nbsp;"),"</span>")}}),l){var r=document.createElement("div");r.style.position="absolute",r.style.left="99999px",r.style.top="-99999px",r.style.visibility="hidden",document.body.appendChild(r),r.innerHTML=l;for(var n=r.childNodes,a=J.CHAR_WIDTH_CACHE,o=J.MEASURE_TEXT,s=0,h=n.length;s<h;s++){var _=n[s],d=c[s],p=f[s],v=window.getComputedStyle(_,null);a[d][p]=parseFloat(v.width)}i.forEach(function(t){return t.__measureCb()}),t(),o.list=[],o.data={},document.body.removeChild(r)}else t()},measureImg:function(t,e){var i=new Image;if(i.onload=function(){e({success:!0,width:i.width,height:i.height,source:i})},i.onerror=function(){e({success:!1})},"data:"!==t.substr(0,5)){var r=/^(?:\w+:)?\/\/([^/:]+)/.exec(t);r&&location.hostname!==r[1]&&(i.crossOrigin="anonymous")}i.src=t},warn:function(t){console.warn(t)},requestAnimationFrame:(Ft=function(t){var e;return"undefined"!=typeof requestAnimationFrame?(le.requestAnimationFrame=requestAnimationFrame.bind(window),e=requestAnimationFrame(t)):(e=setTimeout(t,1e3/60),le.requestAnimationFrame=function(t){return setTimeout(t,1e3/60)}),e},Bt.toString=function(){return Ft.toString()},Bt),cancelAnimationFrame:(Nt=function(t){var e;return"undefined"!=typeof cancelAnimationFrame?(le.cancelAnimationFrame=cancelAnimationFrame.bind(window),e=cancelAnimationFrame(t)):(e=clearTimeout(t),le.cancelAnimationFrame=function(t){return clearTimeout(t)}),e},Dt.toString=function(){return Nt.toString()},Dt),now:function(){return"undefined"!=typeof performance?(le.now=performance.now.bind(performance),performance.now()):(le.now=Date.now.bind(Date),Date.now())},getCacheCanvas:function(t,e){return Wt("cache",t,e)},getMaskCanvas:function(t,e){return Wt("mask",t,e)}};function Dt(t){return Nt.apply(this,arguments)}function Bt(t){return Ft.apply(this,arguments)}var It=ne.isFunction,Ht=ne.isObject;function jt(t,e,i){"before"===i?t.forEach(function(t){Ht(t)&&It(t.before)&&t.before(e)}):"after"===i&&t.forEach(function(t){Ht(t)&&It(t.after)?t.after(e):It(t)&&t(e)})}var Gt=new(function(){function t(){h(this,t),this.__aTask=[],this.__hookTask=[],this.__task=[],this.__now=null}return u(t,[{key:"__init",value:function(){var a=this,o=a.aTask,s=a.task;le.cancelAnimationFrame(a.id);var h=a.__now=le.now();!function n(){a.id=le.requestAnimationFrame(function(){if(o.length||s.length){var t=a.__now=le.now(),e=t-h;e=Math.max(e,0),h=t;var i=o.slice(0),r=s.slice(0);jt(i,e,"before"),jt(r,e,"before"),a.__hookTask.splice(0).forEach(function(t){return t()}),jt(i,e,"after"),jt(r,e,"after"),(o.length||s.length)&&n()}})}()}},{key:"__onFrame",value:function(t,e){if(t){var i=this.aTask,r=this.task;i.length||r.length||this.__init(),e.push(t)}}},{key:"__offFrame",value:function(t,e){if(t){for(var i=0,r=e.length;i<r;i++){var n=e[i];if(n===t||n.__karasFramecb===t){e.splice(i,1);break}}var a=this.aTask,o=this.task;a.length||o.length||(le.cancelAnimationFrame(this.id),this.__now=null)}}},{key:"onFrame",value:function(t){this.__onFrame(t,this.task)}},{key:"offFrame",value:function(t){this.__offFrame(t,this.task)}},{key:"__onFrameA",value:function(t){this.__onFrame(t,this.aTask)}},{key:"__offFrameA",value:function(t){this.__offFrame(t,this.aTask)}},{key:"__nextFrame",value:function(e,i){var r=this;if(e){var n=It(e)?function(t){e(t),i?r.__offFrameA(n):r.offFrame(n)}:{before:e.before,after:function(t){e.after(t),i?r.__offFrameA(n):r.offFrame(n)}};n.__karasFramecb=e,i?this.__onFrameA(n):this.onFrame(n)}}},{key:"nextFrame",value:function(t){this.__nextFrame(t)}},{key:"__nextFrameA",value:function(t){this.__nextFrame(t,!0)}},{key:"task",get:function(){return this.__task}},{key:"aTask",get:function(){return this.__aTask}}]),t}()),zt=4,Xt=1e-7,Yt=10,Vt="function"==typeof Float32Array;function $t(t,e){return 1-3*e+3*t}function qt(t,e){return 3*e-6*t}function Ut(t){return 3*t}function Zt(t,e,i){return(($t(e,i)*t+qt(e,i))*t+Ut(e))*t}function Qt(t,e,i){return 3*$t(e,i)*t*t+2*qt(e,i)*t+Ut(e)}function Jt(t){return t}function Kt(a,e,o,i){if(!(0<=a&&a<=1&&0<=o&&o<=1))throw new Error("bezier x values must be in [0, 1] range");if(a===e&&o===i)return Jt;for(var s=new(Vt?Float32Array:Array)(11),t=0;t<11;++t)s[t]=Zt(.1*t,a,o);function r(t){for(var e=0,i=1;10!==i&&s[i]<=t;++i)e+=.1;var r=e+.1*((t-s[--i])/(s[i+1]-s[i])),n=Qt(r,a,o);return.001<=n?function(t,e,i,r){for(var n=0;n<zt;++n){var a=Qt(e,i,r);if(0===a)return e;e-=(Zt(e,i,r)-t)/a}return e}(t,r,a,o):0===n?r:function(t,e,i,r,n){for(var a,o,s=0;0<(a=Zt(o=e+(i-e)/2,r,n)-t)?i=o:e=o,Math.abs(a)>Xt&&++s<Yt;);return o}(t,e,e+.1,a,o)}return function(t){return 0===t||1===t?t:Zt(r(t),e,i)}}var ce={linear:Kt(1,1,0,0),easeIn:Kt(.42,0,1,1),easeOut:Kt(0,0,.58,1),ease:Kt(.25,.1,.25,1),easeInOut:Kt(.42,0,.58,1),cubicBezier:Kt},fe=e.AUTO,_e=e.PX,de=e.PERCENT,pe=e.INHERIT,ve=e.RGBA,ye=e.STRING,ge=e.NUMBER,me=ne.isNil,ke=ne.isFunction,be=ne.isNumber,xe=ne.clone,we=ne.equalArr,Ee=ce.linear,Se={};["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color"].forEach(function(t){Se[t]=!0});var Ae={};["fontSize","borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","bottom","left","right","top","flexBasis","width","height","lineHeight","marginBottom","marginLeft","marginRight","marginTop","paddingBottom","paddingLeft","paddingRight","paddingTop","strokeWidth"].forEach(function(t){Ae[t]=!0});var Me={};["backgroundImage","fill","stroke"].forEach(function(t){Me[t]=!0});var Te={linear:!0,radial:!0},Pe={};function Ce(t,e,i){var r=xe(t),n=i.computedStyle;return r.forEach(function(t){var i=t.style;e.forEach(function(t){var e=i[t];me(e)||e.unit===pe&&("color"===t?i[t]={value:ne.rgba2int(n[t]),unit:ve}:Ae.hasOwnProperty(t)?i[t]={value:n[t],unit:_e}:"fontWeight"===t?i[t]={value:n[t],unit:ge}:"fontStyle"!==t&&"fontFamily"!==t&&"textAlign"!==t||(i[t]={value:n[t],unit:ye}))})}),r}function Oe(t,e,i){if("transform"===t){if(e.length!==i.length)return;for(var r=0,n=e.length;r<n;r++){var a=e[r][0];if(a!==i[r][0])return;var o=e[r][1],s=i[r][1];if("matrix"===a){if(o[0]!==s[0]||o[1]!==s[1]||o[2]!==s[2]||o[3]!==s[3]||o[4]!==s[4]||o[5]!==s[5])return}else if(o.value!==s.value||o.unit!==s.unit)return}return 1}if("transformOrigin"===t||"backgroundSize"===t)return e[0].value===i[0].value&&e[0].unit===i[0].unit&&e[1].value===i[1].value&&e[1].unit===i[1].unit;if("backgroundPositionX"===t||"backgroundPositionY"===t||Ae.hasOwnProperty(t)||Pe.hasOwnProperty(t))return e.value===i.value&&e.unit===i.unit;if(Me.hasOwnProperty(t)&&e.k===i.k&&Te.hasOwnProperty(e.k)){var h=e.v,u=i.v;if(e.d!==i.d||h.length!==u.length)return;for(var l=0,c=h.length;l<c;l++){var f=h[l],_=u[l];if(f.length!==_.length)return;for(var d=0;d<4;d++)if(f[0][d]!==_[0][d])return;if(1<f.length&&(f[1].value!==_[1].value||f[1].unit!==_[1].unit))return}return 1}if(Ct.GEOM.hasOwnProperty(t)){if("points"===t||"controls"===t){if(e.length!==i.length)return;for(var p=0,v=e.length;p<v;p++)if(e[p]!==i[p]&&(e[p][0]!==i[p][0]||e[p][1]!==i[p][1]))return;return 1}if("controlA"===t||"controlB"===t)return e.length===i.length&&(e[0]===i[0]&&e[1]===i[1])}return e===i}function Re(t){return!Ct.STYLE.hasOwnProperty(t)&&!Ct.GEOM.hasOwnProperty(t)}function Le(t,e,i){for(var r=!1,n=Pt.REPAINT,a=0,o=i.length;a<o;a++){var s=i[a],h=t[s],u=e[s];if(me(h)||me(u)){if((!me(h)||!me(u))&&(r=!0,Re(s))){n=Pt.REFLOW;break}}else if(!Oe(s,h,u)){if(r=!0,n!==Pt.REPAINT)break;if(Re(s)){n=Pt.REFLOW;break}}}return[r,n]}function We(i,t,e,r,n){e.setRefreshLevel(r),n||e.__frameHook();var a={},o={};Object.keys(i).forEach(function(t){var e=i[t];me(e)||(Ct.GEOM.hasOwnProperty(t)&&(o[t]=e),a[t]=e)}),t.__style=a,t.__props=o}function Ne(i,r,t,n){return t.forEach(function(t){var e=function(_,s,t,d){var p={k:t},e=_[t],i=s[t];if("transform"===t){if(!_[t]||!s[t])return;var v={};e.forEach(function(t){v[t[0]]=t[1]});var y={};i.forEach(function(t){y[t[0]]=t[1]}),p.v=[];var g=t;i.forEach(function(t){var e=ie(t,2),i=e[0],r=e[1];if(v.hasOwnProperty(i)){var n=v[i],a=y[i];if("matrix"===i){for(var o=[],s=0;s<6;s++)o[s]=a[s]-n[s];p.v.push({k:i,v:o})}else if(n.unit===a.unit)p.v.push({k:i,v:r.value-n.value});else if(n.unit===_e&&a.unit===de){var h=100*a.value*d["translateX"===i?"outerWidth":"outerHeight"];p.v.push({k:i,v:h-n.value})}else if(n.unit===de&&a.unit===_e){var u=.01*a.value*d["translateX"===i?"outerWidth":"outerHeight"];p.v.push({k:i,v:u-n.value})}}else if("matrix"===i){var l=[1,0,0,1,0,0];_[g].push([i,l]);for(var c=[],f=0;f<6;f++)c[f]=r[f]-l[f];p.v.push({k:i,v:c})}else _[g].push([i,{value:0,unit:r.unit}]),p.v.push({k:i,v:r.value})}),e.forEach(function(t){var e=ie(t,2),i=e[0],r=e[1];if(!y.hasOwnProperty(i))if("matrix"===i){var n=[1,0,0,1,0,0];s[g].push([i,n]);for(var a=[],o=0;o<6;o++)a[o]=n[o]-r[o];p.v.push({k:i,v:a})}else s[g].push([i,{value:0,unit:r.unit}]),p.v.push({k:i,v:-r.value})})}else if("transformOrigin"===t){p.v=[];for(var r=0;r<2;r++){var n=e[r],a=i[r];if(n.unit===a.unit)p.v.push(a.value-n.value);else if(n.unit===_e&&a.unit===de){var o=.01*a.value*d[r?"outerHeight":"outerWidth"];p.v.push(o-n.value)}else if(n.unit===de&&a.unit===_e){var h=100*a.value*d[r?"outerHeight":"outerWidth"];p.v.push(h-n.value)}}if(we(p.v,[0,0]))return}else if("backgroundPositionX"===t||"backgroundPositionY"===t){if(e.unit===i.unit&&-1<[_e,de].indexOf(e.unit)){var u=i.value-e.value;if(0==u)return;p.v=u}else if(e.unit===_e&&i.unit===de){var l=.01*i.value*d["backgroundPositionX"===t?"innerWidth":"innerHeight"];if(0===(l-=e.value))return;p.v=l}else if(e.unit===de&&i.unit===_e){var c=100*i.value*d["backgroundPositionX"===t?"innerWidth":"innerHeight"];if(0===(c-=e.value))return;p.v=c}}else if(Pe.hasOwnProperty(t)){if(e.unit===i.unit){var f=i.value-e.value;if(0==f)return;p.v=f}else if(e.unit===_e&&i.unit===de){var m=.01*i.value*d[/\w+X$/.test(t)?"outerWidth":"outerHeight"];if(0===(m-=e.value))return;p.v=m}else if(e.unit===de&&i.unit===_e){var k=100*i.value*d[/\w+X$/.test(t)?"outerWidth":"outerHeight"];if(0===(k-=e.value))return;p.v=k}}else if("backgroundSize"===t){p.v=[];for(var b=0;b<2;b++){var x=e[b],w=i[b];if(x.unit===w.unit&&-1<[_e,de].indexOf(x.unit))p.v.push(w.value-x.value);else if(x.unit===_e&&w.unit===de){var E=.01*w.value*d[b?"innerWidth":"innerHeight"];p.v.push(E-x.value)}else{if(x.unit!==de||w.unit!==_e)return p.n=i,p;var S=100*w.value*d[b?"innerWidth":"innerHeight"];p.v.push(S-x.value)}}if(we(p.v,[0,0]))return}else if(Me.hasOwnProperty(t))if(e.k!==i.k)p.n=i;else if("linear"===e.k||"radial"===e.k){var A=e.v,M=i.v;if(we(A,M))return;p.v=[];for(var T,P=d.innerWidth,C=0,O=Math.min(A.length,M.length);C<O;C++){var R=A[C],L=M[C],W=[];W.push([L[0][0]-R[0][0],L[0][1]-R[0][1],L[0][2]-R[0][2],L[0][3]-R[0][3]]),T=we(W,[0,0,0,0]),R[1]&&L[1]?(R[1].unit===L[1].unit?W.push(L[1].value-R[1].value):R[1].unit===_e&&L[1].unit===de?W.push(L[1].value-100*R[1].value/P):R[1].unit===de&&L[1].unit===_e&&W.push(L[1].value-.01*R[1].value/P),T=T&&0===W[4]):(R[1]||L[1])&&(T=!1),p.v.push(W)}if("linear"===e.k){var N=i.d-e.d;if(T&&0==N)return;p.d=N}}else{if(we(i,e))return;p.v=[i[0]-e[0],i[1]-e[1],i[2]-e[2],i[3]-e[3]]}else if(Se.hasOwnProperty(t)){if(i=i.value,e=e.value,we(i,e)||0===i[3]&&0===e[3])return;p.v=[i[0]-e[0],i[1]-e[1],i[2]-e[2],i[3]-e[3]]}else if(Ae.hasOwnProperty(t)){if(e.unit===fe&&i.unit===fe)return;if(e.unit===fe||i.unit===fe)return p.n=i,p;var F=(d.parent||d).computedStyle,D=0;if(e.unit===i.unit)D=i.value-e.value;else if(e.unit===_e&&i.unit===de){var B=100*e.value/F[t];D=i.value-B}else{if(e.unit!==de||i.unit!==_e)return p;var I=.01*e.value*F[t];D=i.value-I}if(0===D)return;p.v=D}else if(Ct.GEOM.hasOwnProperty(t))if(me(i))p.n=null;else if("points"===t||"controls"===t){if(we(e,i))return;p.v=[];for(var H=0,j=Math.min(e.length,i.length);H<j;H++){var G=e[H],z=i[H];if(me(G)||me(z))p.v.push(z);else{for(var X=[],Y=0,V=Math.max(G.length,z.length);Y<V;Y++)me(G[Y])||me(z[Y])?X.push(z[Y]):X.push(z[Y]-G[Y]);p.v.push(X)}}}else if("controlA"===t||"controlB"===t){if(we(e,i))return;p.v=[i[0]-e[0],i[1]-e[1]]}else{if(i===e)return;p.v=i-e}else if("opacity"===t||"zIndex"===t){if(i===e)return;p.v=i-e}else{if(i===e)return;p.n=i}return p}(i.style,r.style,t,n);e&&i.transition.push(e)}),r}function Fe(t){var e;if(/^\s*(?:cubic-bezier\s*)?\(\s*[\d.]+\s*,\s*[-\d.]+\s*,\s*[\d.]+\s*,\s*[-\d.]+\s*\)\s*$/i.test(t)){var i=t.match(/[\d.]+/g);e=ce.cubicBezier(i[0],i[1],i[2],i[3])}else e=ce[t]||Ee;return e}["translateX","translateY","scaleX","scaleY","rotateZ","skewX","skewY"].forEach(function(t){Pe[t]=!0});var De=0,Be=function(){function s(t,e,i){var r;if(h(this,s),(r=_(this,X(s).call(this))).__id=De++,r.__target=t,r.__list=xe(e||[]),!Array.isArray(r.__list)){var n=[],a=r.__list;Object.keys(a).forEach(function(t){var e=a[t];if(Array.isArray(e))for(var i=0,r=e.length;i<r;i++){(n[i]=n[i]||{offset:i/(r-1)})[t]=e[i]}}),r.__list=n}be(i)&&(r.__options={duration:i},i=r.__options);var o=r.__options=i||{};return r.__duration=parseFloat(o.duration)||0,r.__delay=Math.max(0,parseFloat(o.delay)||0),r.__endDelay=Math.max(parseFloat(o.endDelay)||0,0),o.iterations===1/0||ne.isString(o.iterations)&&"infinity"===o.iterations.toLowerCase()?r.__iterations=1/0:(r.__iterations=parseInt(o.iterations),isNaN(r.__iterations)&&(r.__iterations=1)),r.__fps=parseInt(o.fps)||60,r.__fps<0&&(r.__fps=60),r.__fill=o.fill||"none",r.__direction=o.direction||"normal",r.__frames=[],r.__framesR=[],r.__playbackRate=parseFloat(o.playbackRate)||1,r.__playbackRate<0&&(r.__playbackRate=1),r.__startTime=null,r.__currentTime=0,r.__nextTime=0,r.__fpsTime=0,r.__playState="idle",r.__playCount=0,r.__isDestroyed=!1,r.__init(o.easing),r}return t(s,wt),u(s,[{key:"__init",value:function(t){var i=this,e=this.target,r=this.iterations,h=this.frames,n=this.direction,u=this.duration;if(!(r<1)){e.__animateStyle.push(this.__style={}),e.isGeom&&e.__animateProps.push(this.__props={});for(var a=this.list,o=0,s=a.length;o<s;o++){var l=a[o];l.hasOwnProperty("offset")&&(l.offset=parseFloat(l.offset),(isNaN(l.offset)||l.offset<0||1<l.offset||l.offset<=-1)&&(a.splice(o,1),o--,s--))}if(!(a.length<1)){1===a.length&&a.push(a[0]),a.forEach(function(t,e){a[e]=xe(t)}),a[0].offset=0;for(var c=a[a.length-1].offset=1,f=a.length;c<f;c++){var _=a[c];if(!_.offset){for(var d=void 0,p=c+1;p<f&&!(d=a[p]).offset;p++);var v=p-c+1;_=a[c-1];for(var y=(d.offset-_.offset)/v,g=c;g<p;g++){a[g].offset=_.offset+y*(g+1-c)}c=p}}var m=Fe(t);a.forEach(function(t){var e,i,r,n,a,o,s=[];Object.keys(t).forEach(function(t){"offset"!==t&&"easing"!==t&&s.push({k:t,v:Tt.XOM[t]})}),h.push((i=s,r=u,n=m,a=(e=t).offset,o=e.easing,delete e.offset,delete e.easing,n!==Ee&&(a=n(a)),Z.normalize(e,i),{style:e,time:a*r,easing:o,transition:[]}))});var k,b,x,w,E,S,A,M=this.__keys=(b=e,x={},w=[],(k=h).forEach(function(t){var i=t.style;Object.keys(i).forEach(function(t){var e=i[t];me(e)||x.hasOwnProperty(t)||(x[t]=!0,w.push(t))})}),k.forEach(function(t){var e=t.style;w.forEach(function(t){e.hasOwnProperty(t)||(Ct.GEOM.hasOwnProperty(t)?e[t]=b.props[t]:e[t]=b.style[t])})}),w);if(this.__originStyle=(E=M,S={},A=e.style,E.forEach(function(t){S[t]=A[t]}),S),{reverse:!0,alternate:!0,"alternate-reverse":!0}.hasOwnProperty(n)){var T=xe(h).reverse();T.forEach(function(t){t.time=u-t.time,t.transition=[]}),this.__framesR=T}this.__clean=function(t){i.__cancelTask(),i.__nextTime=0,t?(i.__currentTime=i.delay+u+i.endDelay,i.__playCount=r,i.__playState="finished",i.__stayEnd()||(i.__style={})):(i.__playCount=i.__currentTime=0,i.__playState="idle",i.__style={})},this.__fin=function(t){i.__begin=i.__end=i.__isDelay=i.__finish=i.__inFps=i.__enterFrame=null,i.emit(wt.FINISH),ke(t)&&t()},this.__frameCb=function(t,e){i.emit(wt.FRAME,t,e),i.__firstPlay&&(i.__firstPlay=!1,i.emit(wt.PLAY)),ke(i.__playCb)&&(i.__playCb(t,e),i.__playCb=null)}}}}},{key:"__calDiffTime",value:function(t){var e=this.playbackRate;return this.__currentTime=this.__nextTime,1!==e&&0<e&&(t*=e),this.__nextTime+=t,this.__currentTime}},{key:"play",value:function(t){var M=this,e=this.isDestroyed,T=this.duration,i=this.playState,r=this.__frameCb;if(e||T<=0)return this;if("running"===i)return this;this.__cancelTask(),this.__playCb=t,this.__playState="running";var P=this.__firstPlay=!0;if(!this.__enterFrame){var C=this.frames,O=this.framesR,n=this.target,R=this.direction,L=this.delay,W=this.endDelay,N=this.keys,F=this.__clean,a=this.__fin,D=this.__stayEnd();this.__currentTime=this.__nextTime=this.__fpsTime=0;for(var B=(C=Ce(C,N,n)).length,o=C[0],s=1;s<B;s++){o=Ne(o,C[s],N,n)}if(O.length){o=(O=Ce(O,N,n))[0];for(var h=1;h<B;h++){o=Ne(o,O[h],N,n)}}var I=this.__enterFrame={before:function(t){var e=M.root,i=M.style,r=M.fps,n=M.playCount,a=M.iterations;if(e){var o,s,h,u=M.__calDiffTime(t);if(!P&&r<60){if((t=M.__fpsTime+=t)<1e3/r)return void(M.__inFps=!0);M.__fpsTime=0}if(P=!1,0<n&&(L=0),u<L){if(M.__stayBegin()){var l=C[0].style,c=ie(Le(l,i,N),2);o=c[0],s=c[1],o&&We(l,M,e,s)}return 0===u&&(M.__begin=!0),void(M.__isDelay=!0)}if("reverse"===R)h=O;else if({alternate:!0,"alternate-reverse":!0}.hasOwnProperty(R)){var f=n%2==0;h="alternate"===R?f?C:O:f?O:C}else h=C;0===(u-=L)&&(M.__begin=!0);var _,d,y,g,p,v=function t(e,i,r,n){if(e===i)return n[e].time>r?e-1:e;var a=e+(i-e>>1),o=n[a];return o.time===r?a:o.time>r?t(e,Math.max(a-1,e),r,n):t(Math.min(a+1,i),i,r,n)}(0,B-1,u,h),m=h[v],k=v===B-1,b=a-1<=n;if(k){if(_=u<T+W,D||!b){var x=ie(Le(m=m.style,i,N),2);o=x[0],s=x[1]}else{var w=ie(Le(m={},i,N),2);o=w[0],s=w[1]}b?_||(M.__nextTime=0,a<=(n=++M.__playCount)&&Gt.__offFrameA(I)):(M.__nextTime=0,n=++M.__playCount)}else{var E=h[v+1].time-m.time,S=(u-m.time)/E;y=S,g=xe((d=m).style),(p=Fe(d.easing))!==Ee&&(y=p(y)),d.transition.forEach(function(t){var e=t.k,i=t.v,r=t.n,n=t.d,a=g[e];if(t.hasOwnProperty("n"))g[e]=r;else if("transform"===e){var o=g.transform,s={};o.forEach(function(t){s[t[0]]=t[1]}),i.forEach(function(t){var e=t.k,i=t.v;if("matrix"===e)for(var r=0;r<6;r++)s[e][r]+=i[r]*y;else s[e].value+=i*y})}else if("backgroundPositionX"===e||"backgroundPositionY"===e||Ae.hasOwnProperty(e)||Pe.hasOwnProperty(e))0!==i&&(a.value+=i*y);else if("transformOrigin"===e||"backgroundSize"===e)0!==i[0]&&(a[0].value+=i[0]*y),0!==i[1]&&(a[1].value+=i[1]*y);else if(Me.hasOwnProperty(e))if(Te.hasOwnProperty(a.k)){for(var h=0,u=Math.min(a.v.length,i.length);h<u;h++){var l=a.v[h],c=i[h];l[0][0]+=c[0][0]*y,l[0][1]+=c[0][1]*y,l[0][2]+=c[0][2]*y,l[0][3]+=c[0][3]*y,l[1]&&c[1]&&(l[1].value+=c[1]*y)}"linear"===a.k&&void 0!==a.d&&void 0!==n&&(a.d+=n*y)}else a[0]+=i[0]*y,a[1]+=i[1]*y,a[2]+=i[2]*y,a[3]+=i[3]*y;else if(Se.hasOwnProperty(e))(a=a.value)[0]+=i[0]*y,a[1]+=i[1]*y,a[2]+=i[2]*y,a[3]+=i[3]*y;else if(Ct.GEOM.hasOwnProperty(e)){var f=g[e];if("points"===e||"controls"===e){for(var _=0,d=Math.min(f.length,i.length);_<d;_++)if(!me(f[_])&&f[_].length)for(var p=0,v=Math.min(f[_].length,i[_].length);p<v;p++)me(f[_][p])||me(i[_][p])||(f[_][p]+=i[_][p]*y)}else"controlA"===e||"controlB"===e?(f[0]+=i[0]*y,f[1]+=i[1]*y):g[e]+=i*y}else"opacity"!==e&&"zIndex"!==e||(g[e]+=i*y)});var A=ie(Le(m=g,i,N),2);o=A[0],s=A[1]}o&&We(m,M,e,s),!k||_&&!b||(M.__end=!0,a<=n&&(M.__finish=!0,F(!0)))}},after:function(t){M.__inFps?M.__inFps=!1:(r(t,M.__isDelay),M.__isDelay=!1,M.__begin&&(M.__begin=!1,M.emit(wt.BEGIN,M.playCount)),M.__end&&(M.__end=!1,M.emit(wt.END,M.playCount-1)),M.__finish&&(M.__finish=!1,a()))}}}return Gt.__onFrameA(this.__enterFrame),this.__startTime=Gt.__now,this}},{key:"pause",value:function(){var t=this.isDestroyed,e=this.duration,i=this.pending;return t||e<=0||i||(this.__playState="paused",this.__cancelTask(),this.emit(wt.PAUSE)),this}},{key:"finish",value:function(e){var t=this,i=this,r=i.isDestroyed,n=i.duration,a=i.playState;if(r||n<=0)return i;if("finished"===a)return i;i.__cancelTask();var o=i.root,s=i.style,h=i.frames,u=i.keys,l=i.__frameCb,c=i.__clean,f=i.__fin;if(o){var _,d,p;if(i.__stayEnd()){var v=ie(Le(p=h[h.length-1].style,s,u),2);_=v[0],d=v[1]}else{var y=ie(Le(p={},s,u),2);_=y[0],d=y[1]}_?Gt.__nextFrameA(this.__enterFrame={before:function(){We(p,t,o,d),c(!0)},after:function(t){l(t),f(e)}}):(c(!0),f(e))}return i}},{key:"cancel",value:function(t){var e=this,i=this.isDestroyed,r=this.duration,n=this.playState;if(i||r<=0||"idle"===n)return this;this.__cancelTask();var a=this.root,o=this.style,s=this.keys,h=this.__frameCb,u=this.__clean;if(a){var l=ie(Le({},o,s),2),c=l[0],f=l[1],_=function(){e.__cancelTask(),e.__begin=e.__end=e.__isDelay=e.__finish=e.__inFps=e.__enterFrame=null,e.emit(wt.CANCEL),ke(t)&&t()};c?Gt.__nextFrameA(this.__enterFrame={before:function(){We({},e,a,f),u()},after:function(t){h(t),_()}}):(u(),_())}return this}},{key:"gotoAndPlay",value:function(t,e,i){var r=this.isDestroyed,n=this.duration,a=this.delay,o=this.endDelay;return r||n<=0?this:(this.__goto(t,e.isFrame,e.excludeDelay),n+a+o<t?this.finish(i):this.play(i))}},{key:"gotoAndStop",value:function(t,e,i){var r=this,n=this.isDestroyed,a=this.duration,o=this.delay,s=this.endDelay;return n||a<=0?this:a+o+s<(t=this.__goto(t,e.isFrame,e.excludeDelay))?this.finish(i):this.play(function(t){r.__playState="paused",r.__cancelTask(),ke(i)&&i(t)})}},{key:"__goto",value:function(t,e,i){var r=this.duration,n=this.iterations,a=this.delay;if(this.__playState="paused",this.__cancelTask(),isNaN(t)||t<0)throw new Error("Param of gotoAnd(Play/Stop) is illegal: "+t);for(e&&(t=(t-1)/this.spf),i&&(t+=a);r<t&&this.playCount<n-1;)this.__playCount++,t-=r;return this.__nextTime=t}},{key:"addControl",value:function(){var t=this.root.animateController;t&&t.add(this)}},{key:"removeControl",value:function(){var t=this.root.animateController;t&&t.remove(this)}},{key:"__stayBegin",value:function(){return{backwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__stayEnd",value:function(){return{forwards:!0,both:!0}.hasOwnProperty(this.fill)}},{key:"__cancelTask",value:function(){Gt.__offFrameA(this.__enterFrame),this.__playCb=null}},{key:"__destroy",value:function(){this.__clean(),this.__startTime=null,this.__isDestroyed=!0,this.removeControl()}},{key:"id",get:function(){return this.__id}},{key:"target",get:function(){return this.__target}},{key:"root",get:function(){return this.target.root}},{key:"keys",get:function(){return this.__keys}},{key:"style",get:function(){return this.__style}},{key:"props",get:function(){return this.__props}},{key:"list",get:function(){return this.__list}},{key:"options",get:function(){return this.__options}},{key:"duration",get:function(){return this.__duration}},{key:"delay",get:function(){return this.__delay}},{key:"endDelay",get:function(){return this.__endDelay}},{key:"fps",get:function(){return this.__fps},set:function(t){(t=parseInt(t)||60)<=0&&(t=60),this.__fps=t}},{key:"spf",get:function(){return 1/this.fps}},{key:"iterations",get:function(){return this.__iterations},set:function(t){t=parseInt(t),isNaN(t)&&(t=1),this.__iterations=t}},{key:"fill",get:function(){return this.__fill}},{key:"direction",get:function(){return this.__direction}},{key:"frames",get:function(){return this.__frames}},{key:"framesR",get:function(){return this.__framesR}},{key:"playbackRate",get:function(){return this.__playbackRate},set:function(t){(t=parseFloat(t)||0)<0&&(t=1),this.__playbackRate=t}},{key:"startTime",get:function(){return this.__startTime}},{key:"currentTime",get:function(){return this.__currentTime},set:function(t){0<=(t=parseInt(t)||0)&&(this.__currentTime=this.__nextTime=t)}},{key:"pending",get:function(){return"running"!==this.playState}},{key:"finished",get:function(){return"finished"===this.playState}},{key:"playState",get:function(){return this.__playState}},{key:"playCount",get:function(){return this.__playCount},set:function(t){this.__playCount=t}},{key:"isDestroyed",get:function(){return this.__isDestroyed}},{key:"animating",get:function(){var t=this.playState,e=this.options;return"idle"!==t&&("finished"!==t||-1<["forwards","both"].indexOf(e.fill))}}]),s}(),Ie=e.AUTO,He=e.PX,je=e.PERCENT,Ge=e.STRING,ze=ne.clone,Xe=ne.int2rgba,Ye=ne.equalArr,Ve=Z.calRelative,$e=Z.compute,qe=Z.repaint;function Ue(t,e,r,n,i){if(r=Xe(r),t===oe.CANVAS)e.forEach(function(t){n.beginPath(),n.fillStyle=r,n.moveTo(t[0],t[1]);for(var e=2,i=t.length;e<i;e+=2)n.lineTo(t[e],t[e+1]);n.fill(),n.closePath()});else if(t===oe.SVG){var a="";e.forEach(function(t){a+="M ".concat(t[0]," ").concat(t[1]);for(var e=2,i=t.length;e<i;e+=2)a+="L ".concat(t[e]," ").concat(t[e+1]," ")}),i.addBorder([["d",a],["fill",r]])}}function Ze(t,e,i,r,n,a,o,s,h,u,l,c){var f=he.calRadius(i,r,n,a,h,u,l,c),_=f?he.genRdRect(t,o,e,i,r,n,a,f):null;t===oe.CANVAS?f||(o.beginPath(),o.fillStyle=e,o.rect(i,r,n,a),o.fill(),o.closePath()):t===oe.SVG&&s.virtualDom.bb.push(_||{type:"item",tagName:"rect",props:[["x",i],["y",r],["width",n],["height",a],["fill",e]]})}function Qe(t,i,r,n,a){var o=[];return t.forEach(function(t,e){t.unit===He?o.push(t.value):t.unit===je?o.push((e?r:i)+t.value*(e?a:n)*.01):t.unit===Ie?o.push(-1):t.unit===Ge&&o.push("contain"===t.value?-2:-3)}),o}function Je(t,e,i){return"right"===t.value||"bottom"===t.value?e-i:"center"===t.value?.5*(e-i):t.unit===He?t.value:t.unit===je?(e-i)*t.value*.01:0}function Ke(t){return-1<["relative","absolute"].indexOf(t.computedStyle.position)}var ti=function(){function g(t){var r,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return h(this,g),r=_(this,X(g).call(this)),Array.isArray(e)?(r.props=ne.arr2hash(e),r.__props=e):(r.props=e,r.__props=ne.hash2arr(e)),r.__tagName=t,r.__style=ze(r.props.style)||{},r.__animateStyle=[],r.__currentStyle=r.__style,r.__listener={},r.__props.forEach(function(t){var e=t[0],i=t[1];/^on[a-zA-Z]/.test(e)?(e=e.slice(2).toLowerCase(),(r.__listener[e]=r.__listener[e]||[]).push(i)):"id"===e&&i?r.__id=i:-1<["class","className"].indexOf(e)&&i&&(i=mt.splitClass(i))&&(r.__class=i)}),r.__matrix=null,r.__matrixEvent=null,r.__animationList=[],r.__loadBgi={cb:function(){}},r}return t(g,s),u(g,[{key:"__traverseCss",value:function(e,i){var r=this;this.isGeom||this.children.forEach(function(t){(t instanceof g||t instanceof Rt)&&t.__traverseCss(e,i)});var n=mt.parse(this,e,i)||{};Object.keys(n).forEach(function(t){r.__style.hasOwnProperty(t)||(r.__style[t]=n[t])})}},{key:"__measure",value:function(){var t=this.children;t&&t.forEach(function(t){!(t instanceof g)&&t instanceof Rt?t.shadowRoot.__measure():t.__measure()})}},{key:"__mp",value:function(r,n,a){var o=this;["Top","Right","Bottom","Left"].forEach(function(t){var e="margin"+t,i="padding"+t;n[e]=o.__mpWidth(r[e],a),n[i]=o.__mpWidth(r[i],a)})}},{key:"__mpWidth",value:function(t,e){return t.unit===He?t.value:t.unit===je?t.value*e*.01:0}},{key:"__layout",value:function(t,e){var i=this,r=t.w,n=this.isDestroyed,a=this.currentStyle,o=this.computedStyle,s=a.display,h=a.width,u=a.position;if(h.unit!==Ie)switch(h.unit){case He:r=h.value;break;case je:r*=.01*h.value}if(this.__mp(a,o,r),this.__ox=this.__oy=0,n||"none"===s)o.width=o.height=0;else{if("block"===s?this.__layoutBlock(t,e):"flex"===s?this.__layoutFlex(t,e):"inline"===s&&this.__layoutInline(t,e),"relative"===u){var l=a.top,c=a.right,f=a.bottom,_=a.left,d=this.parent;if(l.unit!==Ie){var p=Ve(a,"top",l,d);this.__offsetY(p),o.top=p,o.bottom="auto"}else if(f.unit!==Ie){var v=Ve(a,"bottom",f,d);this.__offsetY(-v),o.bottom=v,o.top="auto"}else o.top=o.bottom="auto";if(_.unit!==Ie){var y=Ve(a,"left",_,d,!0);this.__offsetX(y),o.left=y,o.right="auto"}else if(c.unit!==Ie){var g=Ve(a,"right",c,d,!0);this.__offsetX(-g),o.right=g,o.left="auto"}else o.left=o.right="auto"}else"absolute"!==a.position&&(o.top=o.bottom=o.left=o.right="auto");o.width=this.width,o.height=this.height,["TopLeft","TopRight","BottomRight","BottomLeft"].forEach(function(t){!function(t,e,i,r,n){var a=r[i];if(a.unit===He){var o=Math.min(.5*t,.5*e);n[i]=Math.min(o,a.value)}}(i.width,i.height,"border".concat(t,"Radius"),a,o)});var m=this.__animateRecords;if(m){var k=this.root.__animateController;k.__list=k.__list.concat(m)}}}},{key:"__preLayout",value:function(t){var e=t.x,i=t.y,r=t.w,n=t.h;this.__x=e,this.__y=i;var a,o,s=this.currentStyle,h=this.computedStyle,u=s.width,l=s.height,c=h.borderTopWidth,f=h.borderRightWidth,_=h.borderBottomWidth,d=h.borderLeftWidth,p=h.marginTop,v=h.marginRight,y=h.marginBottom,g=h.marginLeft,m=h.paddingTop,k=h.paddingRight,b=h.paddingBottom,x=h.paddingLeft;if(u.unit!==Ie)switch(a=!0,u.unit){case He:r=u.value;break;case je:r*=.01*u.value}if(l.unit!==Ie)switch(o=!0,l.unit){case He:n=l.value;break;case je:n*=.01*l.value}return e+=d+g+x,t.x=e,i+=c+p+m,t.y=i,u.unit===Ie&&(r-=d+f+g+v+x+k),l.unit===Ie&&(n-=c+_+p+y+m+b),{fixedWidth:a,fixedHeight:o,x:e,y:i,w:r,h:n}}},{key:"__marginAuto",value:function(t,e){var i=t.position,r=t.marginLeft,n=t.marginRight,a=t.width;if("absolute"!==i&&a!==Ie&&r.unit===Ie&&n.unit===Ie){var o=this.outerWidth;o<e.w&&this.__offsetX(.5*(e.w-o),!0)}}},{key:"render",value:function(t){var r=this;(this.__renderMode=t)===oe.SVG&&(this.__virtualDom={bb:[],children:[],opacity:1});for(var e=this.isDestroyed,i=this.ctx,n=this.currentStyle,a=this.computedStyle,o=this.width,s=this.height,h=this.innerWidth,u=this.innerHeight,l=this.outerWidth,c=this.outerHeight,f=a.display,_=a.marginTop,d=a.marginLeft,p=a.paddingTop,v=a.paddingRight,y=a.paddingBottom,g=a.paddingLeft,m=a.backgroundColor,k=a.borderTopWidth,b=a.borderTopColor,x=a.borderTopStyle,w=a.borderRightWidth,E=a.borderRightColor,S=a.borderRightStyle,A=a.borderBottomWidth,M=a.borderBottomColor,T=a.borderBottomStyle,P=a.borderLeftWidth,C=a.borderLeftColor,O=a.borderLeftStyle,R=a.borderTopLeftRadius,L=a.borderTopRightRadius,W=a.borderBottomRightRadius,N=a.borderBottomLeftRadius,F=a.visibility,D=a.backgroundRepeat,B=a.opacity,I=n.backgroundImage,H=n.backgroundSize,j=n.backgroundPositionX,G=n.backgroundPositionY,z=n.transform,X=n.transformOrigin,Y=this.sx,V=this.sy,$=Y+d,q=$+P,U=q+o+g+v,Z=U+w,Q=V+_,J=Q+k,K=J+s+p+y,tt=K+A,et=this.parent,it=B;et;)it*=et.computedStyle.opacity,et=et.parent;t===oe.CANVAS?i.globalAlpha=it:this.__virtualDom.opacity=B;var rt=se.calOrigin(X,Y,V,l,c);a.transformOrigin=rt.join(" ");var nt=[1,0,0,1,0,0];if(this.__matrix=nt,!e&&"none"!==f){if(et=this.parent,z)nt=se.calMatrix(z,rt,l,c),this.__matrix=nt;else{var at=[];["translateX","translateY","rotateZ","rotate","skewX","skewY","scaleX","scaleY"].forEach(function(t){var e=n[t];if(!ne.isNil(e)){a[t]=e.value;var i=-1<t.indexOf("scale");1===e.value&&i||!i&&0===e.value||(e.unit===je&&("translateX"===t?a[t]=e.value*l*.01:"translateY"===t&&(a[t]=e.value*c*.01)),at.push([t,e]))}}),at.length&&(nt=se.calMatrix(at,rt,l,c),this.__matrix=nt)}for(a.transform="matrix("+nt.join(", ")+")";et;){if(et.matrixEvent){nt=se.mergeMatrix(et.matrixEvent,nt);break}et=et.parent}if(this.__matrixEvent=nt,t===oe.CANVAS?i.setTransform.apply(i,re(nt)):t===oe.SVG&&(Ye(this.matrix,[1,0,0,1,0,0])||(this.virtualDom.transform="matrix(".concat(this.matrix.join(","),")"))),"hidden"!==F){if(/,0\)$/.test(m)||Ze(t,m,q,J,h,u,i,this,R,L,W,N),I){if(ne.isString(I))if(this.__loadBgi.url===I){H=Qe(H,q,J,h,u);var ot=this.__loadBgi,st=ot.width,ht=ot.height,ut=ie(H,2),lt=ut[0],ct=ut[1];-1===lt&&-1===ct?(lt=st,ct=ht):-2===lt?h<st&&u<ht?(ct=ht/u)<=(lt=st/h)?ct=(lt=h)*ht/st:lt=(ct=u)*st/ht:h<st?ct=(lt=h)*ht/st:u<ht?lt=(ct=u)*st/ht:(lt=st,ct=ht):-3===lt?st<h&&ht<u?(lt=st/h)<=(ct=ht/u)?ct=(lt=h)*ht/st:lt=(ct=u)*st/ht:st<h||!(ht<u)&&(lt=st/h)<=(ct=ht/u)?ct=(lt=h)*ht/st:lt=(ct=u)*st/ht:-1===lt?lt=ct*st/ht:-1===ct&&(ct=lt*ht/st);var ft=Je(j,h,st),_t=Je(G,u,ht),dt=q+ft,pt=J+_t,vt=0,yt=0,gt=0,mt=0;if(-1<["repeat-x","repeat"].indexOf(D)){var kt=dt-q;0<kt&&(vt=Math.ceil(kt/lt)),0<(kt=q+h-dt-lt)&&(yt=Math.ceil(kt/lt))}if(-1<["repeat-y","repeat"].indexOf(D)){var bt=pt-J;0<bt&&(gt=Math.ceil(bt/ct)),0<(bt=J+u-pt-ct)&&(mt=Math.ceil(bt/ct))}var xt=[];if(0<vt)for(var wt=0;wt<vt;wt++)xt.push([dt-(wt+1)*lt,pt]);if(0<yt)for(var Et=0;Et<yt;Et++)xt.push([dt+(Et+1)*lt,pt]);if(0<gt)for(var St=0;St<gt;St++)xt.push([dt,pt-(St+1)*ct]);if(0<mt)for(var At=0;At<mt;At++)xt.push([dt,pt+(At+1)*ct]);if(0<vt&&0<gt)for(var Mt=0;Mt<vt;Mt++)for(var Tt=0;Tt<gt;Tt++)xt.push([dt-(Mt+1)*lt,pt-(Tt+1)*ct]);if(0<yt&&0<gt)for(var Pt=0;Pt<yt;Pt++)for(var Ct=0;Ct<gt;Ct++)xt.push([dt+(Pt+1)*lt,pt-(Ct+1)*ct]);if(0<vt&&0<mt)for(var Ot=0;Ot<vt;Ot++)for(var Rt=0;Rt<mt;Rt++)xt.push([dt-(Ot+1)*lt,pt+(Rt+1)*ct]);if(0<yt&&0<mt)for(var Lt=0;Lt<yt;Lt++)for(var Wt=0;Wt<mt;Wt++)xt.push([dt+(Lt+1)*lt,pt+(Wt+1)*ct]);var Nt=-1<["repeat-x","repeat-y","repeat"].indexOf(D)||dt<q||pt<J||h<lt||u<ct,Ft=this.__loadBgi.source;if(t===oe.CANVAS&&Ft){var Dt,Bt;if(Nt){var It=this.root,Ht=It.width,jt=It.height;Dt=le.getCacheCanvas(Ht,jt),Bt=Dt.ctx}else Bt=i;Bt.drawImage(Ft,dt,pt,lt,ct),xt.forEach(function(t){Bt.drawImage(Ft,t[0],t[1],lt,ct)}),Nt&&(Bt.globalCompositeOperation="destination-in",Ze(t,"#FFF",q,J,h,u,Bt,this,R,L,W,N),i.drawImage(Dt.canvas,0,0),Bt.globalCompositeOperation="source-over",Bt.clearRect(0,0,st,ht))}else if(t===oe.SVG){var Gt=ue.matrixResize(st,ht,lt,ct,q,J,h,u);Gt=Gt&&Gt.join(",");var zt,Xt=[["xlink:href",I],["x",dt],["y",pt],["width",st||0],["height",ht||0]];if(Gt&&"1,0,0,1,0,0"!==Gt&&(zt=!0,Xt.push(["transform","matrix("+Gt+")"])),Nt){var Yt=this.defs.add({tagName:"mask",props:[],children:[{tagName:"rect",props:[["x",q],["y",J],["width",h],["height",u],["fill","#FFF"]]}]});this.virtualDom.bbMask="url(#".concat(Yt,")")}this.virtualDom.bb.push({type:"img",tagName:"image",props:Xt}),xt.forEach(function(t){var e=ze(Xt);if(zt){var i=ue.matrixResize(st,ht,lt,ct,t[0],t[1],h,u);i&&"1,0,0,1,0,0"!==i&&(i=i.join(","),e[5][1]="matrix("+i+")")}e[1][1]=t[0],e[2][1]=t[1],r.virtualDom.bb.push({type:"img",tagName:"image",props:e})})}a.backgroundSize="".concat(lt," ").concat(ct),a.backgroundPositionX=ft,a.backgroundPositionY=_t}else this.__loadBgi.url=I,le.measureImg(I,function(t){t.success&&(r.__loadBgi.source=t.source,r.__loadBgi.width=t.width,r.__loadBgi.height=t.height,r.root.addRefreshTask(r.__loadBgi.cb))});else if(I.k){Ze(t,this.__gradient(t,q,J,U,K,h,u,"backgroundImage",I,a),q,J,h,u,i,this)}}else{var Vt=q+Je(j,h,0),$t=J+Je(G,u,0);a.backgroundSize=Qe(H,q,J,h,u).join(" "),a.backgroundPositionX=Vt,a.backgroundPositionY=$t,a.backgroundRepeat=D}if(0<k&&!/,0\)$/.test(b)){var qt=Math.atan(k/P),Ut=Math.atan(k/w);Ue(t,he.calPoints(k,x,qt,Ut,$,q,U,Z,Q,J,K,tt,0),b,i,this)}if(0<w&&!/,0\)$/.test(E)){var Zt=Math.atan(w/k),Qt=Math.atan(w/A);Ue(t,he.calPoints(w,S,Zt,Qt,$,q,U,Z,Q,J,K,tt,1),E,i,this)}if(0<A&&!/,0\)$/.test(M)){var Jt=Math.atan(A/P),Kt=Math.atan(A/w);Ue(t,he.calPoints(A,T,Jt,Kt,$,q,U,Z,Q,J,K,tt,2),M,i,this)}if(0<P&&!/,0\)$/.test(C)){var te=Math.atan(P/k),ee=Math.atan(P/A);Ue(t,he.calPoints(P,O,te,ee,$,q,U,Z,Q,J,K,tt,3),C,i,this)}}}}},{key:"__renderByMask",value:function(e){var t=this.prev,i=this.root,r=this.ctx;if(t&&t.isMask)if(e===oe.CANVAS){var n=i.width,a=i.height,o=le.getCacheCanvas(n,a);this.__setCtx(o.ctx),this.render(e),this.__setCtx(r);for(var s=[];t&&t.isMask;)s.unshift(t),t=t.prev;if(1===s.length)t=s[0],o.ctx.globalCompositeOperation="destination-in",t.__setCtx(o.ctx),t.render(e),t.__setCtx(r),r.drawImage(o.canvas,0,0);else{var h=le.getMaskCanvas(n,a);s.forEach(function(t){t.__setCtx(h.ctx),t.render(e),t.__setCtx(r)}),o.ctx.globalCompositeOperation="destination-in",o.ctx.drawImage(h.canvas,0,0),r.drawImage(o.canvas,0,0)}o.ctx.globalCompositeOperation="source-over",o.ctx.clearRect(0,0,n,a)}else e===oe.SVG&&(this.render(e),this.virtualDom.mask=t.maskId);else this.render(e)}},{key:"__destroy",value:function(){var t=this.props.ref;if(t){var e=this.host||this.root;e&&e.ref[t]&&delete e.ref[t]}this.animationList.forEach(function(t){return t.__destroy()}),this.root.delRefreshTask(this.__loadBgi.cb),Y(X(g.prototype),"__destroy",this).call(this),this.__matrix=this.__matrixEvent=null}},{key:"__emitEvent",value:function(e,t){var i=e.event.type,r=this.isDestroyed,n=this.listener,a=this.children,o=this.computedStyle;if(!r&&"none"!==o.display&&!e.__stopPropagation){var s,h;if(n.hasOwnProperty(i)&&(s=n[i]),t){if(!this.isGeom){for(var u=this.zIndexChildren,l=u.length-1;0<=l;l--){var c=u[l];(c instanceof g||c instanceof Rt)&&-1<["absolute","relative"].indexOf(c.computedStyle.position)&&c.__emitEvent(e,t)&&(h=!0)}for(var f=a.length-1;0<=f;f--){var _=a[f];(_ instanceof g||_ instanceof Rt)&&-1===["absolute","relative"].indexOf(_.computedStyle.position)&&_.__emitEvent(e,t)&&(h=!0)}}if(!h&&this.root.__touchstartTarget!==this)return;if(e.__stopPropagation)return;return"touchmove"!==i&&"touchend"!==i&&"touchcancel"!==i||(e.target=this.root.__touchstartTarget),s&&s.forEach(function(t){e.__stopImmediatePropagation||t(e)}),!0}if(!this.isGeom){for(var d=a.length-1;0<=d;d--){var p=a[d];(p instanceof g||p instanceof Rt)&&-1<["absolute","relative"].indexOf(p.computedStyle.position)&&p.__emitEvent(e)&&(h=!0)}for(var v=a.length-1;0<=v;v--){var y=a[v];(y instanceof g||y instanceof Rt)&&-1===["absolute","relative"].indexOf(y.computedStyle.position)&&y.__emitEvent(e)&&(h=!0)}}if(!e.__stopPropagation)return h||this.willResponseEvent(e)?(e.__hasEmitted=!0,s&&s.forEach(function(t){e.__stopImmediatePropagation||ne.isFunction(t)&&t(e)}),!0):void 0}}},{key:"willResponseEvent",value:function(t){var e=t.x,i=t.y;if(!t.__hasEmitted){var r=this.sx,n=this.sy,a=this.outerWidth,o=this.outerHeight,s=this.matrixEvent;return se.pointInQuadrilateral(e,i,r,n,r+a,n,r+a,n+o,r,n+o,s)?(t.target||(t.target=this,"touchstart"===t.event.type&&(this.root.__touchstartTarget=this)),!0):void 0}}},{key:"__gradient",value:function(t,e,i,r,n,a,o,s,h,u){var l=h.k,c=h.v,f=h.d;u[s]=l+"-gradient(";var _,d=e+.5*a,p=i+.5*o;if("linear"===l){var v=A.getLinear(c,f,d,p,a,o);_=this.__getLg(t,v),u[s]+=f+"deg"}else if("radial"===l){var y=A.getRadial(c,f,d,p,e,i,r,n);_=this.__getRg(t,y),u[s]+=f}return c.forEach(function(t){u[s]+=", "+Xe(t[0]),t[1]&&(u[s]+=" "+t[1].str)}),u[s]+=")",_}},{key:"__getLg",value:function(t,e){if(t===oe.CANVAS){var i=this.ctx.createLinearGradient(e.x1,e.y1,e.x2,e.y2);return e.stop.forEach(function(t){i.addColorStop(t[1],t[0])}),i}if(t===oe.SVG){var r=this.defs.add({tagName:"linearGradient",props:[["x1",e.x1],["y1",e.y1],["x2",e.x2],["y2",e.y2]],children:e.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})});return"url(#".concat(r,")")}}},{key:"__getRg",value:function(t,e){if(t===oe.CANVAS){var i=this.ctx.createRadialGradient(e.cx,e.cy,0,e.cx,e.cy,e.r);return e.stop.forEach(function(t){i.addColorStop(t[1],t[0])}),i}if(t===oe.SVG){var r=this.defs.add({tagName:"radialGradient",props:[["cx",e.cx],["cy",e.cy],["r",e.r]],children:e.stop.map(function(t){return{tagName:"stop",props:[["stop-color",t[0]],["offset",100*t[1]+"%"]]}})});return"url(#".concat(r,")")}}},{key:"addBorder",value:function(t){this.virtualDom.bb.push({type:"item",tagName:"path",props:t})}},{key:"animate",value:function(t,e,i){if(!this.isDestroyed){var r=new Be(this,t,e);return this.animationList.push(r),i&&this.root&&this.root.animateController.add(r),r.play()}}},{key:"__computed",value:function(){var e=this;$e(this,this.isRoot),this.isGeom||this.children.forEach(function(t){t instanceof g||t instanceof Rt?t.__computed():(t.__style=e.currentStyle,$e(t),t.__measure())})}},{key:"__repaint",value:function(){var e=this;qe(this,this.isRoot),this.isGeom||this.children.forEach(function(t){t instanceof g||t instanceof Rt?t.__repaint():(t.__style=e.currentStyle,qe(t))})}},{key:"__setCtx",value:function(e){this.__ctx=e,this.isGeom||this.children.forEach(function(t){t.__setCtx(e)})}},{key:"tagName",get:function(){return this.__tagName}},{key:"isRoot",get:function(){return!this.parent}},{key:"isGeom",get:function(){return"$"===this.tagName.charAt(0)}},{key:"innerWidth",get:function(){var t=this.computedStyle,e=t.paddingRight,i=t.paddingLeft;return this.width+i+e}},{key:"innerHeight",get:function(){var t=this.computedStyle,e=t.paddingTop,i=t.paddingBottom;return this.height+e+i}},{key:"outerWidth",get:function(){var t=this.computedStyle,e=t.borderLeftWidth,i=t.borderRightWidth,r=t.marginRight,n=t.marginLeft;return this.innerWidth+e+i+n+r}},{key:"outerHeight",get:function(){var t=this.computedStyle,e=t.borderTopWidth,i=t.borderBottomWidth,r=t.marginTop,n=t.marginBottom;return this.innerHeight+e+i+r+n}},{key:"listener",get:function(){return this.__listener}},{key:"renderMode",get:function(){return this.__renderMode}},{key:"matrix",get:function(){return this.__matrix}},{key:"matrixEvent",get:function(){return this.__matrixEvent}},{key:"id",get:function(){return this.__id}},{key:"class",get:function(){return this.__class||[]}},{key:"animationList",get:function(){return this.__animationList}},{key:"animating",get:function(){for(var t=this.animationList,e=0,i=t.length;e<i;e++){if(t[e].animating)return!0}return!1}},{key:"animateStyle",get:function(){var t=this.style,e=this.animationList,i=ze(t);return e.forEach(function(t){t.animating&&Object.assign(i,t.style)}),i}},{key:"currentStyle",get:function(){return this.__currentStyle}},{key:"zIndexChildren",get:function(){var t=this.children.filter(function(t){return!t.isMask});return pt(t,function(t,e){if(!(t instanceof J))return!!(e instanceof J&&Ke(t))||(!!(t.computedStyle.zIndex>e.computedStyle.zIndex&&Ke(t)&&Ke(e))||(!("static"!==e.computedStyle.position||!Ke(t))||void 0))}),t}}]),g}(),ei=function(){function i(t,e){h(this,i),this.__list=[],this.__x=t,this.__y=e,this.__baseLine=0}return u(i,[{key:"add",value:function(t){this.list.push(t)}},{key:"__calBaseLine",value:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.baseLine)}),e}},{key:"verticalAlign",value:function(){var i=this.__baseLine=this.__calBaseLine();1<this.list.length&&this.list.forEach(function(t){var e=t.baseLine;e!==i&&t.__offsetY(i-e)})}},{key:"horizonAlign",value:function(e){this.list.forEach(function(t){t.__offsetX(e)})}},{key:"list",get:function(){return this.__list}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){var e=0;return this.list.forEach(function(t){e+=t.width}),e}},{key:"height",get:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.height)}),e}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"size",get:function(){return this.__list.length}}]),i}(),ii=e.AUTO,ri=e.PX,ni=e.PERCENT,ai=ne.clone,oi=ne.int2rgba,si=ne.isNil,hi={},ui=function(){function n(t,e){var i;return h(this,n),(i=_(this,X(n).call(this,t,e))).__isMask=!!i.props.mask,i.__animateProps=[],i.__currentProps=i.props,i}return t(n,ti),u(n,[{key:"__init",value:function(){var t=this.style;this.isMask&&(t.position="absolute",t.display="block",t.visibility="visible",t.background=null,t.border=null,t.strokeWidth=0),Z.normalize(t,Tt.geom);var e=this.props.ref;if(e){var i=this.host||this.root;i&&(i.ref[e]=this)}}},{key:"__tryLayInline",value:function(t,e){var i=this.currentStyle.width;return i.unit===ri?t-i.value:i.unit===ni?t-e*i.value*.01:t}},{key:"__calAutoBasis",value:function(t){var e=0,i=0,r=0,n=this.currentStyle,a=this.computedStyle,o=n.width,s=n.height,h=a.borderTopWidth,u=a.borderRightWidth,l=a.borderBottomWidth,c=a.borderLeftWidth,f=t?o:s;if(f.unit!==ii&&(e=r+=f.value),t){var _=u+c;e+=_,r+=_,i+=_}else{var d=h+l;e+=d,r+=d,i+=d}return{b:e,min:i,max:r}}},{key:"__layoutBlock",value:function(t,e){var i=this.__preLayout(t),r=i.fixedWidth,n=i.fixedHeight,a=i.w,o=i.h;this.__height=n?o:0,e?this.__width=r?a:0:(this.__width=a,this.__marginAuto(this.currentStyle,t))}},{key:"__layoutFlex",value:function(t){this.__layoutBlock(t)}},{key:"__layoutInline",value:function(t){var e=this.__preLayout(t),i=e.fixedWidth,r=e.fixedHeight,n=e.x,a=e.y,o=e.w,s=e.h;this.__width=i?o:n-t.x,this.__height=r?s:a-t.y}},{key:"__preRender",value:function(t){var e=this.sx,i=this.sy,r=this.width,n=this.height,a=this.currentStyle,o=this.computedStyle,s=a.strokeWidth,h=a.fill,u=a.stroke,l=a.strokeDasharray,c=a.strokeLinecap,f=o.borderTopWidth,_=o.borderLeftWidth,d=o.display,p=o.marginTop,v=o.marginLeft,y=o.paddingTop,g=o.paddingRight,m=o.paddingBottom,k=o.paddingLeft,b=o.visibility,x=e+_+v+k,w=i+f+p+y,E=x+.5*r,S=w+.5*n,A=r+k+g,M=n+y+m;return s=s.unit===ri?s.value:s.unit===ni?s.value*r*.01:0,o.strokeWidth=s,!u||"linear"!==u.k&&"radial"!==u.k?o.stroke=u=oi(u):u=this.__gradient(t,x,w,w+A,w+M,A,M,"stroke",u,o),!h||"linear"!==h.k&&"radial"!==h.k?o.fill=h=oi(h):h=this.__gradient(t,x,w,w+A,w+M,A,M,"fill",h,o),o.strokeWidth=s,o.strokeDasharray=l.join(", "),o.strokeLinecap=c,{x:e,y:i,originX:x,originY:w,cx:E,cy:S,display:d,stroke:u,strokeWidth:s,strokeDasharray:l,strokeDasharrayStr:o.strokeDasharray,strokeLinecap:c,fill:h,visibility:b}}},{key:"render",value:function(t){Y(X(n.prototype),"render",this).call(this,t),t===oe.SVG&&(this.virtualDom.type="geom");var e=this.isDestroyed,i=this.animateProps,r=this.computedStyle.display;return this.__currentProps=i,e||"none"===r?{isDestroyed:e,display:r}:this.__preRender(t)}},{key:"__renderAsMask",value:function(t){if(t===oe.SVG){this.render(t);var e=this.virtualDom;e.isMask=!0;var i=ai(e.children),T=this.matrixEvent;i.forEach(function(t){var e,i,r=0,n=1,a=t.props;if("rect"===t.tagName){for(var o=0,s=a.length;o<s;o++){var h=ie(a[o],2),u=h[0],l=h[1];"x"===u?(r=o,e=l):"y"===u&&(n=o,i=l)}var c=K.calPoint([e,i],T);a[r][1]=c[0],a[n][1]=c[1]}else if("circle"===t.tagName||"ellipse"===t.tagName){for(var f=0,_=a.length;f<_;f++){var d=ie(a[f],2),p=d[0],v=d[1];"cx"===p?(r=f,e=v):"cy"===p&&(n=f,i=v)}var y=K.calPoint([e,i],T);a[r][1]=y[0],a[n][1]=y[1]}else if("polygon"===t.tagName)for(var g=0,m=a.length;g<m;g++){var k=ie(a[g],2),b=k[0],x=k[1];if("points"===b){a[g][1]=x.replace(/([\d.]+),([\d.]+)/g,function(t,e,i){return K.calPoint([e,i],T).join(",")});break}}else if("path"===t.tagName)for(var w=0,E=a.length;w<E;w++){var S=ie(a[w],2),A=S[0],M=S[1];if("d"===A){a[w][1]=M.replace(/([\d.]+),([\d.]+)/g,function(t,e,i){return K.calPoint([e,i],T).join(",")});break}}});var r=this.prev,n=this.defs;if(r&&r.isMask){var a=n.value;return(a=a[a.length-1]).children=a.children.concat(i),void(this.__maskId=r.maskId)}var o=n.add({tagName:"mask",props:[],children:i});this.__maskId="url(#".concat(o,")")}}},{key:"addGeom",value:function(t,e){e=ne.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"getProps",value:function(t){var e=this.currentProps[t];return si(e)?this["__"+t]:e}},{key:"tagName",get:function(){return this.__tagName}},{key:"baseLine",get:function(){return this.__height}},{key:"isMask",get:function(){return this.__isMask}},{key:"maskId",get:function(){return this.__maskId}},{key:"animateProps",get:function(){var t=this.props,e=this.animationList,i=ai(t);return e.forEach(function(t){t.animating&&Object.assign(i,t.props)}),i}},{key:"currentProps",get:function(){return this.__currentProps}}],[{key:"getRegister",value:function(t){if(!hi.hasOwnProperty(t))throw new Error("Geom has not register: ".concat(t));return hi[t]}},{key:"register",value:function(t,e){if(n.hasRegister(t))throw new Error("Geom has already register: ".concat(t));hi[t]=e}},{key:"hasRegister",value:function(t){return hi.hasOwnProperty(t)}}]),n}(),li=e.AUTO,ci=e.PX,fi=e.PERCENT,_i=Z.calAbsolute,di={div:!0,span:!0,img:!0},pi={span:!0,img:!0};var vi,yi=function(){function c(t,e,i){var r;return h(this,c),(r=_(this,X(c).call(this,t,e))).__children=i||[],r.__flowChildren=[],r.__absChildren=[],r.__lineGroups=[],r}return t(c,ti),u(c,[{key:"__traverse",value:function(e,i,t){var r=this,n=[];this.__traverseChildren(this.children,n,e,i,t);for(var a=n.length-1;0<a;a--){var o=n[a];if(o instanceof J){var s=n[a-1];s instanceof J?(s.content+=o.content,n.splice(a,1)):a--}}var h=null;n.forEach(function(t){t.__ctx=e,t.__defs=i,h&&((h.__next=t).__prev=h),t.__parent=r,h=t}),this.__children=n}},{key:"__traverseChildren",value:function(t,e,i,r,n){var a=this;if(Array.isArray(t))t.forEach(function(t){a.__traverseChildren(t,e,i,r,n)});else if(t instanceof c||t instanceof Rt)e.push(t),t.__traverse(i,r,n);else if(t instanceof ui)e.push(t);else if(!ne.isNil(t)){var o=new J(t);o.__renderMode=n,e.push(o)}}},{key:"__init",value:function(){var i=this,r=this.style,t=this.parent;r.display&&-1!==["flex","block","inline","none"].indexOf(r.display)||(pi.hasOwnProperty(this.tagName)?r.display="inline":r.display="block"),!t||"inline"!==r.display||"absolute"!==r.position&&"flex"!==t.style.display||(r.display="block"),Z.normalize(r,Tt.dom);var n="inline"===r.display;this.children.forEach(function(t){t instanceof ti||t instanceof Rt?t.__init():t.__style=r;var e=t instanceof J;if(e||"absolute"!==t.style.position){if(i.__flowChildren.push(t),n&&!e&&"inline"!==t.style.display)throw new Error("inline can not contain block/flex")}else i.__absChildren.push(t)});var e=this.props.ref;if(e){var a=this.host||this.root;a&&(a.ref[e]=this)}}},{key:"__tryLayInline",value:function(t,e){var i=this.flowChildren,r=this.currentStyle.width;if(r.unit===ci)return t-r.value;if(r.unit===fi)return t-e*r.value*.01;for(var n=0;n<i.length;n++){if(t<0)return t;var a=i[n];t-=a instanceof ti||a instanceof Rt?a.__tryLayInline(t,e):a.textWidth}return t}},{key:"__offsetX",value:function(e,i){Y(X(c.prototype),"__offsetX",this).call(this,e,i),this.flowChildren.forEach(function(t){t&&t.__offsetX(e,i)})}},{key:"__offsetY",value:function(e,i){Y(X(c.prototype),"__offsetY",this).call(this,e,i),this.flowChildren.forEach(function(t){t&&t.__offsetY(e,i)})}},{key:"__calAutoBasis",value:function(a,o,s,t){var h=0,u=0,l=0,e=this.flowChildren,i=this.currentStyle,r=this.computedStyle,n=i.width,c=i.height,f=i.marginLeft,_=i.marginTop,d=i.marginRight,p=i.marginBottom,v=i.paddingLeft,y=i.paddingTop,g=i.paddingRight,m=i.paddingBottom,k=r.borderTopWidth,b=r.borderRightWidth,x=r.borderBottomWidth,w=r.borderLeftWidth,E=a?n:c;if(E.unit===ci&&(h=l=E.value,t&&(u=h)),e.forEach(function(t){if(t instanceof ti||t instanceof Rt){var e=t.__calAutoBasis(a,o,s,!0),i=e.b,r=e.min,n=e.max;h=Math.max(h,i),u=Math.max(u,r),l=Math.max(l,n)}else l=a?(u=Math.max(t.charWidth,u),Math.max(t.textWidth,l)):(t.__layout({x:0,y:0,w:o,h:s},!0),u=Math.max(u,t.height),Math.max(l,t.height))}),a){var S=b+w+(this.__calMp(f,o)+this.__calMp(d,o)+this.__calMp(v,o)+this.__calMp(g,o));h+=S,l+=S,u+=S}else{var A=k+x+(this.__calMp(_,o)+this.__calMp(p,o)+this.__calMp(y,o)+this.__calMp(m,o));h+=A,l+=A,u+=A}return{b:h,min:u,max:l}}},{key:"__calMp",value:function(t,e){var i=0;return t.unit===ci?i+=t.value:t.unit===fi&&(t.value*=.01*e,t.unit=ci,i+=t.value),i}},{key:"__layoutBlock",value:function(e,i){var t=this.flowChildren,r=this.currentStyle,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o=n.textAlign,s=this.__preLayout(e),h=s.fixedWidth,u=s.fixedHeight,l=s.x,c=s.y,f=s.w,_=s.h;if(h&&i)this.__width=f;else{var d=0,p=0,v=new ei(l,c);t.forEach(function(t){t instanceof ti||t instanceof Rt?"inline"===t.currentStyle.display?l===e.x?(v.add(t),t.__layout({x:l,y:c,w:f,h:_},i),l+=t.outerWidth,i&&(d=Math.max(d,p),p=t.outerWidth)):(0<=t.__tryLayInline(f-l+e.x,f)?t.__layout({x:l,y:c,w:f,h:_},i):(a.push(v),i||v.verticalAlign(),l=e.x,c+=v.height,t.__layout({x:e.x,y:c,w:f,h:_},i),v=new ei(l,c),i&&(d=Math.max(d,p),p=0)),l+=t.outerWidth,v.add(t),i&&(p+=t.outerWidth)):(v.size&&(a.push(v),v.verticalAlign(),c+=v.height,v=new ei(e.x,c),i&&(d=Math.max(d,p),p=0)),t.__layout({x:e.x,y:c,w:f,h:_},i),l=e.x,c+=t.outerHeight,i&&(d=Math.max(d,t.outerWidth),p=0)):l===e.x?(v.add(t),t.__layout({x:l,y:c,w:f,h:_},i),l+=t.width,i&&(d=Math.max(d,p),p=t.width)):(0<=t.__tryLayInline(f-l+e.x)?t.__layout({x:l,y:c,w:f,h:_},i):(a.push(v),v.verticalAlign(),l=e.x,c+=v.height,t.__layout({x:e.x,y:c,w:f,h:_},i),v=new ei(l,c),i&&(d=Math.max(d,p),p=0)),l+=t.width,v.add(t),i&&(p+=t.width))}),v.size&&(a.push(v),i?d=Math.max(d,p):v.verticalAlign(),c+=v.height),this.__width=h||!i?f:d,this.__height=u?_:c-e.y,!i&&-1<["center","right"].indexOf(o)&&a.forEach(function(t){var e=f-t.width;0<e&&t.horizonAlign("center"===o?.5*e:e)}),i||this.__marginAuto(r,e)}}},{key:"__layoutFlex",value:function(t,l){var e=this.flowChildren,i=this.currentStyle,r=i.flexDirection,n=i.justifyContent,a=i.alignItems,o=this.__preLayout(t),s=o.fixedWidth,S=o.fixedHeight,A=o.x,M=o.y,T=o.w,P=o.h;if(s&&l)this.__width=T;else{var c=0,C="row"===r,O=[],R=[],L=[],W=[],N=0,F=0,D=0,f=0;if(e.forEach(function(t){if(t instanceof ti||t instanceof Rt){var e=t.__calAutoBasis(!!l||C,T,P),i=e.b,r=e.min,n=e.max;if(l)return void(C?c+=n:c=Math.max(c,n));var a=t.currentStyle,o=t.computedStyle,s=a.flexGrow,h=a.flexShrink,u=a.flexBasis;O.push(s),R.push(h),N+=s,F+=h,u.unit===li?(L.push(n),D+=n):u.unit===ci?(o.flexBasis=i=u.value,L.push(i),D+=i):u.unit===fi&&(i=o.flexBasis=(C?T:P)*u.value*.01,L.push(i),D+=i),f+=n,W.push(r)}else{if(l)return void(C?c+=t.textWidth:c=Math.max(c,t.textWidth));O.push(0),R.push(1),F+=1,C?(L.push(t.textWidth),D+=t.textWidth,f+=t.textWidth,W.push(t.charWidth)):(t.__layout({x:0,y:0,w:T,h:P},!0),L.push(t.height),D+=t.height,f+=t.height,W.push(t.height))}}),l)this.__width=Math.min(c,T);else{var B=0,I=(C?T:P)<f;e.forEach(function(t,e){var i,r=R[e],n=O[e];if(I){var a=D-(C?T:P);i=r?L[e]-a*r/F:L[e]}else{var o=(C?T:P)-D;i=n?L[e]+o*n/N:L[e]}if(i=Math.max(i,W[e]),t instanceof ti||t instanceof Rt){var s=t.currentStyle,h=t.computedStyle,u=s.display,l=s.flexDirection,c=s.width,f=s.height;if(C?("flex"===u&&"column"===l&&S&&f.unit===li&&(f.value=P,f.unit=ci),t.__layout({x:A,y:M,w:i,h:P})):("inline"===u?s.display=h.display="block":"flex"===u&&"row"===l&&c.unit===li&&(c.value=T,c.unit=ci),t.__layout({x:A,y:M,w:T,h:i})),I&&r||!I&&n){var _=h.borderTopWidth,d=h.borderRightWidth,p=h.borderBottomWidth,v=h.borderLeftWidth,y=h.marginTop,g=h.marginRight,m=h.marginBottom,k=h.marginLeft,b=h.paddingTop,x=h.paddingRight,w=h.paddingBottom,E=h.paddingLeft;C?t.__width=i-k-g-E-x-v-d:t.__height=i-y-m-b-w-_-p}}else t.__layout({x:A,y:M,w:C?i:T,h:C?P:i});B=C?(A+=t.outerWidth,Math.max(B,t.outerHeight)):(M+=t.outerHeight,Math.max(B,t.outerWidth))});var h=C?T-A+t.x:P-M+t.y;if(!I&&0===N&&0<h){var u=e.length;if("flex-end"===n)for(var _=0;_<u;_++){var d=e[_];C?d.__offsetX(h,!0):d.__offsetY(h,!0)}else if("center"===n)for(var p=.5*h,v=0;v<u;v++){var y=e[v];C?y.__offsetX(p,!0):y.__offsetY(p,!0)}else if("space-between"===n)for(var g=h/(u-1),m=1;m<u;m++){var k=e[m];C?k.__offsetX(g*m,!0):k.__offsetY(g*m,!0)}else if("space-around"===n)for(var b=h/(u+1),x=0;x<u;x++){var w=e[x];C?w.__offsetX(b*(x+1),!0):w.__offsetY(b*(x+1),!0)}}C?(S&&(B=P),M+=B):s&&(B=T),l||("stretch"===a?e.forEach(function(t){var e=t.computedStyle,i=t.currentStyle,r=e.borderTopWidth,n=e.borderRightWidth,a=e.borderBottomWidth,o=e.borderLeftWidth,s=e.marginTop,h=e.marginRight,u=e.marginBottom,l=e.marginLeft,c=e.paddingTop,f=e.paddingRight,_=e.paddingBottom,d=e.paddingLeft;C?i.height.unit===li&&(t.__height=e.height=B-s-u-c-_-r-a):i.width.unit===li&&(t.__width=e.width=B-l-h-d-f-n-o)}):"center"===a?e.forEach(function(t){var e=B-t.outerHeight;0<e&&t.__offsetY(.5*e,!0)}):"flex-end"===a&&e.forEach(function(t){var e=B-t.outerHeight;0<e&&t.__offsetY(e,!0)})),this.__width=T,this.__height=S?P:M-t.y,this.__marginAuto(i,t)}}}},{key:"__layoutInline",value:function(e,i){var r=this,t=this.flowChildren,n=this.computedStyle,a=this.lineGroups;a.splice(0);var o=n.textAlign,s=this.__preLayout(e),h=s.fixedWidth,u=s.fixedHeight,l=s.x,c=s.y,f=s.w,_=s.h;if(h&&i)this.__width=f;else{var d=0,p=0,v=new ei(l,c);t.forEach(function(t){t instanceof ti||t instanceof Rt?l===e.x?(v.add(t),t.__layout({x:l,y:c,w:f,h:_},i),l+=t.outerWidth,d=Math.max(d,p),p=t.outerWidth):(0<=t.__tryLayInline(f-l+e.x,f)?t.__layout({x:l,y:c,w:f,h:_},i):(a.push(v),v.verticalAlign(),l=e.x,c+=v.height,t.__layout({x:e.x,y:c,w:f,h:_},i),v=new ei(l,c),d=Math.max(d,p),p=0),l+=t.outerWidth,v.add(t),p+=t.outerWidth):l===e.x?(v.add(t),t.__layout({x:l,y:c,w:f,h:_},i),l+=t.width,d=Math.max(d,p),p=t.width):(0<=t.__tryLayInline(f-l+e.x)?t.__layout({x:l,y:c,w:f,h:_},i):(a.push(v),i||v.verticalAlign(),l=e.x,c+=v.height,t.__layout({x:e.x,y:c,w:f,h:_},i),v=new ei(l,c),d=Math.max(d,p),p=0),l+=t.width,v.add(t),p+=t.width)}),v.size&&(a.push(v),i||v.verticalAlign(),c+=v.height,d=Math.max(d,p)),this.__width=h?f:d,this.__height=u?_:c-e.y,!i&&-1<["center","right"].indexOf(o)&&a.forEach(function(t){var e=r.__width-t.width;0<e&&t.horizonAlign("center"===o?.5*e:e)})}}},{key:"__layoutAbs",value:function(i,r){var S=i.sx,A=i.sy,M=i.innerWidth,T=i.innerHeight,t=i.computedStyle,e=this.isDestroyed,n=this.children,a=this.absChildren,o=t.display,s=t.borderTopWidth,h=t.borderLeftWidth,u=t.marginTop,l=t.marginLeft,P=t.paddingLeft;e||"none"===o||(S+=l+h,A+=u+s,a.forEach(function(t){var e,i,r,n,a,o,s,h,u,l,c,f=t.currentStyle,_=t.computedStyle,d=f.left,p=f.top,v=f.right,y=f.bottom,g=f.width,m=f.height,k=f.display,b=f.flexDirection;if(d.unit!==li?(l=!0,_.left=_i(f,"left",d,M)):_.left="auto",v.unit!==li?(h=!0,_.right=_i(f,"right",v,M)):_.right="auto",p.unit!==li?(s=!0,_.top=_i(f,"top",p,T)):_.top="auto",y.unit!==li?(u=!0,_.bottom=_i(f,"bottom",y,T)):_.bottom="auto",l&&h?(e=S+_.left,r=S+M-_.right-e):l&&g.unit!==li?(e=S+_.left,r=g.unit===ci?g.value:M*g.value*.01):h&&g.unit!==li?(r=g.unit===ci?g.value:M*g.value*.01,e=S+M-_.right-r):l?e=S+_.left:h?(e=S+M-_.right,a=!0):(e=S+P,g.unit!==li&&(r=g.unit===ci?g.value:M*g.value*.01)),s&&u)i=A+_.top,n=A+T-_.bottom-i;else if(s&&m.unit!==li)i=A+_.top,n=m.unit===ci?m.value:T*m.value*.01;else if(u&&m.unit!==li)n=m.unit===ci?m.value:T*m.value*.01,i=A+T-_.bottom-n;else if(s)i=A+_.top;else if(u)i=A+T-_.bottom,o=!0;else{i=A;for(var x=t.prev;x;){if(x instanceof J||"absolute"!==x.computedStyle.position){i=x.y+x.outerHeight;break}x=x.prev}x||(i=A),m.unit!==li&&(n=m.unit===ci?m.value:T*m.value*.01)}void 0!==r&&(f.width={value:r,unit:ci,virtual:!0}),void 0!==n&&(f.height={value:n,unit:ci,virtual:!0}),("block"===k&&void 0===r||"flex"===k&&(void 0===r||"column"===b&&void 0===n))&&(c=!0);var w=a?e-S:M+S-e,E=o?i-A:T+A-i;c&&(t.__layout({x:e,y:i,w:w,h:E},!0),w=t.outerWidth),t.__layout({x:e,y:i,w:w,h:E}),a&&t.__offsetX(-t.outerWidth,!0),o&&t.__offsetY(-t.outerHeight,!0)}),n.forEach(function(t){if(t instanceof c)t.__layoutAbs(-1<["absolute","relative"].indexOf(t.computedStyle.position)?t:i,r);else if(t instanceof Rt){var e=t.shadowRoot;e instanceof c&&e.__layoutAbs(e,r)}}))}},{key:"render",value:function(e){Y(X(c.prototype),"render",this).call(this,e),e===oe.SVG&&(this.virtualDom.type="dom");var t=this.isDestroyed,i=this.computedStyle,r=i.display,n=i.visibility,a=this.flowChildren,o=this.children;if(!t&&"none"!==r&&"hidden"!==n){o.forEach(function(t){t.isMask&&t.__renderAsMask(e)}),a.forEach(function(t){!t.isMask&&(t instanceof J||"static"===t.computedStyle.position)&&t.__renderByMask(e)});var s=this.zIndexChildren;s.forEach(function(t){t.isMask||t instanceof J||!(-1<["relative","absolute"].indexOf(t.computedStyle.position))||t.__renderByMask(e)}),e===oe.SVG&&(this.__virtualDom=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?f(Object(i),!0).forEach(function(t){l(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({},this.virtualDom,{children:s.map(function(t){return t.virtualDom})}))}}},{key:"__destroy",value:function(){this.children.forEach(function(t){t.__destroy()}),Y(X(c.prototype),"__destroy",this).call(this),this.children.splice(0),this.flowChildren.splice(0),this.absChildren.splice(0),this.lineGroups.splice(0)}},{key:"tagName",get:function(){return this.__tagName}},{key:"children",get:function(){return this.__children}},{key:"flowChildren",get:function(){return this.__flowChildren}},{key:"absChildren",get:function(){return this.__absChildren}},{key:"lineGroups",get:function(){return this.__lineGroups}},{key:"baseLine",get:function(){var t=this.lineGroups.length;if(t){var e=this.lineGroups[t-1];return e.y-this.y+e.baseLine}return this.y}}],[{key:"isValid",value:function(t){return di.hasOwnProperty(t)}}]),c}(),gi=e.AUTO,mi=e.PX,ki={},bi=function(){function z(t,e){var i;if(h(this,z),!(i=_(this,X(z).call(this,t,e,[]))).src||!i.src.trim()){i.__error=!0;var r=o(i).style,n=r.width,a=r.height;a=a||{unit:gi},(n=n||{unit:gi}).unit===gi&&(n.value=32,n.unit=mi),a.unit===gi&&(a.value=32,a.unit=mi)}return i}return t(z,yi),u(z,[{key:"__layout",value:function(t){var n=this;Y(X(z.prototype),"__layout",this).call(this,t);var e=this.isDestroyed,i=this.src,a=this.style,r=this.currentStyle,o=r.display,s=r.width,h=r.height;if(!e&&"none"!==o){var u=this.width,l=this.height,c=ki[this.src]=ki[this.src]||{state:0,task:[]},f=function(t,e){t.success?n.__source=t.source:n.__error=!0,n.__imgWidth=t.width,n.__imgHeight=t.height;var i=Pt.REFLOW;if(s.unit===gi&&h.unit===gi?(a.width={value:t.width,unit:mi},a.height={value:t.height,unit:mi}):s.unit===gi?a.width={value:l*t.width/t.height,unit:mi}:h.unit===gi?a.height={value:u*t.height/t.width,unit:mi}:i=Pt.REPAINT,!e){var r=n.root;r&&(n.__task={before:function(){r.setRefreshLevel(i)}},r.addRefreshTask(n.__task))}};2===c.state?f(c,!0):1===c.state?c.task.push(f):0===c.state&&(c.state=1,c.task.push(f),le.measureImg(i,function(t){c.success=t.success,t.success?(c.width=t.width||32,c.height=t.height||32,c.source=t.source):(c.width=32,c.height=32),c.state=2,c.task.splice(0).forEach(function(t){return t(c)})},{width:s,height:h}))}}},{key:"__addGeom",value:function(t,e){e=ne.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"__destroy",value:function(){this.root.delRefreshTask(this.__task),Y(X(z.prototype),"__destroy",this).call(this)}},{key:"render",value:function(t){Y(X(z.prototype),"render",this).call(this,t);var e=this.ctx,i=this.sx,r=this.sy,n=this.width,a=this.height,o=this.src,s=this.isDestroyed,h=this.computedStyle,u=h.display,l=h.borderTopWidth,c=h.borderLeftWidth,f=h.marginTop,_=h.marginLeft,d=h.paddingTop,p=h.paddingLeft,v=h.borderTopLeftRadius,y=h.borderTopRightRadius,g=h.borderBottomRightRadius,m=h.borderBottomLeftRadius;if(!s&&"none"!==u){var k=i+_+c+p,b=r+f+l+d;if(this.__error){var x=.02*Math.min(n,a),w="#DDD",E=k+.7*n,S=b+.3*a,A=5*x,M=[[k+.15*n,b+.7*a],[k+.3*n,b+.4*a],[k+.5*n,b+.6*a],[k+.6*n,b+.5*a],[k+.9*n,b+.8*a],[k+.15*n,b+.8*a]];if(t===oe.CANVAS){e.strokeStyle="#CCC",e.lineWidth=x,e.fillStyle=w,e.beginPath(),e.moveTo(k,b),e.lineTo(k+n,b),e.lineTo(k+n,b+a),e.lineTo(k,b+a),e.lineTo(k,b),e.stroke(),e.closePath(),e.beginPath(),e.arc(E,S,A,0,2*Math.PI),e.fill(),e.closePath(),e.beginPath(),e.moveTo(M[0][0],M[0][1]);for(var T=1,P=M.length;T<P;T++){var C=M[T];e.lineTo(C[0],C[1])}e.lineTo(M[0][0],M[0][1]),e.fill(),e.closePath()}else if(t===oe.SVG){this.__addGeom("rect",[["x",k],["y",b],["width",n],["height",a],["stroke","#CCC"],["stroke-width",x],["fill","rgba(0,0,0,0)"]]),this.__addGeom("circle",[["cx",E],["cy",S],["r",A],["fill",w]]);for(var O="",R=0,L=M.length;R<L;R++){var W=M[R];O+="".concat(W[0],",").concat(W[1]," ")}this.__addGeom("polygon",[["points",O],["fill",w]])}}else if(this.__source){var N=he.calRadius(k,b,n,a,v,y,g,m);if(t===oe.CANVAS)if(N){var F=this.root,D=F.width,B=F.height,I=le.getCacheCanvas(D,B);I.ctx.drawImage(this.__source,0,0,D,B),I.ctx.globalCompositeOperation="destination-in",he.genRdRect(t,I.ctx,"#FFF",i,r,D,B,N),e.drawImage(I.canvas,0,0),I.ctx.globalCompositeOperation="source-over",I.ctx.clearRect(0,0,D,B)}else e.drawImage(this.__source,k,b,n,a);else if(t===oe.SVG){var H;void 0===this.__imgWidth||n===this.__imgWidth&&a===this.__imgHeight||(H=ue.matrixResize(this.__imgWidth,this.__imgHeight,n,a,k,b,n,a),this.matrix?(this.__matrix=H=se.mergeMatrix(this.__matrix,H),this.__matrixEvent=se.mergeMatrix(this.__matrixEvent,H)):this.__matrixEvent=H,H=H.join(","));var j=[["xlink:href",o],["x",k],["y",b],["width",this.__imgWidth||0],["height",this.__imgHeight||0]];if(N){var G=this.defs.add({tagName:"mask",props:[],children:[he.genRdRect(t,e,"#FFF",k,b,n,a,N)]});j.push(["mask","url(#".concat(G,")")])}H&&"1,0,0,1,0,0"!==H&&j.push(["transform","matrix("+H+")"]),this.virtualDom.children.push({type:"img",tagName:"image",props:j})}}}}},{key:"src",get:function(){return this.props.src}},{key:"baseLine",get:function(){return this.height}}]),z}(),xi=ne.joinVd,wi=ne.joinDef;function Ei(t,e,i){var r=t.childNodes;!function(t,e,i){for(var r=e.length,n=i.length,a=0,o=t.childNodes;a<Math.min(r,n);a++)Si(o[a],e[a],i[a]);if(a<r)for(var s=r-1;a<=s;s--)Ni(t,o,s);else if(a<n)for(;a<n;a++)Wi(t,o,a,wi(i[a]))}(r[0],e.defs,i.defs),Ci(r[1],e.bb,i.bb,e.bbMask,i.bbMask),Ti(t,e,i,!0)}function Si(e,t,i){if(t.tagName!==i.tagName)Fi(e,"beforebegin",wi(i)),e.parentNode.removeChild(e);else{t.uuid!==i.uuid&&e.setAttribute("id",i.uuid);for(var r={},n=0,a=t.props.length;n<a;n++){var o=ie(t.props[n],2),s=o[0],h=o[1];r[s]=h}for(var u=0,l=i.props.length;u<l;u++){var c=ie(i.props[u],2),f=c[0],_=c[1];r.hasOwnProperty(f)?(r[f]!==_&&e.setAttribute(f,_),delete r[f]):e.setAttribute(f,_)}Object.keys(r).forEach(function(t){e.removeAttribute(t)});for(var d=e.childNodes,p=t.children.length,v=i.children.length,y=0;y<Math.min(p,v);y++)Oi(e,y,t.children[y],i.children[y]);if(y<p)for(var g=p-1;y<=g;g--)Ni(e,d,g);else if(y<v)for(;y<v;y++)Wi(e,d,y,xi(i.stop[y]))}}function Ai(t,e,i){"dom"===e.type?"dom"===i.type?Ti(t,e,i):"geom"===i.type?Pi(t,e,i):Li(t,i):"text"===e.type?"text"===i.type?function(t,e,i){for(var r=e.children.length,n=i.children.length,a=0;a<Math.min(r,n);a++)Oi(t,a,e.children[a],i.children[a],!0);var o=t.childNodes;if(a<r)for(var s=r-1;a<=s;s--)Ni(t,o,s);else if(a<n)for(;a<n;a++)Wi(t,o,a,xi(i.children[a]))}(t,e,i):Li(t,i):"geom"===e.type?"dom"===i.type?Pi(t,e,i):"geom"===i.type?function(t,e,i){Mi(t,e,i),Ci(t.firstChild,e.bb,i.bb,e.bbMask,i.bbMask);for(var r=e.children.length,n=i.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(r,n);a++)Oi(o,a,e.children[a],i.children[a]);if(a<r)for(var h=r-1;a<=h;h--)Ni(o,s,h);else if(a<n)for(;a<n;a++)Wi(o,s,a,xi(i.children[a]))}(t,e,i):Li(t,i):"img"===e.type&&("img"===i.type?Ri(t,e,i):Li(t,i))}function Mi(t,e,i){var r=i.transform,n=i.opacity,a=i.mask;e.transform!==r&&(r?t.setAttribute("transform",r):t.removeAttribute("transform")),e.opacity!==n&&(1!==n?t.setAttribute("opacity",n):t.removeAttribute("opacity")),e.mask!==a&&(a?t.setAttribute("mask",a):t.removeAttribute("mask"))}function Ti(t,e,i,r){Mi(t,e,i),r||Ci(t.firstChild,e.bb,i.bb,e.bbMask,i.bbMask);for(var n=e.children.length,a=i.children.length,o=0,s=t.lastChild,h=s.childNodes;o<Math.min(n,a);o++)Ai(h[o],e.children[o],i.children[o]);if(o<n)for(var u=n-1;o<=u;u--)Ni(s,h,u);else if(o<a)for(;o<a;o++)Wi(s,h,o,xi(i.children[o]))}function Pi(t,e,i){Mi(t,e,i),Ci(t.firstChild,e.bb,i.bb,e.bbMask,i.bbMask);for(var r=e.children.length,n=i.children.length,a=0,o=t.lastChild,s=o.childNodes;a<Math.min(r,n);a++)Li(s[a],i.children[a]);if(a<r)for(var h=r-1;a<=h;h--)Ni(o,s,h);else if(a<n)for(;a<n;a++)Wi(o,s,a,xi(i.children[a]))}function Ci(t,e,i,r,n){var a=e.length,o=i.length;r!==n&&(n?t.setAttribute("mask",n):t.removeAttribute("mask"));for(var s=0;s<Math.min(a,o);s++)Oi(t,s,e[s],i[s]);var h=t.childNodes;if(s<a)for(var u=a-1;s<=u;u--)Ni(t,h,u);else if(s<o)for(;s<o;s++)Wi(t,h,s,xi(i[s]))}function Oi(t,e,i,r,n){var a=t.childNodes;i.tagName!==r.tagName?Li(a[e],r):(Ri(a[e],i,r),n&&i.content!==r.content&&(a[e].innerHTML=r.content))}function Ri(e,t,i){for(var r={},n=0,a=t.props.length;n<a;n++){var o=ie(t.props[n],2),s=o[0],h=o[1];r[s]=h}for(var u=0,l=i.props.length;u<l;u++){var c=ie(i.props[u],2),f=c[0],_=c[1];r.hasOwnProperty(f)?(r[f]!==_&&e.setAttribute(f,_),delete r[f]):e.setAttribute(f,_)}Object.keys(r).forEach(function(t){e.removeAttribute(t)})}function Li(t,e){var i;Array.isArray(e)?(i="",e.forEach(function(t){i+=xi(t)})):i=xi(e),Fi(t,"beforebegin",i),t.parentNode.removeChild(t)}function Wi(t,e,i,r){i>=e.length?Fi(t,"beforeend",r):Fi(e[i],"beforebegin",r)}function Ni(t,e,i){e[i]&&t.removeChild(e[i])}function Fi(t,e,i){if(t.insertAdjacentHTML)t.insertAdjacentHTML(e,i);else switch(e){case"beforeend":t.innerHTML+=i;break;case"beforebegin":(vi=vi||document.createElement("svg")).innerHTML=i,t.parentNode.insertBefore(vi.childNodes[0],t)}}var Di=function(){function e(t){h(this,e),this.id=t,this.count=0,this.list=[]}return u(e,[{key:"add",value:function(t){return t.uuid="karas-defs-".concat(this.id,"-").concat(this.count++),this.list.push(t),t.uuid}},{key:"clear",value:function(){this.list=[],this.count=0}},{key:"value",get:function(){return this.list}}],[{key:"getInstance",value:function(t){return new e(t)}}]),e}(),Bi=ne.isNil,Ii=ne.isObject,Hi=ne.isFunction,ji=e.PX;var Gi=0,zi=function(){function n(t,e,i){var r;return h(this,n),(r=_(this,X(n).call(this,t,e,i))).__node=null,r.__mw=0,r.__mh=0,r.__task=[],r.__ref={},wt.mix(o(r)),r}return t(n,yi),u(n,[{key:"__initProps",value:function(){var t=this.props.width;if(!Bi(t)){var e=parseFloat(t)||0;0<e&&(this.__width=e)}var i=this.props.height;if(!Bi(i)){var r=parseFloat(i)||0;0<r&&(this.__height=r)}}},{key:"__genHtml",value:function(){for(var t,e,i,r="<".concat(this.tagName),n=0,a=this.__props.length;n<a;n++){var o=this.__props[n];r+=(t=o[0],e=o[1],i=Array.isArray(e)?ne.joinSourceArray(e):ne.stringify(e),"className"===t&&(t="class")," "+t+'="'+ne.encodeHtml(i,!0)+'"')}return r+="></".concat(this.tagName,">")}},{key:"__cb",value:function(t,e){if(("touchmove"!==t.type||this.__touchstartTarget)&&(!t.touches||!(1<t.touches.length)&&t.touches.length)){var i=this.node.getBoundingClientRect(),r=i.x,n=i.y,a=i.left,o=i.top,s=i.width,h=i.height;r=r||a||0,n=n||o||0;var u=t.touches?t.touches[0]:t;r=u.pageX-r,n=u.pageY-n;var l=s/this.width,c=h/this.height;1!=l&&(r/=l),1!=c&&(n/=c);var f={event:t,stopPropagation:function(){this.__stopPropagation=!0,t.stopPropagation()},stopImmediatePropagation:function(){this.__stopPropagation=!0,this.__stopImmediatePropagation=!0,t.stopImmediatePropagation()},preventDefault:function(){t.preventDefault()},x:r,y:n,__hasEmitted:!1};return this.__emitEvent(f,e),f}}},{key:"appendTo",value:function(t){if(t=function(t){if(ne.isString(t)&&t){var e=document.querySelector(t);if(!e)throw new Error("can not find dom of selector: "+t);return e}if(!t)throw new Error("can not find dom: "+t);return t}(t),this.__initProps(),this.__refreshLevel=Pt.REFLOW,t.nodeName.toUpperCase()===this.tagName.toUpperCase()?(this.__node=t,this.width&&t.setAttribute("width",this.width),this.height&&t.setAttribute("height",this.height)):(this.__node=t.querySelector(this.tagName),this.__node||(t.innerHTML=this.__genHtml(),this.__node=t.querySelector(this.tagName))),this.__uuid=Bi(this.__node.__uuid)?Gi++:this.__node.__uuid,this.__defs=this.node.__defs||Di.getInstance(this.__uuid),!this.width||!this.height){var e=window.getComputedStyle(t,null);this.width||(this.__width=parseFloat(e.getPropertyValue("width"))||0,t.setAttribute("width",this.width)),this.height||(this.__height=parseFloat(e.getPropertyValue("height"))||0,t.setAttribute("height",this.height))}"canvas"===this.tagName?(this.__ctx=this.__node.getContext("2d"),this.__renderMode=oe.CANVAS):"svg"===this.tagName&&(this.__renderMode=oe.SVG);var i=this.style;-1===["flex","block"].indexOf(i.display)&&(i.display="block"),"absolute"===i.position&&(i.position="static");var r,n=this.renderMode,a=this.ctx;this.__traverse(a,this.__defs,n),this.__traverseCss(this,this.props.css),this.__init(),this.refresh(),this.node.__root?(this.node.__root.__destroy(),delete this.node.__root.__node,delete this.node.__root.__vd):(r=this.node,["click","dblclick","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"].forEach(function(e){r.addEventListener(e,function(t){r.__root.__cb(t,-1<["touchend","touchcancel","touchmove"].indexOf(e))})}),this.node.__uuid=this.__uuid),this.node.__root=this}},{key:"refresh",value:function(i){var r=this,n=this.renderMode,t=this.style;t.marginTop=t.marginRight=t.marginBottom=t.marginLeft={value:0,unit:ji},t.width={value:this.width,unit:ji},t.height={value:this.height,unit:ji},this.__defs.clear();var a=this.__refreshLevel;this.__refreshLevel=Pt.REPAINT,a===Pt.REFLOW&&this.__computed(),le.measureText(function(){if(a===Pt.REFLOW?(r.__layout({x:0,y:0,w:r.width,h:r.height}),r.__layoutAbs(r,{x:0,y:0,w:r.width,h:r.height})):r.__repaint(),n===oe.CANVAS&&r.__clear(),r.emit(wt.BEFORE_REFRESH,a),r.render(n),n===oe.SVG){var t=r.virtualDom,e=r.__defs;t.defs=e.value,t=ne.clone(t),r.node.__root?Ei(r.node,r.node.__vd,t):r.node.innerHTML=ne.joinVirtualDom(t),r.node.__vd=t,r.node.__defs=e}Hi(i)&&i(),r.emit(wt.REFRESH)})}},{key:"addRefreshTask",value:function(t){var n=this;if(t){var a,o=this.task;if(!o.length)Gt.nextFrame(this.__rTask={before:function(e){if((a=o.splice(0)).length){a.forEach(function(t){Ii(t)&&Hi(t.before)&&t.before(e)}),n.refresh();var t=n.__hookTask;if(t){var i=Gt.__hookTask,r=i.indexOf(t);-1<r&&i.splice(r,1)}}},after:function(e){a.forEach(function(t){Ii(t)&&Hi(t.after)?t.after(e):Hi(t)&&t(e)})}});-1===o.indexOf(t)&&o.push(t)}}},{key:"delRefreshTask",value:function(t){if(t){for(var e=this.task,i=0,r=e.length;i<r;i++)if(e[i]===t){e.splice(i,1);break}e.length||Gt.offFrame(this.__rTask)}}},{key:"setRefreshLevel",value:function(t){t>this.__refreshLevel&&(this.__refreshLevel=t)}},{key:"__frameHook",value:function(){var t=this,e=this.__hookTask=this.__hookTask||function(){t.refresh()};-1===Gt.__hookTask.indexOf(e)&&Gt.__hookTask.push(e)}},{key:"__clear",value:function(){this.__mw=Math.max(this.__mw,this.width),this.__mh=Math.max(this.__mh,this.height),this.__ctx.setTransform(1,0,0,1,0,0),this.__ctx.clearRect(0,0,this.__mw,this.__mh)}},{key:"node",get:function(){return this.__node}},{key:"renderMode",get:function(){return this.__renderMode}},{key:"task",get:function(){return this.__task}},{key:"ref",get:function(){return this.__ref}},{key:"animateController",get:function(){return this.__animateController}}]),n}(),Xi=function(){function T(t,e){var i;return h(this,T),(i=_(this,X(T).call(this,t,e))).__x1=i.__y1=0,i.__x2=i.__y2=1,i.__controlA=[],i.__controlB=[],void 0!==i.props.x1&&(i.__x1=parseFloat(i.props.x1)||0),void 0!==i.props.y1&&(i.__y1=parseFloat(i.props.y1)||0),void 0!==i.props.x2&&(i.__x2=parseFloat(i.props.x2)||0),void 0!==i.props.y2&&(i.__y2=parseFloat(i.props.y2)||0),Array.isArray(i.props.controlA)&&(i.__controlA=i.props.controlA),Array.isArray(i.props.controlB)&&(i.__controlB=i.props.controlB),i}return t(T,ui),u(T,[{key:"render",value:function(t){var e=Y(X(T.prototype),"render",this).call(this,t),i=e.isDestroyed,r=e.display,n=e.visibility,a=e.originX,o=e.originY,s=e.stroke,h=e.strokeWidth,u=e.strokeDasharray,l=e.strokeDasharrayStr,c=e.strokeLinecap;if(!i&&"none"!==r&&"hidden"!==n){var f=this.width,_=this.height,d=this.ctx,p=this.x1,v=this.y1,y=this.x2,g=this.y2,m=this.controlA,k=this.controlB,b=this.computedStyle;Object.assign(b,{x1:p,y1:v,x2:y,y2:g,controlA:m.join(", "),controlB:k.join(", ")}),p=a+p*f,v=o+v*_,y=a+y*f,g=o+g*_;var x,w,E,S,A=0;if(2===m.length&&(A++,x=a+m[0]*f,w=o+m[1]*_),2===k.length&&(A+=2,E=a+k[0]*f,S=o+k[1]*_),t===oe.CANVAS)d.strokeStyle=s,d.lineWidth=h,d.lineCap=c,d.setLineDash(u),d.beginPath(),d.moveTo(p,v),3===A?d.bezierCurveTo(x,w,E,S,y,g):2===A?d.quadraticCurveTo(E,S,y,g):1===A?d.quadraticCurveTo(x,w,y,g):d.lineTo(y,g),0<h&&d.stroke(),d.closePath();else if(t===oe.SVG){var M=[["d",3===A?"M".concat(p,",").concat(v," C").concat(x,",").concat(w," ").concat(E,",").concat(S," ").concat(y,",").concat(g):2===A?"M".concat(p,",").concat(v," Q").concat(E,",").concat(S," ").concat(y,",").concat(g):1===A?"M".concat(p,",").concat(v," Q").concat(x,",").concat(w," ").concat(y,",").concat(g):"M".concat(p,",").concat(v," L").concat(y,",").concat(g)],["fill","none"],["stroke",s],["stroke-width",h]];u.length&&M.push(["stroke-dasharray",l]),"butt"!==c&&M.push(["stroke-linecap",c]),this.addGeom("path",M)}}}},{key:"x1",get:function(){return this.getProps("x1")}},{key:"y1",get:function(){return this.getProps("y1")}},{key:"x2",get:function(){return this.getProps("x2")}},{key:"y2",get:function(){return this.getProps("y2")}},{key:"controlA",get:function(){return this.getProps("controlA")}},{key:"controlB",get:function(){return this.getProps("controlB")}}]),T}(),Yi=function(){function I(t,e){var i;return h(this,I),(i=_(this,X(I).call(this,t,e))).__points=[],Array.isArray(i.props.points)&&(i.__points=i.props.points),-1<["TOP_RIGHT","BOTTOM_LEFT","BOTTOM_RIGHT"].indexOf(i.props.origin)?i.__origin=i.props.origin:i.__origin="TOP_LEFT",i.__controls=[],Array.isArray(i.props.controls)&&(i.__controls=i.props.controls),i}return t(I,ui),u(I,[{key:"render",value:function(t){var e=Y(X(I.prototype),"render",this).call(this,t),i=e.isDestroyed,n=e.originX,a=e.originY,r=e.display,o=e.visibility,s=e.stroke,h=e.strokeWidth,u=e.strokeDasharray,l=e.strokeDasharrayStr,c=e.strokeLinecap;if(!i&&"none"!==r&&"hidden"!==o){var f=this.width,_=this.height,d=this.ctx,p=this.points,v=this.controls,y=this.origin,g=this.computedStyle;if(g.points=p.join("; "),g.controls=v.join("; "),g.origin=y,!(p.length<2)){for(var m=0,k=p.length;m<k;m++)if(!Array.isArray(p[m])||p[m].length<2)return;var b,x=[],w=[];if("TOP_LEFT"===y?(p.forEach(function(t){x.push([n+t[0]*f,a+t[1]*_])}),v.forEach(function(i){if(!Array.isArray(i)||2!==i.length&&4!==i.length)w.push(null);else{var r=[];i.forEach(function(t,e){0===e||2===e?r.push(n+i[e]*f):r.push(a+i[e]*_)}),w.push(r),b=!0}})):"TOP_RIGHT"===y?(p.forEach(function(t){x.push([n+f-t[0]*f,a+t[1]*_])}),v.forEach(function(i){if(!Array.isArray(i)||2!==i.length&&4!==i.length)w.push(null);else{var r=[];i.forEach(function(t,e){0===e||2===e?r.push(n+f-i[e]*f):r.push(a+i[e]*_)}),w.push(r),b=!0}})):"BOTTOM_LEFT"===y?(p.forEach(function(t){x.push([n+t[0]*f,a+_-t[1]*_])}),v.forEach(function(i){if(!Array.isArray(i)||2!==i.length&&4!==i.length)w.push(null);else{var r=[];i.forEach(function(t,e){0===e||2===e?r.push(n+i[e]*f):r.push(a+_-i[e]*_)}),w.push(r),b=!0}})):"BOTTOM_RIGHT"===y&&(p.forEach(function(t){x.push([n+f-t[0]*f,a+_-t[1]*_])}),v.forEach(function(i){if(!Array.isArray(i)||2!==i.length&&4!==i.length)w.push(null);else{var r=[];i.forEach(function(t,e){0===e||2===e?r.push(n+f-i[e]*f):r.push(a+_-i[e]*_)}),w.push(r),b=!0}})),t===oe.CANVAS){d.strokeStyle=s,d.lineWidth=h,d.lineCap=c,d.setLineDash(u),d.beginPath(),d.moveTo(x[0][0],x[0][1]);for(var E=1,S=x.length;E<S;E++){var A=x[E],M=w[E-1];M&&M.length?4===M.length?d.bezierCurveTo(M[0],M[1],M[2],M[3],A[0],A[1]):d.quadraticCurveTo(M[0],M[1],A[0],A[1]):d.lineTo(A[0],A[1])}0<h&&d.stroke(),d.closePath()}else if(t===oe.SVG){var T,P=[["fill","none"],["stroke",s],["stroke-width",h]];if(b){for(var C="M".concat(x[0][0],",").concat(x[0][1]),O=1,R=x.length;O<R;O++){var L=x[O],W=w[O-1];W&&W.length?4===W.length?C+="C".concat(W[0],",").concat(W[1]," ").concat(W[2],",").concat(W[3]," ").concat(L[0],",").concat(L[1]):C+="Q".concat(W[0],",").concat(W[1]," ").concat(L[0],",").concat(L[1]):C+="L".concat(L[0],",").concat(L[1])}P.push(["d",C]),T="path"}else{for(var N="",F=0,D=x.length;F<D;F++){var B=x[F];F&&(N+=" "),N+="".concat(B[0],",").concat(B[1])}P.push(["points",N]),T="polyline"}u.length&&P.push(["stroke-dasharray",l]),"butt"!==c&&P.push(["stroke-linecap",c]),this.addGeom(T,P)}}}}},{key:"points",get:function(){return this.getProps("points")}},{key:"controls",get:function(){return this.getProps("controls")}},{key:"origin",get:function(){return this.getProps("origin")}}]),I}(),Vi=function(){function j(t,e){var i;return h(this,j),(i=_(this,X(j).call(this,t,e))).__points=[],Array.isArray(i.props.points)&&(i.__points=i.props.points),i.__controls=[],Array.isArray(i.props.controls)&&(i.__controls=i.props.controls),i}return t(j,ui),u(j,[{key:"render",value:function(t){var e=Y(X(j.prototype),"render",this).call(this,t),i=e.isDestroyed,n=e.originX,a=e.originY,r=e.display,o=e.visibility,s=e.fill,h=e.stroke,u=e.strokeWidth,l=e.strokeDasharray,c=e.strokeDasharrayStr,f=e.strokeLinecap;if(!i&&"none"!==r&&"hidden"!==o){var _=this.width,d=this.height,p=this.ctx,v=this.points,y=this.controls,g=this.computedStyle;if(g.points=v.join("; "),g.controls=y.join("; "),v.length<2)console.error("Polygon must have at lease 2 points: "+v[0]);else{for(var m=0,k=v.length;m<k;m++)if(!Array.isArray(v[m])||v[m].length<2)return;var b=[];v.forEach(function(t){b.push([n+t[0]*_,a+t[1]*d])});var x,w=[];if(y.forEach(function(i){if(!Array.isArray(i)||2!==i.length&&4!==i.length)w.push(null);else{var r=[];i.forEach(function(t,e){0===e||2===e?r.push(n+i[e]*_):r.push(a+i[e]*d)}),w.push(r),x=!0}}),t===oe.CANVAS){p.strokeStyle=h,p.lineWidth=u,p.fillStyle=s,p.lineCap=f,p.setLineDash(l),p.beginPath(),p.moveTo(b[0][0],b[0][1]);for(var E=1,S=b.length;E<S;E++){var A=b[E],M=w[E-1];M&&M.length?4===M.length?p.bezierCurveTo(M[0],M[1],M[2],M[3],A[0],A[1]):p.quadraticCurveTo(M[0],M[1],A[0],A[1]):p.lineTo(A[0],A[1])}var T=w[b.length-1];T&&T.length?4===T.length?p.bezierCurveTo(T[0],T[1],T[2],T[3],b[0][0],b[0][1]):p.quadraticCurveTo(T[0],T[1],b[0][0],b[0][1]):p.lineTo(b[0][0],b[0][1]),p.fill(),0<u&&p.stroke(),p.closePath()}else if(t===oe.SVG){var P,C=[];if(x){for(var O="M".concat(b[0][0],",").concat(b[0][1]),R=1,L=b.length;R<L;R++){var W=b[R],N=w[R-1];N&&N.length?4===N.length?O+="C".concat(N[0],",").concat(N[1]," ").concat(N[2],",").concat(N[3]," ").concat(W[0],",").concat(W[1]):O+="Q".concat(N[0],",").concat(N[1]," ").concat(W[0],",").concat(W[1]):O+="L".concat(W[0],",").concat(W[1])}var F=w[b.length-1];F&&F.length?4===F.length?O+="C".concat(F[0],",").concat(F[1]," ").concat(F[2],",").concat(F[3]," ").concat(b[0][0],",").concat(b[0][1]):O+="Q".concat(F[0],",").concat(F[1]," ").concat(b[0][0],",").concat(b[0][1]):O+="L".concat(b[0][0],",").concat(b[0][1]),C.push(["d",O]),P="path"}else{for(var D="",B=0,I=b.length;B<I;B++){var H=b[B];D+="".concat(H[0],",").concat(H[1]," ")}C.push(["points",D]),P="polygon"}C=C.concat([["fill",s],["stroke",h],["stroke-width",u]]),l.length&&C.push(["stroke-dasharray",c]),"butt"!==f&&C.push(["stroke-linecap",f]),this.addGeom(P,C)}}}}},{key:"points",get:function(){return this.getProps("points")}},{key:"controls",get:function(){return this.getProps("controls")}}]),j}(),$i=.5*Math.PI;function qi(t,e,i,r){return 0<=(r%=360)&&r<90?[t+Math.sin(r*Math.PI/180)*i,e-Math.cos(r*Math.PI/180)*i]:90<=r&&r<180?[t+Math.cos((r-90)*Math.PI/180)*i,e+Math.sin((r-90)*Math.PI/180)*i]:180<=r&&r<270?[t-Math.cos((270-r)*Math.PI/180)*i,e+Math.sin((270-r)*Math.PI/180)*i]:[t-Math.sin((360-r)*Math.PI/180)*i,e-Math.cos((360-r)*Math.PI/180)*i]}var Ui=function(){function O(t,e){var i;return h(this,O),(i=_(this,X(O).call(this,t,e))).__begin=0,i.__end=0,i.props.begin&&(i.__begin=parseFloat(i.props.begin),isNaN(i.begin)&&(i.__begin=0)),i.props.end&&(i.__end=parseFloat(i.props.end),isNaN(i.end)&&(i.__end=0)),i.__r=1,i.props.r&&(i.__r=parseFloat(i.props.r),isNaN(i.r)&&(i.__r=1)),i.__edge=!1,void 0!==i.props.edge&&(i.__edge=!!i.props.edge),i.__closure=!1,void 0!==i.props.closure&&(i.__closure=!!i.props.closure),i}return t(O,ui),u(O,[{key:"render",value:function(t){var e=Y(X(O.prototype),"render",this).call(this,t),i=e.isDestroyed,r=e.cx,n=e.cy,a=e.display,o=e.visibility,s=e.fill,h=e.stroke,u=e.strokeWidth,l=e.strokeDasharray,c=e.strokeDasharrayStr,f=e.strokeLinecap;if(!i&&"none"!==a&&"hidden"!==o){var _=this.width,d=this.height,p=this.ctx,v=this.begin,y=this.end,g=this.r,m=this.edge,k=this.closure,b=this.computedStyle;if(Object.assign(b,{begin:v,end:y,r:g,edge:m,closure:k}),v!==y){var x,w,E,S,A=ie(qi(r,n,g*=.5*Math.min(_,d),v),2);x=A[0],w=A[1];var M=ie(qi(r,n,g,y),2);E=M[0],S=M[1];var T=180<y-v?1:0;if(t===oe.CANVAS)p.strokeStyle=h,p.lineWidth=u,p.fillStyle=s,p.lineCap=f,p.setLineDash(l),p.beginPath(),p.arc(r,n,g,v*Math.PI/180-$i,y*Math.PI/180-$i),m?(T&&k||p.lineTo(r,n),p.lineTo(x,w),0<u&&p.stroke()):(0<u&&p.stroke(),T&&k||p.lineTo(r,n),p.lineTo(x,w)),p.fill(),p.closePath();else if(t===oe.SVG)if(m){var P=[["d",k?"M".concat(x," ").concat(w," A").concat(g," ").concat(g," 0 ").concat(T," 1 ").concat(E," ").concat(S," z"):"M".concat(r," ").concat(n," L").concat(x," ").concat(w," A").concat(g," ").concat(g," 0 ").concat(T," 1 ").concat(E," ").concat(S," z")],["fill",s],["stroke",h],["stroke-width",u]];l.length&&P.push(["stroke-dasharray",c]),"butt"!==f&&P.push(["stroke-linecap",f]),this.addGeom("path",P)}else if(this.addGeom("path",[["d",k?"M".concat(x,",").concat(w," A").concat(g," ").concat(g," 0 ").concat(T," 1 ").concat(E,",").concat(S," z"):"M".concat(r,",").concat(n," L").concat(x,",").concat(w," A").concat(g," ").concat(g," 0 ").concat(T," 1 ").concat(E,",").concat(S," z")],["fill",s]]),0<u){var C=[["d","M".concat(x,",").concat(w," A").concat(g,",").concat(g," 0 ").concat(T," 1 ").concat(E,",").concat(S)],["fill","rgba(0,0,0,0)"],["stroke",h],["stroke-width",u]];l.length&&C.push(["stroke-dasharray",c]),"butt"!==f&&C.push(["stroke-linecap",f]),this.addGeom("path",C)}}}}},{key:"begin",get:function(){return this.getProps("begin")}},{key:"end",get:function(){return this.getProps("end")}},{key:"r",get:function(){return this.getProps("r")}},{key:"edge",get:function(){return this.getProps("edge")}},{key:"closure",get:function(){return this.getProps("closure")}}]),O}(),Zi=function(){function x(t,e){var i;return h(this,x),(i=_(this,X(x).call(this,t,e))).__rx=0,i.props.rx&&(i.__rx=parseFloat(i.props.rx),isNaN(i.rx)&&(i.__rx=0)),i.__ry=0,i.props.ry&&(i.__ry=parseFloat(i.props.ry),isNaN(i.ry)&&(i.__ry=0)),i}return t(x,ui),u(x,[{key:"render",value:function(t){var e=Y(X(x.prototype),"render",this).call(this,t),i=e.isDestroyed,r=e.originX,n=e.originY,a=e.display,o=e.visibility,s=e.fill,h=e.stroke,u=e.strokeWidth,l=e.strokeDasharray,c=e.strokeDasharrayStr,f=e.strokeLinecap;if(!i&&"none"!==a&&"hidden"!==o){var _=this.width,d=this.height,p=this.ctx,v=this.rx,y=this.ry,g=this.computedStyle;if(g.rx=v,g.ry=y,v=Math.min(v,.5),y=Math.min(y,.5),v*=_,y*=d,t===oe.CANVAS){if(p.strokeStyle=h,p.lineWidth=u,p.fillStyle=s,p.lineCap=f,p.setLineDash(l),p.beginPath(),0===v&&0===y)p.moveTo(r,n),p.lineTo(r+_,n),p.lineTo(r+_,n+d),p.lineTo(r,n+d),p.lineTo(r,n);else{var m=v*w.H,k=y*w.H;p.moveTo(r+v,n),p.lineTo(r+_-v,n),p.bezierCurveTo(r+_+m-v,n,r+_,n+y-k,r+_,n+y),p.lineTo(r+_,n+d-y),p.bezierCurveTo(r+_,n+d+k-y,r+_+m-v,n+d,r+_-v,n+d),p.lineTo(r+v,n+d),p.bezierCurveTo(r+v-m,n+d,r,n+d+k-y,r,n+d-y),p.lineTo(r,n+y),p.bezierCurveTo(r,n+y-k,r+v-m,n,r+v,n)}p.fill(),0<u&&p.stroke(),p.closePath()}else if(t===oe.SVG){var b=[["x",r],["y",n],["width",_],["height",d],["fill",s],["stroke",h],["stroke-width",u]];v&&b.push(["rx",v]),y&&b.push(["ry",y]),l.length&&b.push(["stroke-dasharray",c]),"butt"!==f&&b.push(["stroke-linecap",f]),this.addGeom("rect",b)}}}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}}]),x}(),Qi=function(){function g(t,e){var i;return h(this,g),(i=_(this,X(g).call(this,t,e))).__r=1,i.props.r&&(i.__r=parseFloat(i.props.r),isNaN(i.r)&&(i.__r=1)),i}return t(g,ui),u(g,[{key:"render",value:function(t){var e=Y(X(g.prototype),"render",this).call(this,t),i=e.isDestroyed,r=e.cx,n=e.cy,a=e.display,o=e.visibility,s=e.fill,h=e.stroke,u=e.strokeWidth,l=e.strokeDasharray,c=e.strokeDasharrayStr,f=e.strokeLinecap;if(!i&&"none"!==a&&"hidden"!==o){var _=this.width,d=this.height,p=this.ctx,v=this.r;if(this.computedStyle.r=v,v*=.5*Math.min(_,d),t===oe.CANVAS)p.strokeStyle=h,p.lineWidth=u,p.fillStyle=s,p.lineCap=f,p.setLineDash(l),p.beginPath(),p.arc(r,n,v,0,2*Math.PI),p.fill(),0<u&&p.stroke(),p.closePath();else if(t===oe.SVG){var y=[["cx",r],["cy",n],["r",v],["fill",s],["stroke",h],["stroke-width",u]];l.length&&y.push(["stroke-dasharray",c]),"butt"!==f&&y.push(["stroke-linecap",f]),this.addGeom("circle",y)}}}},{key:"r",get:function(){return this.getProps("r")}}]),g}(),Ji=function(){function x(t,e){var i;return h(this,x),(i=_(this,X(x).call(this,t,e))).__rx=1,i.props.rx&&(i.__rx=parseFloat(i.props.rx),isNaN(i.rx)&&(i.__rx=1)),i.__ry=1,i.props.ry&&(i.__ry=parseFloat(i.props.ry),isNaN(i.ry)&&(i.__ry=1)),i}return t(x,ui),u(x,[{key:"render",value:function(t){var e=Y(X(x.prototype),"render",this).call(this,t),i=e.isDestroyed,r=e.cx,n=e.cy,a=e.display,o=e.visibility,s=e.fill,h=e.stroke,u=e.strokeWidth,l=e.strokeDasharray,c=e.strokeDasharrayStr,f=e.strokeLinecap;if(!i&&"none"!==a&&"hidden"!==o){var _=this.width,d=this.height,p=this.ctx,v=this.rx,y=this.ry,g=this.computedStyle;if(g.rx=v,g.ry=y,v*=.5*_,y*=.5*d,t===oe.CANVAS){if(p.strokeStyle=h,p.lineWidth=u,p.fillStyle=s,p.lineCap=f,p.setLineDash(l),p.beginPath(),p.ellipse)p.ellipse(r,n,v,y,0,0,2*Math.PI);else{var m=v*w.H,k=y*w.H;p.moveTo(r-v,n),p.bezierCurveTo(r-v,n-k,r-m,n-y,r,n-y),p.bezierCurveTo(r+m,n-y,r+v,n-k,r+v,n),p.bezierCurveTo(r+v,n+k,r+m,n+y,r,n+y),p.bezierCurveTo(r-m,n+y,r-v,n+k,r-v,n)}p.fill(),0<u&&p.stroke(),p.closePath()}else if(t===oe.SVG){var b=[["cx",r],["cy",n],["rx",v],["ry",y],["fill",s],["stroke",h],["stroke-width",u]];l.length&&b.push(["stroke-dasharray",c]),"butt"!==f&&b.push(["stroke-linecap",f]),this.addGeom("ellipse",b)}}}},{key:"rx",get:function(){return this.getProps("rx")}},{key:"ry",get:function(){return this.getProps("ry")}}]),x}(),Ki={skewX:"kx",skewY:"ky",transform:"tf",fontSize:"fz",offset:"os",easing:"e"},tr={os:"offset",e:"easing"},er={value:"v",options:"o"},ir={},rr={duration:"dt",delay:"d",endDelay:"ed",iterations:"i",direction:"dc",fill:"f",fps:"fp",playbackRate:"p"},nr={};Tt.dom.concat(Tt.geom).forEach(function(t){var e=t.k;if(Ki.hasOwnProperty(e))tr[Ki[e]]=e;else{var i=e.charAt(0)+e.replace(/[a-z]/g,"").toLowerCase();Ki[e]=i,tr[i]=e}}),Object.keys(er).forEach(function(t){ir[er[t]]=t}),Object.keys(rr).forEach(function(t){nr[rr[t]]=t});var ar={fullCssProperty:Ki,abbrCssProperty:tr,fullAnimate:er,abbrAnimate:ir,fullAnimateOption:rr,abbrAnimateOption:nr},or=ne.isNil,sr=ne.isBoolean,hr=ne.isFunction,ur=ne.isString,lr=ne.isNumber,cr=ne.clone,fr=ar.abbrCssProperty,_r=ar.abbrAnimateOption,dr=ar.abbrAnimate;function pr(t){return or(t)||sr(t)||ur(t)||lr(t)}function vr(n,a){n&&Object.keys(n).forEach(function(t){if(0===t.indexOf("var-")){var e=t.slice(4);if(a.hasOwnProperty(e)){var i=a[e];n["var-"+i]=n[t],delete n[t]}}else if(a.hasOwnProperty(t)){var r=a[t];n[r]=n[t],delete n[t]}})}function yr(s,h){s&&h&&Object.keys(s).forEach(function(t){if(0===t.indexOf("var-")){var e=s[t],i=t.slice(4);if(e.id&&h.hasOwnProperty(e.id)){var r=h[e.id];if(or(e))return;if(-1<i.indexOf(".")){for(var n=i.split("."),a=n.length,o=0;o<a-1;o++)i=n[o],s[i]?s=s[i]:console.error("parseJson vars is not exist: "+e.id+", "+t+", "+n.slice(0,o).join("."));i=n[a-1]}hr(r)&&(r=r(e)),s[i]=r}}})}function gr(e,i){e.tagName=e.tagName||i.tagName,e.props=cr(i.props),e.children=i.children,Object.keys(i).forEach(function(t){0!==t.indexOf("var-")||e.hasOwnProperty(t)||(e[t]=i[t])}),mr(e)}function mr(t){var e=t.init;if(e){var i=t.props=t.props||{},r=i.style;Object.assign(i,e),r&&(Object.assign(r,e.style),i.style=r)}}function kr(t,e,i,r){var n=e.library,a=e.children;if(Array.isArray(n)){var o={};n.forEach(function(t){!function r(t,n){var e=t.id,i=t.children;Array.isArray(i)&&i.forEach(function(t){if(!pr(t)){var e=t.libraryId;if(!e)return;n.hasOwnProperty(e)||r(t,n);var i=n[e];if(!i)throw new Error("Library item miss ID: "+e);gr(t,i)}}),n[e]=t}(t,o)}),Array.isArray(a)&&a.forEach(function(t){if(!pr(t)){var e=t.libraryId;if(!e)return;var i=o[e];if(!i)throw new Error("Library miss ID: "+e);gr(t,i)}})}return mr(e),function e(i,t,r,n){if(pr(t))return t;var a,o,s=t.tagName,h=t.props,u=void 0===h?{}:h,l=t.children,c=void 0===l?[]:l,f=t.animate,_=u.style;if(vr(_,fr),yr(_,n),yr(u,n),yr(t,n),a="$"===s.charAt(0)?i.createGm(s,u):i.createVd(s,u,c.map(function(t){return e(i,t,r,n)})),f)if(Array.isArray(f)){var d;f.forEach(function(t){vr(t,dr);var e=t.value,i=t.options;Array.isArray(e)&&e.length&&(d=!0,e.forEach(function(t){vr(t,fr),yr(t,n)})),i&&(vr(i,_r),yr(i,n))}),d&&(o={animate:f,target:a})}else{vr(f,dr);var p=f.value,v=f.options;Array.isArray(p)&&p.length&&(p.forEach(function(t){vr(t,fr),yr(t,n)}),o={animate:f,target:a}),v&&(vr(v,_r),yr(v,n))}return o&&r.push(o),a}(t,e,i,r.vars)}var br=ne.isNil;function xr(t,e,i,r){br(e)||t["var-"+i]&&!br(r[i])||(t[i]=e)}var wr=function(){function e(t){h(this,e),this.__records=t,this.__list=[]}return u(e,[{key:"__op",value:function(t){var i=t.playbackRate,r=t.iterations,n=t.vars;br(i)&&br(r)||(this.__playbackRate=i,this.__iterations=r,this.records.forEach(function(t){t.animate.forEach(function(t){var e=t.options;xr(e,i,"playbackRate",n),xr(e,r,"iterations",n)})}))}},{key:"add",value:function(t){-1===this.__list.indexOf(t)&&this.list.push(t)}},{key:"remove",value:function(t){var e=this.list.indexOf(t);-1<e&&this.list.splice(e,1)}},{key:"__destroy",value:function(){this.__records=[],this.__list=[]}},{key:"__action",value:function(e,i){this.list.forEach(function(t){t.target.animationList.forEach(function(t){t[e].apply(t,i)})})}},{key:"play",value:function(){this.__action("play");var t=this.records;t.length&&t.splice(0).forEach(function(t){var e=t.target,i=t.animate;Array.isArray(i)?i.forEach(function(t){e.animate(t.value,t.options,!0)}):e.animate(i.value,i.options,!0)})}},{key:"pause",value:function(){this.__action("pause")}},{key:"cancel",value:function(){this.__action("cancel")}},{key:"finish",value:function(){this.__action("finish")}},{key:"gotoAndStop",value:function(t,e,i){var r=!0;this.__action("gotoAndStop",[t,e,function(t){r&&(r=!1,i(t))}])}},{key:"gotoAndPlay",value:function(t,e,i){var r=!0;this.__action("gotoAndPlay",[t,e,function(t){r&&(r=!1,i(t))}])}},{key:"records",get:function(){return this.__records}},{key:"list",get:function(){return this.__list}},{key:"playbackRate",get:function(){return this.__playbackRate},set:function(e){(e=parseFloat(e)||0)<0&&(e=1),this.__playbackRate=e,this.list.forEach(function(t){t.playbackRate=e})}},{key:"iterations",get:function(){return this.__iterations},set:function(e){e=parseInt(e),isNaN(e)&&(e=1),this.__iterations=e,this.list.forEach(function(t){t.iterations=e})}}]),e}();ui.register("$line",Xi),ui.register("$polyline",Yi),ui.register("$polygon",Vi),ui.register("$sector",Ui),ui.register("$rect",Zi),ui.register("$circle",Qi),ui.register("$ellipse",Ji);var Er={render:function(t,e){if(!(t instanceof zi))throw new Error('Render root must be "canvas" or "svg"');return e&&t.appendTo(e),t},createVd:function(t,e,i){if(-1<["canvas","svg"].indexOf(t))return new zi(t,e,i);if(yi.isValid(t))return"img"===t?new bi(t,e):new yi(t,e,i);throw new Error("Can not use marker: "+t)},createGm:function(t,e){return new(ui.getRegister(t))(t,e)},createCp:function(t,e,i){return new t(e,i)},parse:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:{};e&&(ne.isString(e)||window.HTMLElement&&e instanceof window.HTMLElement||(r=e,e=null));var n=[],a=kr(this,t,n,r);if(e){var o=a.__animateController=new wr(n);this.render(a,e),o.__op(r),!1!==r.autoPlay&&o.play()}else n.length&&(a.__animateRecords=n);return a},Root:zi,Dom:yi,Img:bi,Geom:ui,mode:oe,Component:Rt,Event:wt,sort:pt,util:ne,inject:le,css:Z,unit:e,reset:Tt,abbr:ar,frame:Gt,easing:ce,level:Pt,math:rt};return"undefined"!=typeof window&&(window.karas=Er),Er});
//# sourceMappingURL=index.min.js.map
