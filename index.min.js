!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).karas=e()}(this,function(){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function e(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function n(n){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?e(a,!0).forEach(function(t){var e,i,r;e=n,r=a[i=t],i in e?Object.defineProperty(e,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[i]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):e(a).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(a,t))})}return n}function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}function V(t){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function U(t,e,i){return(U="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=V(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function F(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var i=[],r=!0,n=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);r=!0);}catch(t){n=!0,a=t}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ye(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var h,l=function(){function t(){o(this,t),this.__x=0,this.__y=0,this.__ox=0,this.__oy=0,this.__width=0,this.__height=0,this.__prev=null,this.__next=null,this.__ctx=null,this.__defs=null,this.__parent=null,this.__style={},this.__baseLine=0,this.__virtualDom={}}return a(t,[{key:"__offsetX",value:function(t){this.__ox+=t}},{key:"__offsetY",value:function(t){this.__oy+=t}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"ox",get:function(){return this.__ox}},{key:"oy",get:function(){return this.__oy}},{key:"rx",get:function(){return this.x+this.ox}},{key:"ry",get:function(){return this.y+this.oy}},{key:"width",get:function(){return this.__width}},{key:"height",get:function(){return this.__height}},{key:"outerWidth",get:function(){return this.__width}},{key:"outerHeight",get:function(){return this.__height}},{key:"prev",get:function(){return this.__prev}},{key:"next",get:function(){return this.__next}},{key:"parent",get:function(){return this.__parent}},{key:"root",get:function(){return this.parent?this.parent.root:this}},{key:"style",get:function(){return this.__style}},{key:"ctx",get:function(){return this.__ctx}},{key:"defs",get:function(){return this.__defs}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"virtualDom",get:function(){return this.__virtualDom}}]),t}(),me={CANVAS:0,SVG:1,measure:function(t,e){h||((h=document.createElement("div")).style.position="absolute",h.style.left="99999px",h.style.top="-99999px",h.style.visibility="hidden",document.body.appendChild(h)),h.style.fontSize=e.fontSize+"px",h.innerText=t;var i=window.getComputedStyle(h,null);return parseFloat(i.width)}},we={AUTO:0,PX:1,PERCENT:2,POSITION:3},u={}.toString;function f(e){return function(t){return u.call(t)==="[object "+e+"]"}}var c=f("Number");function d(t){return v(t)?"":t.toString()}function v(t){return null==t}function _(t){if("item"===t.type){var e="";return t.props.forEach(function(t){e+=" ".concat(t[0],'="').concat(t[1],'"')}),"text"===t.tagName?"<text".concat(e,">").concat(t.content,"</text>"):"<".concat(t.tagName).concat(e,"/>")}if("text"===t.type){var i="";return t.children.forEach(function(t){i+=_(t)}),"<g>".concat(i,"</g>")}if("dom"===t.type||"geom"===t.type){var r="<g>";return t.bb.forEach(function(t){r+=_(t)}),r+="</g><g>",t.children.forEach(function(t){r+=_(t)}),r+="</g>",'<g transform="'.concat(p(t.transform),'">').concat(r,"</g>")}}function p(t){var e="";return t.forEach(function(t){e+="".concat(t[0],"(").concat(t[1],") ")}),e}function g(t){var e="<".concat(t.tagName,' id="').concat(t.uuid,'" gradientUnits="userSpaceOnUse"');return t.props.forEach(function(t){e+=" ".concat(t[0],'="').concat(t[1],'"')}),e+=">",t.stop.forEach(function(t){e+='<stop stop-color="'.concat(t[0],'" offset="').concat(100*t[1],'%"/>')}),e+="</".concat(t.tagName,">")}var I={isObject:f("Object"),isString:f("String"),isFunction:f("Function"),isNumber:c,isBoolean:f("Boolean"),isDate:f("Date"),stringify:d,joinSourceArray:function(t){return function t(e){for(var i="",r=0,n=e.length;r<n;r++){var a=e[r];Array.isArray(a)?i+=t(a):i+=d(a)}return i}(t)},encodeHtml:function(t,e){return e?t.replace(/"/g,"&quot;"):t.replace(/&/g,"&amp;").replace(/</g,"&lt;")},isNil:v,joinVirtualDom:function(t,e){var i="<defs>";return e.forEach(function(t){i+=g(t)}),i+="</defs><g>",t.bb.forEach(function(t){i+=_(t)}),i+="</g><g>",t.children.forEach(function(t){i+=_(t)}),i+="</g>"},joinVd:_,joinTransform:p,joinDef:g,r2d:function(t){return t*Math.PI/180},rgb2int:function(t){var e=[];if("#"===t.charAt(0))3===(t=t.slice(1)).length?(e.push(parseInt(t.charAt(0)+t.charAt(0),16)),e.push(parseInt(t.charAt(1)+t.charAt(1),16)),e.push(parseInt(t.charAt(2)+t.charAt(2),16))):6===t.length&&(e.push(parseInt(t.slice(0,2),16)),e.push(parseInt(t.slice(2,4),16)),e.push(parseInt(t.slice(4),16)));else{var i=t.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\s*\)/i);i&&(e=[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],i[4]&&(e[3]=parseFloat(i[4])))}return e},arr2hash:function(t){for(var e={},i=0,r=t.length;i<r;i++){var n=t[i];if(Array.isArray(n))e[n[0]]=n[1];else for(var a=Object.keys(n),s=a.length-1;0<=s;s--){var o=a[s];e[o]=n[o]}}return e},hash2arr:function(t){if(Array.isArray(t))return t;for(var e=[],i=Object.keys(t),r=0,n=i.length;r<n;r++){var a=i[r];e.push([a,t[a]])}return e}};function y(){for(var t=[],e=0;e<16;e++)t.push(e%5==0?1:0);return t}function m(t,e){for(var i=[],r=0;r<4;r++)for(var n=[t[r],t[r+4],t[r+8],t[r+12]],a=0;a<4;a++){var s=4*a,o=[e[s],e[1+s],e[2+s],e[3+s]],h=n[0]*o[0]+n[1]*o[1]+n[2]*o[2]+n[3]*o[3];i[r+s]=h}return i}function w(t,e,i){var r=F(t,6),n=r[0],a=r[1],s=r[2],o=r[3];return[n*e+s*i+r[4],a*e+o*i+r[5]]}function x(t,e,i,r){return t*r-i*e}var xe={calMatrix:function(t,e,i){var l=y();l[12]=e,l[13]=i,t.forEach(function(t){var e=F(t,2),i=e[0],r=e[1],n=y();if("translateX"===i)n[12]=r;else if("translateY"===i)n[13]=r;else if("scaleX"===i)n[0]=r;else if("scaleY"===i)n[5]=r;else if("skewX"===i){r=I.r2d(r);var a=Math.tan(r);n[4]=a}else if("skewY"===i){r=I.r2d(r);var s=Math.tan(r);n[1]=s}else if("rotateZ"===i){r=I.r2d(r);var o=Math.sin(r),h=Math.cos(r);n[0]=n[5]=h,n[1]=o,n[4]=-o}l=m(l,n)});var r=y();return r[12]=-e,r[13]=-i,[(l=m(l,r))[0],l[1],l[4],l[5],l[12],l[13]]},pointInQuadrilateral:function(t,e,i,r,n,a,s,o,h,l,u){if(!u)return i<=t&&r<=e&&t<=h&&e<=l;var f=F(w(u,i,r),2);i=f[0],r=f[1];var c=F(w(u,n,a),2);n=c[0],a=c[1];var d=F(w(u,s,o),2);s=d[0],o=d[1];var v=F(w(u,h,l),2);return h=v[0],l=v[1],0<x(n-i,a-r,t-i,e-r)&&0<x(h-n,l-a,t-n,e-a)&&0<x(s-h,o-l,t-h,e-l)&&0<x(i-s,r-o,t-s,e-o)||void 0},normalize:function(t,e,i,n,a){var s=[];return t.forEach(function(t){var e=F(t,2),i=e[0],r=e[1];"translateX"===i?r.unit===we.PERCENT?s.push([t[0],r.value*n*.01]):s.push([t[0],t[1].value]):"translateY"===i?r.unit===we.PERCENT?s.push([t[0],r.value*a*.01]):s.push([t[0],t[1].value]):s.push([t[0],t[1]])}),s},getOrigin:function(t,i,r,n,a){var s=[];return t.forEach(function(t,e){t.unit===we.PX?s.push(t.value):t.unit===we.PERCENT?s.push((e?r:i)+t.value*(e?a:n)*.01):"left"===t.value?s.push(i):"right"===t.value?s.push(i+n):"top"===t.value?s.push(r):"bottom"===t.value?s.push(r+a):s.push(e?r+.5*a:i+.5*n)}),s},mergeMatrix:function(t,e){var i=y();i[0]=t[0],i[1]=t[1],i[4]=t[2],i[5]=t[3],i[12]=t[4],i[13]=t[5];var r=y();r[0]=e[0],r[1]=e[1],r[4]=e[2],r[5]=e[3],r[12]=e[4],r[13]=e[5];var n=m(i,r);return[n[0],n[1],n[4],n[5],n[12],n[13]]}};function b(t,e){for(var i=[],r=1,n=t.length;r<n;r++){var a=t[r].trim().split(/\s+/);if(1<a.length){var s=a[0],o=a[1];/%$/.test(o)?i.push([s,.01*parseFloat(o)]):i.push([s,parseFloat(o)/e])}else i.push(a[0])}1<i.length?(Array.isArray(i[0])||(i[0]=[i[0],0]),Array.isArray(i[i.length-1])||(i[i.length-1]=[i[i.length-1],1])):Array.isArray(i[0])||(i[0]=[i[0],0]);for(var h=i[0][1],l=1,u=i.length;l<u-1;l++){var f=i[l];if(Array.isArray(f))h=f[1];else{for(var c=l+1,d=i[i.length-1][1];c<u-1;c++){var v=i[c];if(Array.isArray(v)){d=v[1];break}}for(var _=(d-h)/(c-l+1),p=l;p<c;p++){var g=i[p];i[p]=[g,h+_*(p+1-l)]}l=c}}for(var y=1,m=i.length;y<m;y++){var w=i[y],x=i[y-1];w[1]<x[1]&&(w[1]=x[1])}for(var b=0,k=i.length;b<k-1;b++){if(1<i[b][1]){i.splice(b+1);break}}for(var A=i.length-1;0<A;A--){if(i[A][1]<0){i.splice(0,A);break}}var M=i.length;if(1===M)i[0][1]=0;else{for(var O=!0,T=!0,S=M-1;0<=S;S--){var L=i[S][1];0<L&&(O=!1),L<1&&(T=!1)}if(O)i.splice(0,M-1),i[0][1]=0;else if(T)i.splice(1),i[0][1]=0;else{var P=i[0],W=i[M-1];if(2===M)P[1]<0&&1<W[1]&&function(t,e,i){var r=I.rgb2int(t[0]),n=I.rgb2int(e[0]),a=F(r,4),s=a[0],o=a[1],h=a[2],l=a[3],u=void 0===l?1:l,f=F(n,4),c=f[0],d=f[1],v=f[2],_=f[3],p=void 0===_?1:_,g=Math.abs(t[1])*i,y=e[1]*i,m=g/(g+y),w=Math.floor(s+(c-s)*m),x=Math.floor(o+(d-o)*m),b=Math.floor(h+(v-h)*m),k=u+(p-u)*m;t[0]="rgba(".concat(w,",").concat(x,",").concat(b,",").concat(k,")"),t[1]=0,m=(i+g)/(g+y),w=Math.floor(s+(c-s)*m),x=Math.floor(o+(d-o)*m),b=Math.floor(h+(v-h)*m),k=u+(p-u)*m,e[0]="rgba(".concat(w,",").concat(x,",").concat(b,",").concat(k,")"),e[1]=1}(P,W,e);else{if(P[1]<0){var C=i[1],E=I.rgb2int(P[0]),N=I.rgb2int(C[0]),R=function(t,e,i,r,n){var a=F(t,4),s=a[0],o=a[1],h=a[2],l=a[3],u=void 0===l?1:l,f=F(i,4),c=f[0],d=f[1],v=f[2],_=f[3],p=void 0===_?1:_,g=Math.abs(e)*n,y=g/(r*n+g),m=Math.floor(s+(c-s)*y),w=Math.floor(o+(d-o)*y),x=Math.floor(h+(v-h)*y);return[m,w,x,u+(p-u)*y]}(E,P[1],N,C[1],e);P[0]="rgba(".concat(R[0],",").concat(R[1],",").concat(R[2],",").concat(R[3],")"),P[1]=0}if(1<W[1]){var G=i[M-2],X=I.rgb2int(G[0]),B=I.rgb2int(W[0]),D=function(t,e,i,r,n){var a=F(t,4),s=a[0],o=a[1],h=a[2],l=a[3],u=void 0===l?1:l,f=F(i,4),c=f[0],d=f[1],v=f[2],_=f[3],p=void 0===_?1:_,g=e*n,y=(n-g)/(r*n-g),m=Math.floor(s+(c-s)*y),w=Math.floor(o+(d-o)*y),x=Math.floor(h+(v-h)*y);return[m,w,x,u+(p-u)*y]}(X,G[1],B,W[1],e);W[0]="rgba(".concat(D[0],",").concat(D[1],",").concat(D[2],",").concat(D[3],")"),W[1]=1}}}}return i.forEach(function(t){t[1]<0?t[1]=0:1<t[1]&&(t[1]=1)}),i}var be={parseGradient:function(t){var e=/\b(\w+)-gradient\((.+)\)/.exec(t);if(e)return{k:e[1],v:e[2].split(/\s*,\s*/)}},getLinear:function(t,e,i,r,n){var a=function(t){var e=180;if("to top"===t[0])e=0;else if("to top right"===t[0])e=45;else if("to right"===t[0])e=90;else if("to bottom right"===t[0])e=135;else if("to bottom"===t[0]);else if("to bottom left"===t[0])e=225;else if("to left"===t[0])e=270;else if("to top left"===t[0])e=315;else{var i=/([\d.]+)deg/.exec(t[0]);i?e=parseFloat(i[1]):t.unshift(null)}return e%360}(t),s=I.r2d(a),o=Math.abs(r*Math.sin(s))+Math.abs(n*Math.cos(s)),h=F(function(t,e,i,r){var n,a,s,o;if(270<=t){var h=I.r2d(360-t);n=i+Math.sin(h)*e,a=r+Math.cos(h)*e,s=i-Math.sin(h)*e,o=r-Math.cos(h)*e}else if(180<=t){var l=I.r2d(t-180);n=i+Math.sin(l)*e,a=r-Math.cos(l)*e,s=i-Math.sin(l)*e,o=r+Math.cos(l)*e}else if(90<=t){var u=I.r2d(180-t);n=i-Math.sin(u)*e,a=r-Math.cos(u)*e,s=i+Math.sin(u)*e,o=r+Math.cos(u)*e}else{var f=I.r2d(t);n=i-Math.sin(f)*e,a=r+Math.cos(f)*e,s=i+Math.sin(f)*e,o=r-Math.cos(f)*e}return[n,a,s,o]}(a,.5*o,e,i),4);return{x1:h[0],y1:h[1],x2:h[2],y2:h[3],stop:b(t,o)}},getRadial:function(t,e,i,r,n,a,s){var o=a-r,h=s-n,l=F(function(t,e,i,r,n,a,s,o,h){var l,u,f,c="farthest-corner";if(/circle|ellipse|at|closest|farthest/i.test(t[0])||!/#[0-9a-f]{3,6}/i.test(t[0])&&!/\brgba?\(.*\)/i.test(t[0])){var d,v,_=t[0].indexOf("at");if(-1<_&&(d=t[0].slice(_+2),v=t[0].slice(0,_-1)),(v=/(closest|farthest)-(side|corner)/.exec(v))?c=v[0]:(v=/\s+(-?[\d.]+(?:px|%))\s*(-?[\d.]+(?:px|%))?/.exec(v))&&(c=null,l=-1<v[1].indexOf("px")?.5*parseFloat(v[1]):parseFloat(v[1])*e*.005),d&&(v=/\s+(-?[\d.]+(?:px|%))\s*(-?[\d.]+(?:px|%))?/.exec(d))){r=-1<v[1].indexOf("px")?a+parseFloat(v[1]):a+parseFloat(v[1])*e*.01;var p=v[2]||v[1];n=-1<p.indexOf("px")?s+parseFloat(p):s+parseFloat(p)*i*.01}}else t.unshift(null);if(c)if("closest-side"===c)l=r<=a||o<=r||n<=s||h<=n?0:(u=r<a+.5*e?r-a:o-r,f=n<s+.5*i?n-s:h-n,Math.min(u,f));else if("closest-corner"===c){var g,y;g=r<a+.5*e?r-a:o-r,y=n<s+.5*i?n-s:h-n,l=Math.sqrt(Math.pow(g,2)+Math.pow(y,2))}else if("farthest-side"===c)if(r<=a)l=a-r+e;else if(o<=r)l=r-o+e;else if(n<=s)l=s-n+i;else if(h<=r)l=n-h+i;else{var m=Math.max(o-r,r-a),w=Math.max(h-n,n-s);l=Math.max(m,w)}else{var x,b;x=r<a+.5*e?o-r:r-a,b=n<s+.5*i?h-n:n-s,l=Math.sqrt(Math.pow(x,2)+Math.pow(b,2))}return[l,r,n]}(t,o,h,e,i,r,n,a,s),3),u=l[0],f=l[1],c=l[2],d=b(t,2*u);if(u<=0){var v=d[d.length-1];v[1]=0,d=[v],f=r,c=n,u=o+h}return{cx:f,cy:c,r:u,stop:d}},createCanvasLg:function(t,e){var i=t.createLinearGradient(e.x1,e.y1,e.x2,e.y2);return e.stop.forEach(function(t){i.addColorStop(t[1],t[0])}),i},createSvgLg:function(t,e){return t.add({tagName:"linearGradient",props:[["x1",e.x1],["y1",e.y1],["x2",e.x2],["y2",e.y2]],stop:e.stop})},createCanvasRg:function(t,e){var i=t.createRadialGradient(e.cx,e.cy,0,e.cx,e.cy,e.r);return e.stop.forEach(function(t){i.addColorStop(t[1],t[0])}),i},createSvgRg:function(t,e){return t.add({tagName:"radialGradient",props:[["cx",e.cx],["cy",e.cy],["r",e.r]],stop:e.stop})}};function k(t,e,i,r,n,a,s,o){var h=1,l=1,u=1;t:for(var f=a;n<=f;f--)for(var c=o;s<=c;c--){var d=f+c,v=Math.floor((t+c)/d),_=c;if(v*d<c+t)if(o<(_=(t-v*f)/(v-1)))continue;if(d=f+_,1<e&&f<e){if(f<e%d)continue;if(1<i)if(f<(e+r)%d)continue}if(1<i)if(f<(e+r)%d)continue;0<v&&(h=v,l=f,u=_);break t}return{n:h,ps:l,pd:u}}var ke={calDashed:function(t,e,i,r,n,a){var s=n-e,o=r-i,h=i-e,l=n-r;if("dotted"===t)return k(s,h,l,o,a,a,Math.max(1,.25*a),2*a);var u=k(s,h,l,o,a,3*a,Math.max(1,.25*a),2*a),f=u.n,c=u.ps,d=u.pd;return 1===f?k(s,h,l,o,a,a,Math.max(1,.25*a),2*a):{n:f,ps:c,pd:d}}};function Ae(t,e,r,n,i){if(t===me.CANVAS)e.forEach(function(t){n.beginPath(),n.fillStyle=r,n.moveTo(t[0],t[1]);for(var e=2,i=t.length;e<i;e+=2)n.lineTo(t[e],t[e+1]);n.fill(),n.closePath()});else if(t===me.SVG){var a="";e.forEach(function(t){a+="M ".concat(t[0]," ").concat(t[1]);for(var e=2,i=t.length;e<i;e+=2)a+="L ".concat(t[e]," ").concat(t[e+1]," ")}),i.addBorder([["d",a],["fill",r]])}}var j=function(){function y(t,e){var i;return o(this,y),i=s(this,V(y).call(this)),e=e||[],Array.isArray(e)?(i.props=I.arr2hash(e),i.__props=e):(i.props=e,i.__props=I.hash2arr(e)),i.__tagName=t,i.__style=i.props.style||{},i.__listener={},i.__props.forEach(function(t){var e=t[0];/^on[a-zA-Z]/.test(e)&&(i.__listener[e.slice(2).toLowerCase()]=t[1])}),i.__mtw=0,i.__mrw=0,i.__mbw=0,i.__mlw=0,i.__ptw=0,i.__prw=0,i.__pbw=0,i.__plw=0,i.__matrix=null,i.__matrixSelf=null,i.__tfo=null,i}return t(y,l),a(y,[{key:"__layout",value:function(t){var e=t.w,i=this.style,r=i.display,n=i.width,a=i.marginTop,s=i.marginRight,o=i.marginBottom,h=i.marginLeft,l=i.paddingTop,u=i.paddingRight,f=i.paddingBottom,c=i.paddingLeft;if("none"!==r){if(n&&n.unit!==we.AUTO)switch(n.unit){case we.PX:e=n.value;break;case we.PERCENT:e*=.01*n.value}this.__mlw=this.__mpWidth(h,e),this.__mtw=this.__mpWidth(a,e),this.__mrw=this.__mpWidth(s,e),this.__mbw=this.__mpWidth(o,e),this.__plw=this.__mpWidth(c,e),this.__ptw=this.__mpWidth(l,e),this.__prw=this.__mpWidth(u,e),this.__pbw=this.__mpWidth(f,e),"block"===r?this.__layoutBlock(t):"flex"===r?this.__layoutFlex(t):"inline"===r&&this.__layoutInline(t)}}},{key:"isGeom",value:function(){return"$"===this.tagName.charAt(0)}},{key:"__mpWidth",value:function(t,e){return t.unit===we.PX?t.value:t.unit===we.PERCENT?t.value*e*.01:0}},{key:"__preLayout",value:function(t){var e=t.x,i=t.y,r=t.w,n=t.h;this.__x=e,this.__y=i;var a,s,o=this.style,h=this.mlw,l=this.mtw,u=this.mrw,f=this.mbw,c=this.plw,d=this.ptw,v=this.prw,_=this.pbw,p=o.width,g=o.height,y=o.borderTopWidth,m=o.borderRightWidth,w=o.borderBottomWidth,x=o.borderLeftWidth;if(p&&p.unit!==we.AUTO)switch(a=!0,p.unit){case we.PX:r=p.value;break;case we.PERCENT:r*=.01*p.value}if(g&&g.unit!==we.AUTO)switch(s=!0,g.unit){case we.PX:n=g.value;break;case we.PERCENT:n*=.01*g.value}return e+=x.value+h+c,t.x=e,i+=y.value+l+d,t.y=i,p.unit===we.AUTO&&(r-=x.value+m.value+h+u+c+v),g.unit===we.AUTO&&(n-=y.value+w.value+l+f+d+_),{fixedWidth:a,fixedHeight:s,x:e,y:i,w:r,h:n}}},{key:"render",value:function(t){(this.__renderMode=t)===me.SVG&&(this.__virtualDom={bb:[],children:[],transform:[]});var e=this.ctx,i=this.style,r=this.width,n=this.height,a=this.mlw,s=this.mrw,o=this.mtw,h=this.mbw,l=this.plw,u=this.ptw,f=this.prw,c=this.pbw;t===me.CANVAS&&e.setTransform(1,0,0,1,0,0);var d=i.display,v=i.position,_=i.top,p=i.right,g=i.bottom,y=i.left,m=i.backgroundGradient,w=i.backgroundColor,x=i.borderTopWidth,b=i.borderTopColor,k=i.borderTopStyle,A=i.borderRightWidth,M=i.borderRightColor,O=i.borderRightStyle,T=i.borderBottomWidth,S=i.borderBottomColor,L=i.borderBottomStyle,P=i.borderLeftWidth,W=i.borderLeftColor,C=i.borderLeftStyle,E=i.transform,N=i.transformOrigin;if("none"!==d){if("relative"===v&&this.parent){var R=this.parent,G=R.width,X=R.height,B=this.parent.style.height;if(y.unit!==we.AUTO){var D=y.unit===we.PX?y.value:y.value*G*.01;this.__offsetX(D)}else if(p.unit!==we.AUTO){var I=p.unit===we.PX?p.value:p.value*G*.01;this.__offsetX(-I)}if(_.unit!==we.AUTO){var j=_.unit===we.PX?_.value:_.value*X*.01*(B.unit===we.AUTO?0:1);this.__offsetY(j)}else if(g.unit!==we.AUTO){var V=g.unit===we.PX?g.value:g.value*X*.01*(B.unit===we.AUTO?0:1);this.__offsetY(-V)}}var U=this.rx,F=this.ry,H=x.value,Y=A.value,z=T.value,$=P.value,q=U+a,Q=q+$,Z=Q+r+l+f,J=Z+Y,K=F+o,tt=K+H,et=tt+n+u+c,it=et+z,rt=r+l+f,nt=n+u+c;if(E){var at=U+a+$+rt+Y+s-U,st=F+o+H+nt+z+h-F,ot=xe.getOrigin(N,U,F,at,st),ht=xe.normalize(E,ot[0],ot[1],at,st),lt=xe.calMatrix(ht,ot[0],ot[1]);if(1!==lt[0]||0!==lt[1]||0!==lt[2]||1!==lt[3]||0!==lt[4]||0!==lt[5]){this.__tfo=ot;for(var ut=this.__matrixSelf=lt,ft=this.parent;ft;)ft.matrixSelf&&(ut=xe.mergeMatrix(ft.matrixSelf,ut)),ft=ft.parent;this.__matrix=ut,t===me.CANVAS?e.setTransform.apply(e,ye(ut)):t===me.SVG&&this.addTransform(["matrix",lt.join(",")])}}if(m){var ct=m.k,dt=m.v,vt=Q+.5*rt,_t=tt+.5*nt;if("linear"===ct){var pt=be.getLinear(dt,vt,_t,rt,nt);if(t===me.CANVAS)e.beginPath(),e.fillStyle=be.createCanvasLg(e,pt),e.rect(Q,tt,rt,nt),e.fill(),e.closePath();else if(t===me.SVG){var gt=be.createSvgLg(this.defs,pt);this.addBackground([["x",Q],["y",tt],["width",rt],["height",nt],["fill","url(#".concat(gt,")")]])}}else if("radial"===ct){var yt=be.getRadial(dt,vt,_t,Q,tt,Z,et);if(t===me.CANVAS)e.beginPath(),e.fillStyle=be.createCanvasRg(e,yt),e.rect(Q,tt,rt,nt),e.fill(),e.closePath();else if(t===me.SVG){var mt=be.createSvgRg(this.defs,yt);this.addBackground([["x",Q],["y",tt],["width",rt],["height",nt],["fill","url(#".concat(mt,")")]])}}}else"transparent"!==w&&(t===me.CANVAS?(e.beginPath(),e.fillStyle=w,e.rect(Q,tt,rt,nt),e.fill(),e.closePath()):t===me.SVG&&this.addBackground([["x",Q],["y",tt],["width",rt],["height",nt],["fill",w]]));if(0<H&&"transparent"!==b){var wt=[];if(-1<["dashed","dotted"].indexOf(k)){var xt=ke.calDashed(k,q,Q,Z,J,H),bt=xt.n,kt=xt.ps,At=xt.pd;if(bt<=1)wt.push([q,K,J,K,Z,tt,Q,tt]);else for(var Mt=Math.atan(H/$),Ot=Math.atan(H/Y),Tt=0;Tt<bt;Tt++){var St=Tt===bt-1,Lt=Tt?q+kt*Tt+At*Tt:q,Pt=Lt+kt,Wt=void 0,Ct=void 0;Pt<Q?St?wt.push([q,K,J,K,Z,tt,Q,tt]):(Wt=K+(Lt-q)*Math.tan(Mt),Ct=K+(Pt-q)*Math.tan(Mt),wt.push([Lt,K,Pt,K,Pt,Ct,Lt,Wt])):Z<Lt?(Wt=K+(J-Lt)*Math.tan(Ot),Ct=K+(J-Pt)*Math.tan(Ot),St?wt.push([Lt,K,J,K,Lt,Wt]):wt.push([Lt,K,Pt,K,Pt,Ct,Lt,Wt])):Lt<Q?(Wt=K+(Lt-q)*Math.tan(Mt),St?wt.push([Lt,K,J,K,Z,tt,Q,tt,Lt,Wt]):Z<Pt?wt.push([Lt,K,Pt,K,Z,tt,Q,tt,Lt,Wt]):wt.push([Lt,K,Pt,K,Pt,tt,Q,tt,Lt,Wt])):Z<Pt?(Wt=K+(J-Pt)*Math.tan(Ot),Lt<Q?St?wt.push([Lt,K,J,K,Z,tt,Q,tt,Lt,Wt]):wt.push([Lt,K,Pt,K,Pt,Wt,Z,tt,Q,tt,Lt,Wt]):St?wt.push([Lt,K,J,K,Z,tt,Lt,tt]):wt.push([Lt,K,Pt,K,Pt,Wt,Z,tt,Lt,tt])):St?wt.push([Lt,K,J,K,Z,tt,Lt,tt]):wt.push([Lt,K,Pt,K,Pt,tt,Lt,tt])}}else wt.push([q,K,J,K,Z,tt,Q,tt]);Ae(t,wt,b,e,this)}if(0<Y&&"transparent"!==M){var Et=[];if(-1<["dashed","dotted"].indexOf(O)){var Nt=ke.calDashed(O,K,tt,et,it,Y),Rt=Nt.n,Gt=Nt.ps,Xt=Nt.pd;if(Rt<=1)Et.push([Z,tt,J,K,J,it,Z,et]);else for(var Bt=Math.atan(Y/H),Dt=Math.atan(Y/z),It=0;It<Rt;It++){var jt=It===Rt-1,Vt=It?K+Gt*It+Xt*It:K,Ut=Vt+Gt,Ft=void 0,Ht=void 0;Ut<tt?jt?Et.push([Z,tt,J,K,J,it,Z,et]):(Ft=J-(Ut-K)*Math.tan(Bt),Ht=J-(Vt-K)*Math.tan(Bt),Et.push([Ft,Ut,Ht,Vt,J,Vt,J,Ut])):et<Vt?(Ft=Z+(Vt-et)*Math.tan(Dt),Ht=Z+(Ut-et)*Math.tan(Dt),jt?Et.push([Ft,Vt,J,Vt,J,it]):Et.push([Ft,Vt,J,Vt,J,Ut,Ht,Ut])):Vt<tt?(Ft=Z+(tt-Vt)*Math.tan(Bt),jt?Et.push([Z,tt,Ft,Vt,J,Vt,J,it,Z,it]):et<Ut?Et.push([Z,tt,Ft,Vt,J,Vt,J,Ut,Ft,Ut,Z,et]):Et.push([Z,tt,Ft,Vt,J,Vt,J,Ut,Z,Ut])):et<Ut?(Ft=Z+(Ut-et)*Math.tan(Dt),Vt<tt?jt?Et.push([Z,tt,Ft,Vt,J,Vt,J,it,Z,et]):Et.push([Z,tt,Ft,Vt,J,Vt,J,Ut,Ft,Ut,Z,et]):jt?Et.push([Z,Vt,J,Vt,J,it,Z,et]):Et.push([Z,Vt,J,Vt,J,Ut,Ft,Ut,Z,et])):jt?Et.push([Z,Vt,J,Vt,J,it,Z,et]):Et.push([Z,Vt,J,Vt,J,Ut,Z,Ut])}}else Et.push([Z,tt,J,K,J,it,Z,et]);Ae(t,Et,M,e,this)}if(0<z&&"transparent"!==S){var Yt=[];if(-1<["dashed","dotted"].indexOf(L))for(var zt=ke.calDashed(L,q,Q,Z,J,z),$t=zt.n,qt=zt.ps,Qt=zt.pd,Zt=Math.atan(z/$),Jt=Math.atan(z/Y),Kt=0;Kt<$t;Kt++){var te=Kt===$t-1,ee=Kt?q+qt*Kt+Qt*Kt:q,ie=ee+qt,re=void 0,ne=void 0;ie<Q?te?Yt.push([q,it,Q,et,Z,et,J,it]):(re=it-(ee-q)*Math.tan(Zt),ne=it-(ie-q)*Math.tan(Zt),Yt.push([ee,re,ie,ne,ie,it,ee,it])):Z<ee?(re=it-(ee-q)*Math.tan(Jt),ne=it-(ie-q)*Math.tan(Jt),te?Yt.push([ee,re,J,it,ee,it]):Yt.push([ee,re,ie,ne,ie,it,ee,it])):ee<Q?(re=et+(ee-q)*Math.tan(Zt),te?Yt.push([ee,re,Q,et,Z,et,J,it,ee,it]):Z<ie?Yt.push([ee,re,Q,et,Z,et,ie,it,ee,it]):Yt.push([ee,re,Q,et,ie,et,ie,it,ee,it])):Z<ie?(re=it-(J-ie)*Math.tan(Jt),ee<Q?te?Yt.push([ee,re,Z,et,J,it,ee,it]):Yt.push([ee,re,Z,et,ie,re,ie,it,ee,it]):te?Yt.push([ee,et,Z,et,J,it,ee,it]):Yt.push([ee,et,Z,et,ie,re,ie,it,ee,it])):te?Yt.push([ee,et,Z,et,J,it,ee,it]):Yt.push([ee,et,ie,et,ie,it,ee,it])}else Yt.push([q,it,Q,et,Z,et,J,it]);Ae(t,Yt,S,e,this)}if(0<$&&"transparent"!==W){var ae=[];if(-1<["dashed","dotted"].indexOf(C)){var se=ke.calDashed(C,K,tt,et,it,$),oe=se.n,he=se.ps,le=se.pd;if(oe<=1)ae.push([q,K,Q,tt,Q,et,q,it]);else for(var ue=Math.atan($/H),fe=Math.atan($/z),ce=0;ce<oe;ce++){var de=ce===oe-1,ve=ce?K+he*ce+le*ce:K,_e=ve+he,pe=void 0,ge=void 0;_e<tt?de?ae.push([q,K,Q,tt,Q,et,q,it]):(pe=q+(ve-K)*Math.tan(ue),ge=q+(_e-K)*Math.tan(ue),ae.push([q,ve,pe,ve,ge,_e,q,_e])):et<ve?(pe=q+(it-ve)*Math.tan(fe),ge=q+(it-_e)*Math.tan(fe),de?ae.push([q,ve,pe,ve,q,it]):ae.push([q,ve,pe,ve,ge,_e,q,_e])):ve<tt?(pe=q+(ve-K)*Math.tan(ue),de?ae.push([q,ve,pe,ve,Q,tt,Q,et,q,it]):et<_e?ae.push([q,ve,pe,ve,Q,tt,Q,et,pe,_e,q,_e]):ae.push([q,ve,pe,ve,Q,tt,Q,_e,q,_e])):et<_e?(pe=q+(it-_e)*Math.tan(fe),ve<tt?de?ae.push([q,ve,pe,ve,Q,tt,Q,et,q,it]):ae.push([q,ve,pe,ve,Q,tt,Q,et,pe,_e,q,_e]):de?ae.push([q,ve,Q,ve,Q,et,q,it]):ae.push([q,ve,Q,ve,Q,et,pe,_e,q,_e])):de?ae.push([q,ve,Q,ve,Q,et,q,it]):ae.push([q,ve,Q,ve,Q,_e,q,_e])}}else ae.push([q,K,Q,tt,Q,et,q,it]);Ae(t,ae,W,e,this)}}}},{key:"__emitEvent",value:function(e,i){var t=e.event.type,r=e.x,n=e.y,a=e.covers,s=this.listener,o=this.children,h=this.style,l=this.outerWidth,u=this.outerHeight,f=this.matrix;if("none"!==h.display){var c,d;if(s.hasOwnProperty(t)&&(c=s[t]),i)return o.forEach(function(t){t instanceof y&&!t.isGeom()&&t.__emitEvent(e,i)}),void(c&&c(e));if(!this.isGeom()){for(var v=o.length-1;0<=v;v--){var _=o[v];_ instanceof y&&-1<["absolute","relative"].indexOf(_.style.position)&&_.__emitEvent(e)&&(d=!0)}for(var p=o.length-1;0<=p;p--){var g=o[p];g instanceof y&&-1===["absolute","relative"].indexOf(g.style.position)&&g.__emitEvent(e)&&(d=!0)}}(d||this.willResponseEvent(e))&&(a.push({x:r,y:n,w:l,h:u,matrix:f}),e.target||(e.target=this),c&&c(e))}}},{key:"willResponseEvent",value:function(t){var e=t.x,i=t.y,r=t.covers,n=this.rx,a=this.ry,s=this.outerWidth,o=this.outerHeight,h=this.matrix;if(xe.pointInQuadrilateral(e-n,i-a,0,0,s,0,0,o,s,o,h)){for(var l=0,u=r.length;l<u;l++){var f=r[l],c=f.x,d=f.y,v=f.w,_=f.h,p=f.matrix;if(xe.pointInQuadrilateral(e-n,i-a,c-n,d-a,c-n+v,d-a,c-n,d-a+_,c-n+v,d-a+_,p))return}return t.target||(t.target=this),!0}}},{key:"addBorder",value:function(t){this.virtualDom.bb.push({type:"item",tagName:"path",props:t})}},{key:"addBackground",value:function(t){this.virtualDom.bb.push({type:"item",tagName:"rect",props:t})}},{key:"addTransform",value:function(t){this.virtualDom.transform.push(t)}},{key:"tagName",get:function(){return this.__tagName}},{key:"mtw",get:function(){return this.__mtw}},{key:"mrw",get:function(){return this.__mrw}},{key:"mbw",get:function(){return this.__mbw}},{key:"mlw",get:function(){return this.__mlw}},{key:"ptw",get:function(){return this.__ptw}},{key:"prw",get:function(){return this.__prw}},{key:"pbw",get:function(){return this.__pbw}},{key:"plw",get:function(){return this.__plw}},{key:"outerWidth",get:function(){var t=this.mlw,e=this.mrw,i=this.plw,r=this.prw,n=this.style,a=n.borderLeftWidth,s=n.borderRightWidth;return this.width+a.value+s.value+t+e+i+r}},{key:"outerHeight",get:function(){var t=this.mtw,e=this.mbw,i=this.ptw,r=this.pbw,n=this.style,a=n.borderTopWidth,s=n.borderBottomWidth;return this.height+a.value+s.value+t+e+i+r}},{key:"listener",get:function(){return this.__listener}},{key:"renderMode",get:function(){return this.__renderMode}},{key:"matrix",get:function(){return this.__matrix}},{key:"matrixSelf",get:function(){return this.__matrixSelf}},{key:"tfo",get:function(){return this.__tfo}}]),y}(),A={lhr:1.14990234375,car:1.1171875,blr:.9052734375,mdr:.64599609375,lgr:.03271484375},M={position:"static",display:"block",borderSizing:"content-box",top:"auto",right:"auto",bottom:"auto",left:"auto",marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,fontSize:16,fontFamily:"arial",color:"#000",fontStyle:"normal",fontWeight:400,lineHeight:"normal",backgroundColor:"transparent",borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderTopColor:"#000",borderRightColor:"#000",borderBottomColor:"#000",borderLeftColor:"#000",borderTopStyle:"solid",borderRightStyle:"solid",borderBottomStyle:"solid",borderLeftStyle:"solid",borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomLeftRadius:0,borderBottomRightRadius:0,verticalAlign:"baseline",width:"auto",height:"auto",flexGrow:0,flexShrink:1,flexBasis:"auto",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",textAlign:"left",visibility:"visible",transformOrigin:"center",fill:"transparent",stroke:"#000",strokeWidth:1,strokeDasharray:[]},O=[];function T(t,e){var i="border".concat(e);if(t[i]){var r=/\b\d+px\b/i.exec(t[i]);r&&(t[i+"Width"]=r[0]);var n=/\b(solid|dashed|dotted)\b/i.exec(t[i]);n&&(t[i+"Style"]=n[1]);var a=/#[0-9a-f]{3,6}/i.exec(t[i]);a&&-1<[4,7].indexOf(a[0].length)?t[i+"Color"]=a[0]:/\btransparent\b/i.test(t[i])?t[i+"Color"]="transparent":(a=/rgba?\(.+\)/i.exec(t[i]))&&(t[i+"Color"]=a[0])}}function S(t,e,i){return"auto"===i?t[e]={unit:we.AUTO}:/px$/.test(i)?(i=parseFloat(i)||0,t[e]={value:i,unit:we.PX}):/%$/.test(i)?0===e.toString().indexOf("border")?t[e]={value:0,unit:we.PX}:(i=parseFloat(i)||0,t[e]={value:i,unit:we.PERCENT}):(i=parseFloat(i)||0,t[e]={value:i,unit:we.PX}),t}Object.keys(M).forEach(function(t){var e=M[t];O.push({k:t,v:e})});var L={normalize:function(i){O.forEach(function(t){i.hasOwnProperty(t.k)||(i[t.k]=t.v)});var t=i.background;if(t){var e=be.parseGradient(t);if(e)i.backgroundGradient=e;else{var r=/#[0-9a-f]{3,6}/i.exec(t);r&&-1<[4,7].indexOf(r[0].length)?i.backgroundColor=r[0]:(r=/rgba?\(.+\)/i.exec(t))&&(i.backgroundColor=r[0])}}if((t=i.flex)&&("none"===t?(i.flexGrow=0,i.flexShrink=0,i.flexBasis="auto"):"auto"===t?(i.flexGrow=1,i.flexShrink=1,i.flexBasis="auto"):/^[\d.]+$/.test(t)?(i.flexGrow=parseFloat(t),i.flexShrink=1,i.flexBasis=0):/^[\d.]+px$/.test(t)||/^[\d.]+%$/.test(t)||(i.flexGrow=0,i.flexShrink=1,i.flexBasis="auto")),(t=i.border)&&(i.borderTop=i.borderRight=i.borderBottom=i.borderLeft=t),t=i.margin){var n=t.toString().match(/(-?[\d.]+(px|%)?)|(auto)/gi);n&&(1===n.length?n[3]=n[2]=n[1]=n[0]:2===n.length?(n[2]=n[0],n[3]=n[1]):3===n.length&&(n[3]=n[1]),i.marginTop=n[0],i.marginRight=n[1],i.marginBottom=n[2],i.marginLeft=n[3])}if(t=i.padding){var a=t.toString().match(/(-?[\d.]+(px|%)?)|(auto)/gi);a&&(1===a.length?a[3]=a[2]=a[1]=a[0]:2===a.length?(a[2]=a[0],a[3]=a[1]):3===a.length&&(a[3]=a[1]),i.paddingTop=a[0],i.paddingRight=a[1],i.paddingBottom=a[2],i.paddingLeft=a[3])}if(t=i.transform){var s=t.toString().match(/\w+\(.+?\)/g);if(s){var p=i.transform=[];s.forEach(function(t){var e=t.indexOf("("),i=t.slice(0,e),r=t.slice(e+1,t.length-1);if("matrix"===i){var n=r.split(/\s*,\s*/);if(6<(n=n.map(function(t){return parseFloat(t)})).length)n=n.slice(0,6);else if(n.length<6)for(;n.length<6;)n.push(0);p.push(["matrix",n])}else if("translateX"===i){var a=["translateX",r];p.push(S(a,1,r))}else if("translateY"===i){var s=["translateY",r];p.push(S(s,1,r))}else if("translate"===i){var o=r.split(/\s*,\s*/),h=["translateX",o[0]],l=["translateY",o[1]];p.push(S(h,1,r)),p.push(S(l,1,r))}else if("scaleX"===i)p.push(["scaleX",parseFloat(r)||0]);else if("scaleY"===i)p.push(["scaleY",parseFloat(r)||0]);else if("scale"===i){var u=r.split(/\s*,\s*/),f=parseFloat(u[0])||0,c=parseFloat(u[u.length-1])||0;p.push(["scaleX",f]),p.push(["scaleY",c])}else if("rotateZ"===i||"rotate"===i)p.push(["rotateZ",parseFloat(r)||0]);else if("skewX"===i)p.push(["skewX",parseFloat(r)||0]);else if("skewY"===i)p.push(["skewY",parseFloat(r)||0]);else if("skew"===i){var d=r.split(/\s*,\s*/),v=parseFloat(d[0])||0,_=parseFloat(d[d.length-1])||0;p.push(["skewX",v]),p.push(["skewY",_])}})}}if(t=i.transformOrigin){var o=t.toString().match(/(-?[\d.]+(px|%)?)|(left|top|right|bottom|center)/gi);if(o){1===o.length&&(o[1]=o[0]);for(var h=[],l=0;l<2;l++){var u=o[l];/px$/.test(u)?h.push({value:parseFloat(u),unit:we.PX}):/%$/.test(u)?h.push({value:parseFloat(u),unit:we.PERCENT}):h.push({value:u,unit:we.POSITION})}i.transformOrigin=h}}T(i,"Top"),T(i,"Right"),T(i,"Bottom"),T(i,"Left"),["marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","top","right","bottom","left","width","height","flexBasis"].forEach(function(t){var e=i[t];S(i,t,e)});var f=i.lineHeight;f="normal"===f?{value:i.fontSize*A.lhr,unit:we.PX}:/px$/.test(f)?(f=parseFloat(f),{value:Math.max(i.fontSize,f),unit:we.PX}):"normal"===(f=parseFloat(f)||"normal")?{value:i.fontSize*A.lhr,unit:we.PX}:{value:f*i.fontSize,unit:we.PX},i.lineHeight=f},setFontStyle:function(t){var e=t.fontStyle,i=t.fontWeight,r=t.fontSize,n=t.fontFamily;return"".concat(e," ").concat(i," ").concat(r,"px/").concat(r,"px ").concat(n)},getBaseLine:function(t){var e=t.fontSize*A.lhr;return.5*(t.lineHeight.value-e)+t.fontSize*A.blr}},P=function(){function s(t,e,i,r,n,a){o(this,s),this.__parent=t,this.__x=e,this.__y=i,this.__width=r,this.__content=n,this.__style=a,this.__virtualDom={}}return a(s,[{key:"render",value:function(t,e){var i=this.style,r=this.content,n=this.x,a=this.y,s=this.parent,o=s.ox,h=s.oy;a+=L.getBaseLine(i),n+=o,a+=h,t===me.CANVAS?e.fillText(r,n,a):t===me.SVG&&(this.__virtualDom={type:"item",tagName:"text",props:[["x",n],["y",a],["fill",i.color],["font-size","".concat(i.fontSize,"px")]],content:r})}},{key:"__offsetX",value:function(t){this.__x+=t}},{key:"__offsetY",value:function(t){this.__y+=t}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){return this.__width}},{key:"content",get:function(){return this.__content}},{key:"style",get:function(){return this.__style}},{key:"baseLine",get:function(){return L.getBaseLine(this.style)}},{key:"virtualDom",get:function(){return this.__virtualDom}},{key:"parent",get:function(){return this.__parent}}]),s}(),W={},C=function(){function i(t){var e;return o(this,i),(e=s(this,V(i).call(this))).__content=t.toString(),e.__lineBoxes=[],e.__charWidthList=[],e.__charWidth=0,e.__textWidth=0,e}return t(i,l),a(i,[{key:"__measure",value:function(){this.__charWidthList=[];var t=this.ctx,e=this.content,i=this.style,r=this.charWidthList,n=this.renderMode;n===me.CANVAS&&(t.font=L.setFontStyle(i));for(var a=W[i.fontSize]=W[i.fontSize]||{},s=e.length,o=0,h=0;h<s;h++){var l=e.charAt(h),u=void 0;a.hasOwnProperty(l)?u=a[l]:n===me.CANVAS?u=a[l]=t.measureText(l).width:n===me.SVG&&(u=a[l]=me.measure(l,i)),r.push(u),o+=u,this.__charWidth=Math.max(this.charWidth,u)}this.__textWidth=o}},{key:"__layout",value:function(t,e){var i=this,r=t.x,n=t.y,a=t.w;t.h;this.__x=r,this.__y=n;for(var s=r,o=(this.ctx,this.content),h=this.style,l=this.lineBoxes,u=this.charWidthList,f=(this.renderMode,0),c=0,d=0,v=o.length;c<v;)if((d+=u[c])===a){var _=new P(this,r,n,d,o.slice(f,c+1),h);l.push(_),s=Math.max(s,r+d),n+=this.style.lineHeight.value,c=(f=c+1)+1,d=0}else if(a<d){c===f&&(c=f+1);var p=new P(this,r,n,d-u[c],o.slice(f,c),h);l.push(p),s=Math.max(s,r+d-u[c]),n+=this.style.lineHeight.value,f=c,c+=1,d=0}else c++;if(f<v&&f<c){for(d=0,c=f;c<v;c++)d+=u[c];var g=new P(this,r,n,d,o.slice(f,v),h);l.push(g),s=Math.max(s,r+d),n+=h.lineHeight.value}if(this.__width=s-r,this.__height=n-t.y,e)this.__lineBoxes=[];else{var y=h.textAlign;-1<["center","right"].indexOf(y)&&l.forEach(function(t){var e=i.__width-t.width;0<e&&t.__offsetX("center"===y?.5*e:e)})}}},{key:"render",value:function(e){var i=this.ctx,t=this.style;e===me.CANVAS&&(i.font=L.setFontStyle(t),i.fillStyle=t.color),this.lineBoxes.forEach(function(t){t.render(e,i)}),e===me.SVG&&(this.__virtualDom={type:"text",children:this.lineBoxes.map(function(t){return t.virtualDom})})}},{key:"__tryLayInline",value:function(t){return t-this.textWidth}},{key:"__calMaxAndMinWidth",value:function(){var e=0;return this.charWidthList.forEach(function(t){e=Math.max(e,t)}),{max:this.textWidth,min:e}}},{key:"content",get:function(){return this.__content},set:function(t){this.__content=t}},{key:"lineBoxes",get:function(){return this.__lineBoxes}},{key:"charWidthList",get:function(){return this.__charWidthList}},{key:"charWidth",get:function(){return this.__charWidth}},{key:"textWidth",get:function(){return this.__textWidth}},{key:"baseLine",get:function(){var t=this.lineBoxes[this.lineBoxes.length-1];return t.y-this.y+t.baseLine}},{key:"renderMode",get:function(){return this.__renderMode}}]),i}(),E=function(){function i(t,e){o(this,i),this.__list=[],this.__x=t,this.__y=e,this.__baseLine=0}return a(i,[{key:"add",value:function(t){this.list.push(t)}},{key:"__calBaseLine",value:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.baseLine)}),e}},{key:"verticalAlign",value:function(){var e=this;this.__baseLine=this.__calBaseLine(),1<this.list.length&&this.list.forEach(function(t){t.baseLine!==e.baseLine&&t.__offsetY(e.baseLine-t.baseLine)})}},{key:"horizonAlign",value:function(e){this.list.forEach(function(t){t.__offsetX(e)})}},{key:"list",get:function(){return this.__list}},{key:"x",get:function(){return this.__x}},{key:"y",get:function(){return this.__y}},{key:"width",get:function(){var e=0;return this.list.forEach(function(t){e+=t.width}),e}},{key:"height",get:function(){var e=0;return this.list.forEach(function(t){e=Math.max(e,t.height)}),e}},{key:"baseLine",get:function(){return this.__baseLine}},{key:"size",get:function(){return this.__list.length}}]),i}(),N={},G=function(){function i(t,e){return o(this,i),s(this,V(i).call(this,t,e))}return t(i,j),a(i,[{key:"__initStyle",value:function(){L.normalize(this.style)}},{key:"__tryLayInline",value:function(t,e){var i=this.style.width;return i.unit===we.PX?t-i.value:i.unit===we.PERCENT?t-e*i.value*.01:t}},{key:"__calAutoBasis",value:function(t,e,i){var r=0,n=0,a=0,s=this.style,o=s.width,h=s.height,l=s.borderTopWidth,u=s.borderRightWidth,f=s.borderBottomWidth,c=s.borderLeftWidth,d=t?o:h;if(d.unit!==we.AUTO&&(r=a+=d.value),t){var v=u.value+c.value;r+=v,a+=v,n+=v}else{var _=l.value+f.value;r+=_,a+=_,n+=_}return{b:r,min:n,max:a}}},{key:"__layoutBlock",value:function(t){var e=this.__preLayout(t),i=e.fixedHeight,r=e.w,n=e.h;this.__width=r,this.__height=i?n:0}},{key:"__layoutFlex",value:function(t){this.__layoutBlock(t)}},{key:"__layoutInline",value:function(t){var e=this.__preLayout(t),i=e.fixedWidth,r=e.fixedHeight,n=e.x,a=e.y,s=e.w,o=e.h;this.__width=i?s:n-t.x,this.__height=r?o:a-t.y}},{key:"__calAbs",value:function(){return 0}},{key:"render",value:function(t){U(V(i.prototype),"render",this).call(this,t),t===me.SVG&&(this.__virtualDom=n({},U(V(i.prototype),"virtualDom",this),{type:"geom"}))}},{key:"addGeom",value:function(t,e){e=I.hash2arr(e),this.virtualDom.children.push({type:"item",tagName:t,props:e})}},{key:"tagName",get:function(){return this.__tagName}},{key:"baseLine",get:function(){return this.__height}}],[{key:"getRegister",value:function(t){if(!N.hasOwnProperty(t))throw new Error("Geom has not register: ".concat(t));return N[t]}},{key:"register",value:function(t,e){if(i.hasRegister(t))throw new Error("Geom has already register: ".concat(t));N[t]=e}},{key:"hasRegister",value:function(t){return N.hasOwnProperty(t)}}]),i}(),R={div:!0,span:!0},X={span:!0},B=function(){function u(t,e,i){var r;return o(this,u),(r=s(this,V(u).call(this,t,e))).__children=i,r.__flowChildren=[],r.__absChildren=[],r.__lineGroups=[],r.__flowY=0,r}return t(u,j),a(u,[{key:"__traverse",value:function(e,i,t){var r=this,n=[];this.__traverseChildren(this.children,n,e,i,t);for(var a=n.length-1;0<a;a--){var s=n[a];if(s instanceof C){var o=n[a-1];o instanceof C?(o.content+=s.content,n.splice(a,1)):a--}}if("inline"===this.style.display&&"flex"!==this.parent.style.display)for(var h=n.length-1;0<=h;h--){var l=n[h];if(l instanceof u&&"inline"!==l.style.display)throw new Error("inline can not contain block/flex")}n.forEach(function(t){t.__ctx=e,t.__defs=i,t.__parent=r,t.__prev=null,t instanceof C||"absolute"!==t.style.position?r.__flowChildren.push(t):r.__absChildren.push(t)}),this.__children=n}},{key:"__traverseChildren",value:function(t,e,i,r,n){var a=this;if(Array.isArray(t))t.forEach(function(t){a.__traverseChildren(t,e,i,r,n)});else if(t instanceof u)e.push(t),t.__traverse(i,r,n);else if(t instanceof G)e.push(t);else if(!I.isNil(t)){var s=new C(t);s.__renderMode=n,e.push(s)}}},{key:"__initStyle",value:function(){var e=this.__style;e.display&&-1!==["flex","block","inline","none"].indexOf(e.display)||(X.hasOwnProperty(this.tagName)?e.display="inline":e.display="block");var t=this.parent;if(t){var i=t.style;["fontSize","fontWeight","fontStyle","lineHeight","wordBreak","color","textAlign"].forEach(function(t){!e.hasOwnProperty(t)&&i.hasOwnProperty(t)&&(e[t]=i[t])})}L.normalize(e),this.children.forEach(function(t){t instanceof j?t.__initStyle():(t.__style=e,t.__measure())})}},{key:"__tryLayInline",value:function(t,e){var i=this.flowChildren,r=this.style.width;if(r.unit===we.PX)return t-r.value;if(r.unit===we.PERCENT)return t-e*r.value*.01;for(var n=0;n<i.length;n++){if(t<0)return t;var a=i[n];t-=a instanceof j?a.__tryLayInline(t,e):a.textWidth}return t}},{key:"__offsetX",value:function(e){U(V(u.prototype),"__offsetX",this).call(this,e),this.flowChildren.forEach(function(t){t&&t.__offsetX(e)})}},{key:"__offsetY",value:function(e){U(V(u.prototype),"__offsetY",this).call(this,e),this.flowChildren.forEach(function(t){t&&t.__offsetY(e)})}},{key:"__calAutoBasis",value:function(a,s,o,t){var h=0,l=0,u=0,e=this.mtw,i=this.mrw,r=this.mbw,n=this.mlw,f=this.ptw,c=this.prw,d=this.pbw,v=this.plw,_=this.flowChildren,p=this.style,g=p.width,y=p.height,m=p.borderTopWidth,w=p.borderRightWidth,x=p.borderBottomWidth,b=p.borderLeftWidth,k=a?g:y;if(k.unit===we.PX&&(h=u=k.value,t&&(l=h)),_.forEach(function(t){if(t instanceof j){var e=t.__calAutoBasis(a,s,o,!0),i=e.b,r=e.min,n=e.max;h=Math.max(h,i),l=Math.max(l,r),u=Math.max(u,n)}else u=a?(l=Math.max(t.charWidth,l),Math.max(t.textWidth,u)):(t.__layout({x:0,y:0,w:s,h:o},!0),l=Math.max(l,t.height),Math.max(u,t.height))}),a){var A=w.value+b.value+n+i+v+c;h+=A,u+=A,l+=A}else{var M=m.value+x.value+e+r+f+d;h+=M,u+=M,l+=M}return{b:h,min:l,max:u}}},{key:"__calAbs",value:function(i){var r=0,t=this.mtw,e=this.mrw,n=this.mbw,a=this.mlw,s=this.ptw,o=this.prw,h=this.pbw,l=this.plw,u=this.flowChildren,f=this.style,c=f.width,d=f.height,v=f.borderTopWidth,_=f.borderRightWidth,p=f.borderBottomWidth,g=f.borderLeftWidth,y=i?c:d;if(y.unit===we.PX&&(r=y.value),u.forEach(function(t){if(t instanceof j){var e=t.__calAbs(i);r=Math.max(r,e)}else r=i?Math.max(t.textWidth,r):(t.__layout({x:0,y:0,w:1/0,h:1/0},!0),Math.max(r,t.height))}),i){var m=_.value+g.value+a+e+l+o;r+=m}else{var w=v.value+p.value+t+n+s+h;r+=w}return r}},{key:"__layoutBlock",value:function(e){var t=this.flowChildren,i=this.style,r=this.lineGroups,n=i.width,a=i.marginLeft,s=i.marginRight,o=i.textAlign,h=this.__preLayout(e),l=h.fixedHeight,u=h.x,f=h.y,c=h.w,d=h.h,v=new E(u,f);if(t.forEach(function(t){t instanceof j?"inline"===t.style.display?u===e.x?(v.add(t),t.__layout({x:u,y:f,w:c,h:d}),u+=t.outerWidth):(0<=t.__tryLayInline(c-u,c)?t.__layout({x:u,y:f,w:c,h:d}):(r.push(v),v.verticalAlign(),u=e.x,f+=v.height,t.__layout({x:e.x,y:f,w:c,h:d}),v=new E(u,f)),u+=t.outerWidth,v.add(t)):(v.size&&(r.push(v),v.verticalAlign(),f+=v.height,v=new E(e.x,f)),t.__layout({x:e.x,y:f,w:c,h:d}),u=e.x,f+=t.outerHeight):u===e.x?(v.add(t),t.__layout({x:u,y:f,w:c,h:d}),u+=t.width):(0<=t.__tryLayInline(c-u,c)?t.__layout({x:u,y:f,w:c,h:d}):(r.push(v),v.verticalAlign(),u=e.x,f+=v.height,t.__layout({x:e.x,y:f,w:c,h:d}),v=new E(u,f)),u+=t.width,v.add(t))}),v.size&&(r.push(v),v.verticalAlign(),f+=v.height),-1<["center","right"].indexOf(o)&&r.forEach(function(t){var e=c-t.width;0<e&&t.horizonAlign("center"===o?.5*e:e)}),this.__width=c,this.__height=l?d:f-e.y,this.__flowY=f,a.unit===we.AUTO&&s.unit===we.AUTO&&n.unit!==we.AUTO){var _=this.outerWidth;_<e.w&&this.__offsetX(.5*(e.w-_))}}},{key:"__layoutFlex",value:function(t){var e=this.flowChildren,i=this.style,r=i.marginLeft,n=i.marginRight,a=i.flexDirection,s=i.justifyContent,o=i.alignItems,h=this.__preLayout(t),l=h.fixedWidth,M=h.fixedHeight,O=h.x,T=h.y,S=h.w,L=h.h,P="row"===a;if(!P&&!M)return e.forEach(function(t){if(t instanceof j){var e=t.style,i=t.style,r=i.display,n=i.flexDirection,a=i.width;"inline"===r?e.display="block":"flex"===r&&"row"===n&&a.unit===we.AUTO&&(a.value=S,a.unit=we.PX),t.__layout({x:O,y:T,w:S,h:L}),T+=t.outerHeight}else t.__layout({x:O,y:T,w:S,h:L}),T+=t.outerHeight}),this.__width=S,void(this.__height=T-t.y);var W=[],C=[],E=[],N=[],R=0,G=0,X=0,u=0;e.forEach(function(t){if(t instanceof j){var e=t.style,i=e.flexGrow,r=e.flexShrink,n=e.flexBasis;W.push(i),C.push(r),R+=i,G+=r;var a=t.__calAutoBasis(P,S,L),s=a.b,o=a.min,h=a.max;n.unit===we.AUTO?(E.push(h),X+=h):n.unit===we.PX?(s=n.value,E.push(s),X+=s):n.unit===we.PERCENT&&(s=(P?S:L)*n.value,E.push(s),X+=s),u+=h,N.push(o)}else W.push(0),C.push(1),G+=1,P?(E.push(t.textWidth),X+=t.textWidth,u+=t.textWidth,N.push(t.charWidth)):(t.__layout({x:0,y:0,w:S,h:L},!0),E.push(t.height),X+=t.height,u+=t.height,N.push(t.height))});var B=0,D=(P?S:L)<u;e.forEach(function(t,e){var i,r=C[e],n=W[e];if(D){var a=X-(P?S:L);i=r?E[e]-a*r/G:E[e]}else{var s=(P?S:L)-X;i=n?E[e]+s*n/R:E[e]}if(i=Math.max(i,N[e]),t instanceof j){var o=t.style,h=t.mlw,l=t.mtw,u=t.mrw,f=t.mbw,c=t.plw,d=t.ptw,v=t.prw,_=t.pbw,p=t.style,g=p.display,y=p.flexDirection,m=p.width,w=p.height,x=p.borderTopWidth,b=p.borderRightWidth,k=p.borderBottomWidth,A=p.borderLeftWidth;P?("inline"===g?o.display="block":"flex"===g&&"column"===y&&M&&w.unit===we.AUTO&&(w.value=L,w.unit=we.PX),t.__layout({x:O,y:T,w:i,h:L})):("inline"===g?o.display="block":"flex"===g&&"row"===y&&m.unit===we.AUTO&&(m.value=S,m.unit=we.PX),t.__layout({x:O,y:T,w:S,h:i})),D&&r?P?t.__width=i-h-u-c-v-A.value-b.value:t.__height=i-l-f-d-_-x.value-k.value:!D&&n&&(P?t.__width=i-h-u-c-v-A.value-b.value:t.__height=i-l-f-d-_-x.value-k.value)}else t.__layout({x:O,y:T,w:P?i:S,h:P?L:i});B=P?(O+=t.outerWidth,Math.max(B,t.outerHeight)):(T+=t.outerHeight,Math.max(B,t.outerWidth))});var f=P?S-O+t.x:L-T+t.y;if(!D&&0===R&&0<f){var c=e.length;if("flex-end"===s)for(var d=0;d<c;d++){var v=e[d];P?v.__offsetX(f):v.__offsetY(f)}else if("center"===s)for(var _=.5*f,p=0;p<c;p++){var g=e[p];P?g.__offsetX(_):g.__offsetY(_)}else if("space-between"===s)for(var y=f/(c-1),m=1;m<c;m++){var w=e[m];P?w.__offsetX(y*m):w.__offsetY(y*m)}else if("space-around"===s)for(var x=f/(c+1),b=0;b<c;b++){var k=e[b];P?k.__offsetX(x*(b+1)):k.__offsetY(x*(b+1))}}if(P?(M&&(B=L),T+=B):l&&(B=S),"stretch"===o?e.forEach(function(t){var e=t.style,i=t.mlw,r=t.mtw,n=t.mrw,a=t.mbw,s=t.ptw,o=t.prw,h=t.plw,l=t.pbw;P?e.height.unit===we.AUTO&&(t.__height=B-r-a-s-l-e.borderTopWidth.value-e.borderBottomWidth.value):e.width.unit===we.AUTO&&(t.__width=B-i-n-h-o-e.borderRightWidth.value-e.borderLeftWidth.value)}):"center"===o?e.forEach(function(t){var e=B-t.outerHeight;0<e&&t.__offsetY(.5*e)}):"flex-end"===o&&e.forEach(function(t){var e=B-t.outerHeight;0<e&&t.__offsetY(e)}),this.__width=S,this.__height=M?L:T-t.y,this.__flowY=T,r.unit===we.AUTO&&n.unit===we.AUTO&&width.unit!==we.AUTO){var A=this.outerWidth;A<t.w&&this.__offsetX(.5*(t.w-A))}}},{key:"__layoutInline",value:function(e){var i=this,t=this.flowChildren,r=this.style,n=this.lineGroups,a=r.width,s=r.marginLeft,o=r.marginRight,h=r.textAlign,l=this.__preLayout(e),u=l.fixedWidth,f=l.fixedHeight,c=l.x,d=l.y,v=l.w,_=l.h,p=c,g=new E(c,d);if(t.forEach(function(t){if(t instanceof j){if("absolute"===t.style.position)return void i.absChildren.push(t);if(t.style.display="inline",c===e.x)g.add(t),t.__layout({x:c,y:d,w:v,h:_}),c+=t.outerWidth,p=Math.max(p,c);else 0<=t.__tryLayInline(v-c,v)?t.__layout({x:c,y:d,w:v,h:_}):(n.push(g),g.verticalAlign(),c=e.x,d+=g.height,t.__layout({x:e.x,y:d,w:v,h:_}),g=new E(c,d)),c+=t.outerWidth,p=Math.max(p,c),g.add(t)}else{if(c===e.x)g.add(t),t.__layout({x:c,y:d,w:v,h:_}),c+=t.width,p=Math.max(p,c);else 0<=t.__tryLayInline(v-c,v)?t.__layout({x:c,y:d,w:v,h:_}):(n.push(g),g.verticalAlign(),c=e.x,d+=g.height,t.__layout({x:e.x,y:d,w:v,h:_}),g=new E(c,d)),c+=t.width,p=Math.max(p,c),g.add(t)}}),g.size&&(n.push(g),g.verticalAlign(),d+=g.height),-1<["center","right"].indexOf(h)&&n.forEach(function(t){var e=v-t.width;0<e&&t.horizonAlign("center"===h?.5*e:e)}),this.__width=u?v:p-e.x,this.__height=f?_:d-e.y,this.__flowY=d,s.unit===we.AUTO&&o.unit===we.AUTO&&a.unit!==we.AUTO){var y=this.outerWidth;y<e.w&&this.__offsetX(.5*(e.w-y))}}},{key:"__layoutAbs",value:function(e){var _=this.x,p=this.y,g=this.flowY,y=this.width,m=this.height,t=this.children,i=this.absChildren,r=this.style,n=this.mlw,w=this.mtw,a=this.plw,s=this.ptw,o=this.prw,h=this.pbw,x=r.borderTopWidth,l=r.borderLeftWidth;_+=n+l.value,p+=w+x.value;var b=y+a+o,k=m+s+h;t.forEach(function(t){t instanceof u&&t.__layoutAbs(-1<["absolute","relative"].indexOf(t.style.position)?t:e)}),i.forEach(function(t){var e,i,r,n,a=t.style,s=t.style,o=s.left,h=s.top,l=s.right,u=s.bottom,f=s.width,c=s.height;if(o.unit!==we.AUTO&&l.unit!==we.AUTO)e=o.unit===we.PX?_+o.value:_+y*o.value*.01,r=l.unit===we.PX?_+b-l.value-e:_+b-y*l.value*.01-e;else if(o.unit!==we.AUTO&&f.unit!==we.AUTO)e=o.unit===we.PX?_+o.value:_+y*o.value*.01,r=f.unit===we.PX?f.value:y;else if(l.unit!==we.AUTO&&f.unit!==we.AUTO){r=f.unit===we.PX?f.value:y;var d=f.unit===we.PX?f.value:y*f.value*.01;e=l.unit===we.PX?_+b-l.value-d:_+b-y*l.value*.01-d}else o.unit!==we.AUTO?(e=o.unit===we.PX?_+o.value:_+y*o.value*.01,r=t.__calAbs(!0)):l.unit!==we.AUTO?(r=t.__calAbs(!0),e=l.unit===we.PX?_+b-l.value-r:_+b-y*l.value*.01-r):r=f.unit!==we.AUTO?(e=_,f.unit===we.PX?f.value:y):(e=_,t.__calAbs(!0));if(h.unit!==we.AUTO&&u.unit!==we.AUTO)i=h.unit===we.PX?p+h.value:p+m*h.value*.01,n=u.unit===we.PX?p+k-u.value-i:p+k-m*u.value*.01-i,a.height={value:n,unit:we.PX};else if(h.unit!==we.AUTO&&c.unit!==we.AUTO)i=h.unit===we.PX?p+h.value:p+m*h.value*.01,n=c.unit===we.PX?c.value:m;else if(u.unit!==we.AUTO&&c.unit!==we.AUTO){n=c.unit===we.PX?c.value:m;var v=c.unit===we.PX?c.value:m*c.value*.01;i=u.unit===we.PX?p+k-u.value-v:p+k-m*u.value*.01-v}else h.unit!==we.AUTO?(i=h.unit===we.PX?p+h.value:p+m*h.value*.01,n=t.__calAbs()):u.unit!==we.AUTO?(n=t.__calAbs(),i=u.unit===we.PX?p+k-u.value-n:p+k-m*u.value*.01-n):n=c.unit!==we.AUTO?(i=g+w+x.value,c.unit===we.PX?c.value:m):(i=g+w+x.value,t.__calAbs());"inline"===a.display&&(a.display="block"),t.__layout({x:e,y:i,w:r,h:n})})}},{key:"render",value:function(e){U(V(u.prototype),"render",this).call(this,e);var t=this.style.display,i=this.flowChildren,r=this.children;"none"!==t&&(i.forEach(function(t){(t instanceof C||"static"===t.style.position)&&t.render(e)}),r.forEach(function(t){t instanceof j&&-1<["relative","absolute"].indexOf(t.style.position)&&t.render(e)}),e===me.SVG&&(this.__virtualDom=n({},U(V(u.prototype),"virtualDom",this),{type:"dom",children:this.children.map(function(t){return t.virtualDom})})))}},{key:"tagName",get:function(){return this.__tagName}},{key:"children",get:function(){return this.__children}},{key:"flowChildren",get:function(){return this.__flowChildren}},{key:"absChildren",get:function(){return this.__absChildren}},{key:"lineGroups",get:function(){return this.__lineGroups}},{key:"baseLine",get:function(){var t=this.lineGroups.length;if(t){var e=this.lineGroups[t-1];return e.y-this.y+e.baseLine}return this.y}},{key:"flowY",get:function(){return this.__flowY}}],[{key:"isValid",value:function(t){return R.hasOwnProperty(t)}}]),u}();function D(t,e,i){var r=t.childNodes;!function(t,e,i){for(var r=e.length,n=i.length,a=0,s=t.childNodes;a<Math.min(r,n);a++)H(s[a],e[a],i[a])}(r[0],e.defs,i.defs),$(r[1],e.bb,i.bb),z(t,e,i,!0)}function H(t,e,i){if(e.k!==i.k)t.insertAdjacentHTML("afterend",I.joinDef(i)),t.parentNode.removeChild(t);else{for(var r=0;r<4;r++)e.c[r]!==i.c[r]&&t.setAttribute(["x1","y1","x2","y2"][r],i.c[r]);for(var n=e.v.length,a=i.v.length,s=0,o=t.childNodes;s<Math.min(n,a);s++){var h=e.v[s],l=i.v[s];h[0]!==l[0]&&o[s].setAttribute("stop-color",l[0]),h[1]!==l[1]&&o[s].setAttribute("offset",l[1])}if(s<n)for(;s<n;s++)J(t,o,s);else if(s<a)for(;s<a;s++)Z(t,o,s,I.joinDef(i.v[s]))}}function Y(t,e,i){"dom"===e.type?"dom"===i.type?z(t,e,i):"text"===i.type?Q(t,i):"geom"===i.type&&function(t,e,i){$(t.firstChild,e.bb,i.bb),Q(t.lastChild,i.content)}(t,e,i):"text"===i.type?"dom"===i.type?Q(t,i):"text"===i.type?function(t,e,i){for(var r=e.children.length,n=i.children.length,a=0;a<Math.min(r,n);a++)q(t,a,e.children[a],i.children[a],!0);var s=t.childNodes;if(a<r)for(;a<r;a++)J(t,s,a);else if(a<n)for(;a<n;a++)Z(t,s,a,I.joinVd(i.children[a]))}(t,e,i):"geom"===i.type&&Q(t,i):"geom"===i.type&&("dom"===i.type?function(t,e,i){$(t.firstChild,e.bb,i.bb),Q(t.lastChild,i.children)}(t,e,i):"text"===i.type?Q(t,i):"geom"===i.type&&function(t,e,i){if(!function(t,e){if(t.length!==e.length)return!1;for(var i=0,r=t.length;i<r;i++)if(t[i]!==e[i])return!1;return!0}(e.transform,i.transform)){var r=I.joinTransform(i.transform);t.getAttribute("transform")!==r&&t.setAttribute("transform",r)}$(t.firstChild,e.bb,i.bb);for(var n=e.content.length,a=i.content.length,s=0,o=t.lastChild,h=o.childNodes;s<Math.min(n,a);s++)q(o,s,e.content[s],i.content[s]);if(s<n)for(;s<n;s++)J(o,h,s);else if(s<a)for(;s<a;s++)Z(o,h,s,I.joinVd(i.content[s]))}(t,e,i))}function z(t,e,i,r){r||$(t.firstChild,e.bb,i.bb);for(var n=e.children.length,a=i.children.length,s=0,o=t.lastChild,h=o.childNodes;s<Math.min(n,a);s++)Y(h[s],e.children[s],i.children[s]);if(s<n)for(;s<n;s++)J(o,h,s);else if(s<a)for(;s<a;s++)Z(o,h,s,I.joinVd(i.children[s]))}function $(t,e,i){for(var r=e.length,n=i.length,a=0;a<Math.min(r,n);a++)q(t,a,e[a],i[a]);var s=t.childNodes;if(a<r)for(;a<r;a++)J(t,s,a);else if(a<n)for(;a<n;a++)Z(t,s,a,I.joinVd(i[a]))}function q(t,e,i,r,n){var a=t.childNodes;if(i.tagName!==r.tagName)Q(a[e],r);else{for(var s={},o=0,h=i.props.length;o<h;o++){var l=F(i.props[o],2),u=l[0],f=l[1];s[u]=f}for(var c=0,d=r.props.length;c<d;c++){var v=F(r.props[c],2),_=v[0];f=v[1];s.hasOwnProperty(_)?(s[_]!==f&&a[e].setAttribute(_,f),delete s[_]):a[e].setAttribute(_,f)}for(var p in s)s.hasOwnProperty(p)&&a[e].removeAttribute(p);n&&i.content!==r.content&&(a[e].textContent=r.content)}}function Q(t,e){var i;Array.isArray(e)?(i="",e.forEach(function(t){i+=I.joinVd(t)})):i=I.joinVd(e),t.insertAdjacentHTML("afterend",i),t.parentNode.removeChild(t)}function Z(t,e,i,r){i>=e.length?t.insertAdjacentHTML("beforeend",r):e[i].insertAdjacentHTML("beforebegin",r)}function J(t,e,i){e[i]&&t.removeChild(e[i])}var K=function(){function e(t){o(this,e),this.id=t,this.count=0,this.list=[]}return a(e,[{key:"add",value:function(t){return t.uuid="karas-defs-".concat(this.id,"-").concat(this.count++),this.list.push(t),t.uuid}},{key:"clear",value:function(){this.list=[],this.count=0}},{key:"value",get:function(){return this.list}}],[{key:"getInstance",value:function(t){return new e(t)}}]),e}();var tt=0,et=function(){function n(t,e,i){var r;return o(this,n),(r=s(this,V(n).call(this,t,e,i))).__node=null,r}return t(n,B),a(n,[{key:"__initProps",value:function(){if(void 0!==this.props.width){var t=parseInt(this.props.width);!isNaN(t)&&0<t&&(this.__width=t)}if(void 0!==this.props.height){var e=parseInt(this.props.height);!isNaN(e)&&0<e&&(this.__height=e)}}},{key:"__genHtml",value:function(){for(var t,e,i,r="<".concat(this.tagName),n=0,a=this.__props.length;n<a;n++){var s=this.__props[n];r+=(t=s[0],e=s[1],void 0,i=Array.isArray(e)?I.joinSourceArray(e):I.stringify(e),"className"===t&&(t="class")," "+t+'="'+I.encodeHtml(i,!0)+'"')}return r+="></".concat(this.tagName,">")}},{key:"__cb",value:function(t,e){if(!(t.touches&&1<t.touches.length)){var i=this.node.getBoundingClientRect(),r=i.x,n=i.y,a=i.top,s=i.right;r=r||a||0,n=n||s||0;var o=t.touches?t.touches[0]||{}:t;r=o.clientX-r,n=o.clientY-n,this.__emitEvent({event:t,x:r,y:n,covers:[]},e)}}},{key:"__initEvent",value:function(){var i=this,t=this.node;["click","dblclick","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"].forEach(function(e){t.addEventListener(e,function(t){i.__cb(t,-1<["touchend","touchcancel"].indexOf(e))})})}},{key:"appendTo",value:function(t){if(t=function(t){if(I.isString(t)){var e=document.querySelector(t);if(!e)throw new Error("can not find dom of selector: "+t);return e}if(!t)throw new Error("can not find dom: "+t);return t}(t),this.__initProps(),t.nodeName.toUpperCase()===this.tagName.toUpperCase()?(this.__node=t,this.width&&t.setAttribute("width",this.width),this.height&&t.setAttribute("height",this.height)):(this.__node=t.querySelector(this.tagName),this.__node||(t.innerHTML=this.__genHtml(),this.__node=t.querySelector(this.tagName))),this.__uuid=this.__node.__uuid||tt++,this.__defs=K.getInstance(this.__uuid),this.__defs.clear(),!this.width||!this.height){var e=window.getComputedStyle(t,null);this.width||(this.__width=parseInt(e.getPropertyValue("width")),t.setAttribute("width",this.width)),this.height||(this.__height=parseInt(e.getPropertyValue("height")),t.setAttribute("height",this.height))}var i;"canvas"===this.tagName?(this.__ctx=this.__node.getContext("2d"),this.__ctx.clearRect(0,0,this.width,this.height),i=me.CANVAS):"svg"===this.tagName&&(i=me.SVG);var r=this.style;if(-1===["flex","block"].indexOf(r.display)&&(r.display="block"),"absolute"===r.position&&(r.position="static"),this.__traverse(this.__ctx,this.__defs,i),r.width=this.width,r.height=this.height,this.__initStyle(),this.__layout({x:0,y:0,w:this.width,h:this.height}),this.__layoutAbs(this),this.render(i),i===me.SVG){var n=this.virtualDom,a=this.__defs.value;n.defs=a,this.node.__karasInit?D(this.node,this.node.__ovd,n):this.node.innerHTML=I.joinVirtualDom(n,a),this.node.__ovd=n,this.node.__od=a}this.node.__karasInit||(this.node.__karasInit=!0,this.__initEvent())}},{key:"node",get:function(){return this.__node}},{key:"imageData",get:function(){return this.__imageData}}]),n}(),it=function(){function R(t,e){var i;return o(this,R),(i=s(this,V(R).call(this,t,e))).__start=[0,0],i.__end=[1,1],i.__control=[],Array.isArray(i.props.start)&&(i.__start=i.props.start),Array.isArray(i.props.end)&&(i.__end=i.props.end),Array.isArray(i.props.control)&&(i.__control=i.props.control),i}return t(R,G),a(R,[{key:"render",value:function(t){U(V(R.prototype),"render",this).call(this,t);var e=this.rx,i=this.ry,r=this.width,n=this.height,a=this.mlw,s=this.mtw,o=this.plw,h=this.ptw,l=this.style,u=this.ctx,f=this.start,c=this.end,d=this.control;this.virtualDom;if(!(f.length<2||c.length<2)){var v=l.display,_=l.borderTopWidth,p=l.borderLeftWidth,g=l.stroke,y=l.strokeWidth,m=l.strokeDasharray;if("none"!==v){var w,x,b,k,A,M=e+p.value+a+o,O=i+_.value+s+h,T=M+f[0]*r,S=O+f[1]*n,L=M+c[0]*r,P=O+c[1]*n,W=0;if(Array.isArray(d[0])&&(W++,w=M+d[0][0]*r,x=O+d[0][1]*n),Array.isArray(d[1])&&(W++,b=M+d[1][0]*r,k=O+d[1][1]*n),-1<g.indexOf("linear-gradient")){var C=be.parseGradient(g);C&&(A=be.getLinear(C.v,M,O,r,n))}if(t===me.CANVAS)u.strokeStyle=A?be.createCanvasLg(u,A):g,u.lineWidth=y,u.setLineDash(m),u.beginPath(),u.moveTo(T,S),2===W?u.bezierCurveTo(w,x,b,k,L,P):1===W?u.quadraticCurveTo(w,x,L,P):u.lineTo(L,P),u.stroke(),u.closePath();else if(t===me.SVG){if(A){var E=be.createSvgLg(this.defs,A);g="url(#".concat(E,")")}var N;N=2===W?"M".concat(T," ").concat(S," C").concat(w," ").concat(x," ").concat(b," ").concat(k," ").concat(L," ").concat(P):1===W?"M".concat(T," ").concat(S," Q").concat(w," ").concat(x," ").concat(L," ").concat(P):"M".concat(T," ").concat(S," L").concat(L," ").concat(P),this.addGeom("path",[["d",N],["fill","none"],["stroke",g],["stroke-width",y],["stroke-dasharray",m]])}}}}},{key:"start",get:function(){return this.__start}},{key:"end",get:function(){return this.__end}},{key:"control",get:function(){return this.__control}}]),R}(),rt=function(){function N(t,e){var i;return o(this,N),(i=s(this,V(N).call(this,t,e))).__points=[],Array.isArray(i.props.points)&&(i.__points=i.props.points),-1<["TOP_LEFT","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_RIGHT"].indexOf(i.props.origin)?i.__origin=i.props.origin:i.__origin="TOP_LEFT",i}return t(N,G),a(N,[{key:"render",value:function(t){U(V(N.prototype),"render",this).call(this,t);var e=this.rx,i=this.ry,r=this.width,n=this.height,a=this.mlw,s=this.mtw,o=this.plw,h=this.ptw,l=this.style,u=this.ctx,f=this.points,c=this.origin;this.virtualDom;if(!(f.length<2)){for(var d=0,v=f.length;d<v;d++)if(!Array.isArray(f[d])||f[d].length<2)return;var _=l.display,p=l.borderTopWidth,g=l.borderLeftWidth,y=l.stroke,m=l.strokeWidth,w=l.strokeDasharray;if("none"!==_){var x,b=e+g.value+a+o,k=i+p.value+s+h,A=this.__pts=[];if("TOP_LEFT"===c?f.forEach(function(t){A.push([b+t[0]*r,k+t[1]*n])}):"TOP_RIGHT"===c?f.forEach(function(t){A.push([b+r-t[0]*r,k+t[1]*n])}):"BOTTOM_LEFT"===c?f.forEach(function(t){A.push([b+t[0]*r,k+n-t[1]*n])}):"BOTTOM_RIGHT"===c&&f.forEach(function(t){A.push([b+r-t[0]*r,k+n-t[1]*n])}),-1<y.indexOf("linear-gradient")){var M=be.parseGradient(y);M&&(x=be.getLinear(M.v,b,k,r,n))}if(t===me.CANVAS){u.strokeStyle=x?be.createCanvasLg(u,x):y,u.lineWidth=m,u.setLineDash(w),u.beginPath(),u.moveTo(A[0][0],A[0][1]);for(var O=1,T=A.length;O<T;O++){var S=A[O];u.lineTo(S[0],S[1])}u.stroke(),u.closePath()}else if(t===me.SVG){for(var L="",P=0,W=A.length;P<W;P++){var C=A[P];L+="".concat(C[0],",").concat(C[1]," ")}if(x){var E=be.createSvgLg(this.defs,x);y="url(#".concat(E,")")}this.addGeom("polyline",[["points",L],["fill","none"],["stroke",y],["stroke-width",m],["stroke-dasharray",w]])}}}}},{key:"points",get:function(){return this.__points}},{key:"origin",get:function(){return this.__origin}}]),N}(),nt=function(){function j(t,e){var i;return o(this,j),(i=s(this,V(j).call(this,t,e))).__points=[],Array.isArray(i.props.points)&&(i.__points=i.props.points),i}return t(j,G),a(j,[{key:"render",value:function(t){U(V(j.prototype),"render",this).call(this,t);var e=this.rx,i=this.ry,r=this.width,n=this.height,a=this.mlw,s=this.mtw,o=this.plw,h=this.ptw,l=this.style,u=this.ctx,f=this.points;this.virtualDom;if(!(f.length<3)){for(var c=0,d=f.length;c<d;c++)if(!Array.isArray(f[c])||f[c].length<2)return;var v=l.display,_=l.borderTopWidth,p=l.borderLeftWidth,g=l.stroke,y=l.strokeWidth,m=l.strokeDasharray,w=l.fill;if("none"!==v){var x,b,k,A=e+p.value+a+o,M=i+_.value+s+h,O=A+.5*r,T=M+.5*n;if(0<y&&-1<g.indexOf("linear-gradient")){var S=be.parseGradient(g);S&&(x=be.getLinear(S.v,O,T,r,n))}if(-1<w.indexOf("linear-gradient")){var L=be.parseGradient(w);L&&(b=be.getLinear(L.v,O,T,r,n))}else if(-1<w.indexOf("radial-gradient")){var P=be.parseGradient(w);P&&(k=be.getRadial(P.v,O,T,A,M,M+r,M+n))}if(f.forEach(function(t){t[0]=A+t[0]*r,t[1]=M+t[1]*n}),t===me.CANVAS){u.strokeStyle=x?be.createCanvasLg(u,x):g,u.lineWidth=y,u.fillStyle=b?be.createCanvasLg(u,b):k?be.createCanvasRg(u,k):w,u.setLineDash(m),u.beginPath(),u.moveTo(f[0][0],f[0][1]);for(var W=1,C=f.length;W<C;W++){var E=f[W];u.lineTo(E[0],E[1])}u.lineTo(f[0][0],f[0][1]),u.fill(),u.stroke(),u.closePath()}else if(t===me.SVG){for(var N="",R=0,G=f.length;R<G;R++){var X=f[R];N+="".concat(X[0],",").concat(X[1]," ")}if(x){var B=be.createSvgLg(this.defs,x);g="url(#".concat(B,")")}if(b){var D=be.createSvgLg(this.defs,b);w="url(#".concat(D,")")}else if(k){var I=be.createSvgRg(this.defs,k);w="url(#".concat(I,")")}this.addGeom("polygon",[["points",N],["fill",w],["stroke",g],["stroke-width",y],["stroke-dasharray",m]])}}}}},{key:"points",get:function(){return this.__points}}]),j}(),at=.5*Math.PI;function st(t,e,i,r){return 0<=(r%=360)&&r<90?[t+Math.sin(r*Math.PI/180)*i,e-Math.cos(r*Math.PI/180)*i]:90<=r&&r<180?[t+Math.cos((r-90)*Math.PI/180)*i,e+Math.sin((r-90)*Math.PI/180)*i]:180<=r&&r<270?[t-Math.cos((270-r)*Math.PI/180)*i,e+Math.sin((270-r)*Math.PI/180)*i]:[t-Math.sin((360-r)*Math.PI/180)*i,e-Math.cos((360-r)*Math.PI/180)*i]}var ot=function(){function j(t,e){var i;return o(this,j),(i=s(this,V(j).call(this,t,e))).__start=0,i.__end=0,i.props.start&&(i.__start=parseFloat(i.props.start),isNaN(i.start)&&(i.__start=0)),i.props.end&&(i.__end=parseFloat(i.props.end),isNaN(i.end)&&(i.__end=0)),i.__r=1,i.props.r&&(i.__r=parseFloat(i.props.r),isNaN(i.r)&&(i.__r=1)),i}return t(j,G),a(j,[{key:"render",value:function(t){U(V(j.prototype),"render",this).call(this,t);var e=this.rx,i=this.ry,r=this.width,n=this.height,a=this.mlw,s=this.mtw,o=this.plw,h=this.ptw,l=this.style,u=this.ctx,f=this.start,c=this.end,d=this.r;this.virtualDom;if(f!==c){var v=l.display,_=l.borderTopWidth,p=l.borderLeftWidth,g=l.stroke,y=l.strokeWidth,m=l.strokeDasharray,w=l.fill;if("none"!==v){var x,b,k,A=e+p.value+a+o,M=i+_.value+s+h,O=A+.5*r,T=M+.5*n;if(d*=.5*Math.min(r,n),0<y&&-1<g.indexOf("linear-gradient")){var S=be.parseGradient(g);S&&(x=be.getLinear(S.v,O,T,r,n))}if(-1<w.indexOf("linear-gradient")){var L=be.parseGradient(w);L&&(b=be.getLinear(L.v,O,T,r,n))}else if(-1<w.indexOf("radial-gradient")){var P=be.parseGradient(w);P&&(k=be.getRadial(P.v,O,T,A,M,M+r,M+n))}if(t===me.CANVAS)u.strokeStyle=x?be.createCanvasLg(u,x):g,u.lineWidth=y,u.fillStyle=b?be.createCanvasLg(u,b):k?be.createCanvasRg(u,k):w,u.setLineDash(m),u.beginPath(),u.moveTo(O,T),u.arc(O,T,d,f*Math.PI/180-at,c*Math.PI/180-at),u.lineTo(O,T),u.fill(),u.stroke(),u.closePath();else if(t===me.SVG){var W,C,E,N,R=F(st(O,T,d,f),2);W=R[0],C=R[1];var G=F(st(O,T,d,c),2);E=G[0],N=G[1];var X=180<c-f?1:0;if(x){var B=be.createSvgLg(this.defs,x);g="url(#".concat(B,")")}if(b){var D=be.createSvgLg(this.defs,b);w="url(#".concat(D,")")}else if(k){var I=be.createSvgRg(this.defs,k);w="url(#".concat(I,")")}this.addGeom("path",[["d","M".concat(O," ").concat(T," L").concat(W," ").concat(C," A").concat(d," ").concat(d," 0 ").concat(X," 1 ").concat(E," ").concat(N," z")],["fill",w],["stroke",g],["stroke-width",y],["stroke-dasharray",m]])}}}}},{key:"start",get:function(){return this.__start}},{key:"end",get:function(){return this.__end}},{key:"r",get:function(){return this.__r}}]),j}(),ht=function(){function W(t,e){return o(this,W),s(this,V(W).call(this,t,e))}return t(W,G),a(W,[{key:"render",value:function(t){U(V(W.prototype),"render",this).call(this,t);var e=this.rx,i=this.ry,r=this.width,n=this.height,a=this.mlw,s=this.mtw,o=this.plw,h=this.ptw,l=this.style,u=this.ctx,f=(this.virtualDom,l.display),c=l.borderTopWidth,d=l.borderLeftWidth,v=l.stroke,_=l.strokeWidth,p=l.strokeDasharray,g=l.fill;if("none"!==f){var y,m,w,x=e+d.value+a+o,b=i+c.value+s+h,k=x+.5*r,A=b+.5*n;if(0<_&&-1<v.indexOf("linear-gradient")){var M=be.parseGradient(v);M&&(y=be.getLinear(M.v,k,A,r,n))}if(-1<g.indexOf("linear-gradient")){var O=be.parseGradient(g);O&&(m=be.getLinear(O.v,k,A,r,n))}else if(-1<g.indexOf("radial-gradient")){var T=be.parseGradient(g);T&&(w=be.getRadial(T.v,k,A,x,b,b+r,b+n))}if(t===me.CANVAS)u.strokeStyle=y?be.createCanvasLg(u,y):v,u.lineWidth=_,u.fillStyle=m?be.createCanvasLg(u,m):w?be.createCanvasRg(u,w):g,u.setLineDash(p),u.beginPath(),u.moveTo(x,b),u.lineTo(x+r,b),u.lineTo(x+r,b+n),u.lineTo(x,b+n),u.lineTo(x,b),u.fill(),u.stroke(),u.closePath();else if(t===me.SVG){if(y){var S=be.createSvgLg(this.defs,y);v="url(#".concat(S,")")}if(m){var L=be.createSvgLg(this.defs,m);g="url(#".concat(L,")")}else if(w){var P=be.createSvgRg(this.defs,w);g="url(#".concat(P,")")}this.addGeom("rect",[["x",e],["y",i],["width",r],["height",n],["fill",g],["stroke",v],["stroke-width",_],["stroke-dasharray",p]])}}}}]),W}(),lt=function(){function C(t,e){var i;return o(this,C),(i=s(this,V(C).call(this,t,e))).__r=1,i.props.r&&(i.__r=parseFloat(i.props.r),isNaN(i.r)&&(i.__r=1)),i}return t(C,G),a(C,[{key:"render",value:function(t){U(V(C.prototype),"render",this).call(this,t);var e=this.rx,i=this.ry,r=this.width,n=this.height,a=this.mlw,s=this.mtw,o=this.plw,h=this.ptw,l=this.style,u=this.ctx,f=this.r,c=(this.virtualDom,l.display),d=l.borderTopWidth,v=l.borderLeftWidth,_=l.stroke,p=l.strokeWidth,g=l.strokeDasharray,y=l.fill;if("none"!==c){var m,w,x,b=e+v.value+a+o,k=i+d.value+s+h,A=b+.5*r,M=k+.5*n;if(f*=.5*Math.min(r,n),0<p&&-1<_.indexOf("linear-gradient")){var O=be.parseGradient(_);O&&(m=be.getLinear(O.v,A,M,r,n))}if(-1<y.indexOf("linear-gradient")){var T=be.parseGradient(y);T&&(w=be.getLinear(T.v,A,M,r,n))}else if(-1<y.indexOf("radial-gradient")){var S=be.parseGradient(y);S&&(x=be.getRadial(S.v,A,M,b,k,k+r,k+n))}if(t===me.CANVAS)u.strokeStyle=m?be.createCanvasLg(u,m):_,u.lineWidth=p,u.fillStyle=w?be.createCanvasLg(u,w):x?be.createCanvasRg(u,x):y,u.setLineDash(g),u.beginPath(),u.arc(A,M,f,0,2*Math.PI),u.fill(),u.stroke(),u.closePath();else if(t===me.SVG){if(m){var L=be.createSvgLg(this.defs,m);_="url(#".concat(L,")")}if(w){var P=be.createSvgLg(this.defs,w);y="url(#".concat(P,")")}else if(x){var W=be.createSvgRg(this.defs,x);y="url(#".concat(W,")")}this.addGeom("circle",[["cx",A],["cy",M],["r",f],["fill",y],["stroke",_],["stroke-width",p],["stroke-dasharray",g]])}}}},{key:"r",get:function(){return this.__r}}]),C}(),ut=function(){function E(t,e){var i;return o(this,E),(i=s(this,V(E).call(this,t,e))).__xr=1,i.props.rx&&(i.__xr=parseFloat(i.props.rx),isNaN(i.xr)&&(i.__xr=1)),i.__yr=1,i.props.ry&&(i.__yr=parseFloat(i.props.ry),isNaN(i.yr)&&(i.__yr=1)),i}return t(E,G),a(E,[{key:"render",value:function(t){U(V(E.prototype),"render",this).call(this,t);var e=this.rx,i=this.ry,r=this.width,n=this.height,a=this.mlw,s=this.mtw,o=this.plw,h=this.ptw,l=this.style,u=this.ctx,f=this.xr,c=this.yr,d=l.display,v=l.borderTopWidth,_=l.borderLeftWidth,p=l.stroke,g=l.strokeWidth,y=l.strokeDasharray,m=l.fill;if("none"!==d){var w,x,b,k=e+_.value+a+o,A=i+v.value+s+h,M=k+.5*r,O=A+.5*n;if(f*=.5*r,c*=.5*n,0<g&&-1<p.indexOf("linear-gradient")){var T=be.parseGradient(p);T&&(w=be.getLinear(T.v,M,O,r,n))}if(-1<m.indexOf("linear-gradient")){var S=be.parseGradient(m);S&&(x=be.getLinear(S.v,M,O,r,n))}else if(-1<m.indexOf("radial-gradient")){var L=be.parseGradient(m);L&&(b=be.getRadial(L.v,M,O,k,A,A+r,A+n))}if(t===me.CANVAS)u.strokeStyle=w?be.createCanvasLg(u,w):p,u.lineWidth=g,u.fillStyle=x?be.createCanvasLg(u,x):b?be.createCanvasRg(u,b):m,u.setLineDash(y),u.beginPath(),u.ellipse&&u.ellipse(M,O,f,c,0,0,2*Math.PI),u.fill(),u.stroke(),u.closePath();else if(t===me.SVG){if(w){var P=be.createSvgLg(this.defs,w);p="url(#".concat(P,")")}if(x){var W=be.createSvgLg(this.defs,x);m="url(#".concat(W,")")}else if(b){var C=be.createSvgRg(this.defs,b);m="url(#".concat(C,")")}this.addGeom("ellipse",[["cx",M],["cy",O],["rx",f],["ry",c],["fill",m],["stroke",p],["stroke-width",g],["stroke-dasharray",y]])}}}},{key:"xr",get:function(){return this.__xr}},{key:"yr",get:function(){return this.__yr}}]),E}();G.register("$line",it),G.register("$polyline",rt),G.register("$polygon",nt),G.register("$sector",ot),G.register("$rect",ht),G.register("$circle",lt),G.register("$ellipse",ut);var ft={render:function(t,e){if(!(t instanceof et))throw new Error("render root muse be canvas or svg");return e&&t.appendTo(e),t},createVd:function(t,e,i){if(-1<["canvas","svg"].indexOf(t))return new et(t,e,i);if(B.isValid(t))return new B(t,e,i);throw new Error("can not use marker: "+t)},createGm:function(t,e){return new(G.getRegister(t))(t,e)},createCp:function(t,e){return new t(e)},Geom:G,mode:me};return"undefined"!=typeof window&&(window.karas=ft),ft});
//# sourceMappingURL=index.min.js.map
