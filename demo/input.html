<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=0"/>
  <title>input</title>
  <link href="style.css" media="all" rel="stylesheet"/>
  <style>
    textarea{width:80%;padding:5px;height:300px;background:#252;border:1px solid #333;color:#FFF;font-size:13px;font-family:Consolas,momospace,"宋体","Courier New";border-radius:5px;}
    #btn{vertical-align:top}
  </style>
</head>
<body>
<div>
<textarea id="ta" autocomplete="off">
  {
      "tagName": "span",
      "props": {
        "style": {
          "p": "absolute",
          "l": 55,
          "t": 6,
          "h": 26,
          "fz": 19,
          "ff": "PingFang SC",
          "fw": 5,
          "bc": "#000",
          "c": "rgba(255,255,255,1)"
        }
      },
      "children": [
        "抽大奖"
      ],
      "animate": [
        {
          "value": [
            {
              "l": 50,
              "t": 1,
              "easing": "cubic-bezier(0.8233,0.0133,1,1)"
            },
            {
              "l": 0,
              "t": 1
            }
          ],
          "options": {
            "duration": 6000,
            "fill": "forwards",
  "fps":1
          }
        }
      ]
    }
</textarea>
<input id="btn" type="button" value="ok"/>
</div>
<div id="example"></div>
<div id="example2"></div>
<script src="../index.js"></script>
<script>
  var ta = document.getElementById('ta');
  var input = document.getElementById('btn');
  function exec(s) {
    let json = JSON.parse(s);
    karas.parse({
      tagName: 'canvas',
      props: {
        width: 360,
        height: 360,
      },
      children: Array.isArray(json) ? json : [
        json,
      ],
    }, '#example');
    // karas.parse({
    //   tagName: 'svg',
    //   props: {
    //     width: 110,
    //     height: 80,
    //   },
    //   children: Array.isArray(json) ? json : [
    //     json,
    //   ],
    // }, '#example2');
  }
  input.onclick = function() {
    exec(ta.value);
    // location.hash = encodeURIComponent(ta.value);
  };
  function hashChange(first) {
    var s = location.hash.replace(/^#/, '');
    if(s) {
      s = decodeURIComponent(s);
      ta.value = s;
      exec(s);
    }
    else if(first) {
      exec(ta.value);
    }
  }
  hashChange(true);
  // window.onhashchange = hashChange;
</script>
</body>
</html>
